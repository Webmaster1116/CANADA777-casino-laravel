ViewController("GambleViewController",{},function(){function e(a){console.log(a);var b=a.data;(37==a.keyCode||39==a.keyCode)&&b._view.getButtonsEnabled()&&(37==a.keyCode?b._view.dispatchEvent(new Event(GambleView.GAMBLE_RED_BLACK_BUTTON_CLICK,{type:0})):39==a.keyCode&&b._view.dispatchEvent(new Event(GambleView.GAMBLE_RED_BLACK_BUTTON_CLICK,{type:1})))}function h(a){this.dispatchEvent(a)}function k(a){this.dispatchEvent(a)}function d(){this._cardClickSoundChannel=SoundManager.getInstance().play("gambleCardClickSound",
!0);this._cardClickSoundRequested=!0}function f(){this._cardClickSoundChannel=SoundManager.getInstance().stop(this._cardClickSoundChannel);this._cardClickSoundRequested=!1}function g(a){0==a.data.soundIndex&&this._cardClickSoundRequested&&d.call(this)}return{init:function(){this._cardClickSoundChannel=this._view=null;this._cardClickSoundRequested=!1;this._super();var a=GameSettings.getInstance(),b=GameSettings.getInstance().serverMessage;if(b.type!=BaseMessage.SPIN)throw"Trying to open gamble with invalid message type!";
this._view=new GambleView(74,67,{gambleAmountTitle:a.localize("GAMBLE AMOUNT"),amountToWinTitle:a.localize("GAMBLE TO WIN"),currencyType:a.currencyType,currency:a.currency,denomination:a.denominations[a.currDenominationIndex][0],historyTitle:a.localize("HISTORY"),attemptsLeftTitle:a.localize("GAMBLE ATTEMPTS LEFT"),attemptsLeft:b.gambleAttemptsLeft,gambleAmount:b.winAmount,amountToWin:2*b.winAmount,history:a.historyCards,noCoins:a.noCoins});this._view.addEventListener(GambleView.GAMBLE_RED_BLACK_BUTTON_CLICK,
h,this);this._view.addEventListener(GambleView.GAMBLE_RESULT_SHOWN,k,this);this._view.addEventListener(GambleView.START_CLICK_SOUND,d,this);this._view.addEventListener(GambleView.STOP_CLICK_SOUND,f,this);SoundManager.getInstance().addEventListener(SoundManager.SOUND_LOADED,g,this);d.call(this);$(document).bind("keyup",this,e)},setResult:function(){var a=GameSettings.getInstance(),b=a.serverMessage;if(b.type!=BaseMessage.GAMBLE)throw"Setting gamble result from invalid message type in GambleViewController!";
a=a.historyCards;10>a.length&&a.push(-1);for(var c=a.length-1;1<=c;c--)a[c]=a[c-1];a[0]=b.card;this._view.setResult(b.card,b.winAmount,2*b.winAmount,b.gambleAttemptsLeft,a);0<b.winAmount?SoundManager.getInstance().play("gambleWonSound"):SoundManager.getInstance().play("gambleLostSound")},dispose:function(){$(document).unbind("keyup",e);SoundManager.getInstance().removeEventListener(SoundManager.SOUND_LOADED,g,this);f.call(this);this._super()}}}());
