View("GambleView",{GAMBLE_RED_BLACK_BUTTON_CLICK:"gambleRedBlackButtonClick",GAMBLE_RESULT_SHOWN:"gambleResultShown",START_CLICK_SOUND:"startClickSound",STOP_CLICK_SOUND:"stopClickSound",VERTICAL_SPACE_BETWEEN_BUTTONS:157,HISTORY_CARDS_COUNT:5},function(){function h(a){this._config.currency?this._amountField.setText(Utils.formatNumber(a,100,!0,this._config.noCoins)+" "+this._config.currencyType):this._amountField.setText(Utils.formatNumber(a,this._config.denomination))}function k(a){this._config.currency?
this._winField.setText("<span class='amountToWinValue'>"+Utils.formatNumber(a,100,!0,this._config.noCoins)+"</span> "+this._config.currencyType):this._winField.setText("<span class='amountToWinValue'>"+Utils.formatNumber(a,this._config.denomination)+"</span>")}function d(a){a.target==this._redButton||a.target==this._redButtonInPortrait?this.dispatchEvent(new Event(GambleView.GAMBLE_RED_BLACK_BUTTON_CLICK,{type:0})):a.target!=this._blackButton&&a.target!=this._blackButtonInPortrait||this.dispatchEvent(new Event(GambleView.GAMBLE_RED_BLACK_BUTTON_CLICK,
{type:1}));this.setButtonsEnabled(!1)}function g(){this._backType?(this._mainCard.removeClass("backBlack"),this._mainCard.addClass("backRed"),this._backType=0):(this._mainCard.removeClass("backRed"),this._mainCard.addClass("backBlack"),this._backType=1)}function l(){clearTimeout(this._showTimer);this._showTimer=0;if(this._config.attemptsLeft){this.setButtonsEnabled(!0);for(var a=GambleView.HISTORY_CARDS_COUNT-1;1<=a;a--)prevCard=this._historyCards[a-1].hasClass("red")?0:this._historyCards[a-1].hasClass("black")?
1:-1,currCard=this._historyCards[a].hasClass("red")?0:this._historyCards[a].hasClass("black")?1:-1,-1!=prevCard&&(this._historyCards[a].removeClass("red black"),0==prevCard?this._historyCards[a].addClass("red"):this._historyCards[a].addClass("black"),this._historyCards[a].visible(!0));this._historyCards[0].removeClass("red black");this._historyCards[0].addClass("back");this._backType=0;this._mainCard.removeClass("faceRed faceBlack");this._mainCard.addClass("backRed");var b=this;this._blinkTimer=setInterval(function(){g.call(b)},
70);this.dispatchEvent(new Event(GambleView.START_CLICK_SOUND))}this.dispatchEvent(new Event(GambleView.GAMBLE_RESULT_SHOWN))}return{init:function(a,b,f){function e(){c._redButtonInPortrait.setPosition(562,684);c._blackButtonInPortrait.setPosition(322,684);c._redButtonInPortrait.setScale(1,1);c._blackButtonInPortrait.setScale(1,1);if(c._window.height()>c._window.width()){c._redButton.visible(!1);c._blackButton.visible(!1);c._redButtonInPortrait.visible(!0);c._blackButtonInPortrait.visible(!0);var a=
(720-Device.topOffset)*Device.scale,b=$("#Game"),a=b.height()*Device.scale,b=b.position().top,a=(c._window.height()-a-b-111*Device.scale)/(234*Device.scale+333*Device.scale);if(1>a){c._redButtonInPortrait.setScale(a,a);c._blackButtonInPortrait.setScale(a,a);var b=684-(234-234*a)/2,d=322+(240-240*a)/2;c._redButtonInPortrait.setPosition(562-(240-240*a)/2,b);c._blackButtonInPortrait.setPosition(d,b)}}else c._redButtonInPortrait.visible(!1),c._blackButtonInPortrait.visible(!1),c._redButton.visible(!0),
c._blackButton.visible(!0)}this._config=f;this._winField=this._amountField=this._gambleAttemptsField=this._blackButton=this._redButton=null;this._historyCards=[];this._showTimer=this._blinkTimer=this._mainCard=null;this._backType=0;this._super("gambleContainer",a,b);this.addChild(new TextView("gambleLabel amount",this._config.gambleAmountTitle,16,16));this.addChild(new TextView("gambleLabel win",this._config.amountToWinTitle,654,16));this.addChild(new TextView("gambleLabel history",this._config.historyTitle,
448,59));a=new TextView("gambleLabel attempts",this._config.attemptsLeftTitle,8,498);this._gambleAttemptsField=new TextView("gambleLabel attemptsField",this._config.attemptsLeft,0,0,!0);this._gambleAttemptsField.setPositionType("relative");a.addChild(this._gambleAttemptsField);this.addChild(a);this._amountField=new TextView("gambleLabel amountField","",36,70);this._winField=new TextView("gambleLabel winField","",689,56);this.addChildren(this._amountField,this._winField);a=new View("historyCardsView",
403,98);for(b=0;b<GambleView.HISTORY_CARDS_COUNT;b++)this._historyCards[b]=new View("historyCard",67*b,0),this._historyCards[b].visible(!1),this._historyCards[b].setSize(63,88),a.addChild(this._historyCards[b]),0!=b?(f=this._config.history[b-1],this._config.history.length>=b&&-1!=f&&(0==f||3==f?this._historyCards[b].addClass("black"):this._historyCards[b].addClass("red"),this._historyCards[b].visible(!0))):(this._historyCards[b].addClass("back"),this._historyCards[b].visible(!0));this.addChild(a);
this._mainCard=new View("mainCard backRed",469,205);this._redButton=new Button("gambleButton red",12,115);this._blackButton=new Button("gambleButton black",12,this._redButton.y()+GambleView.VERTICAL_SPACE_BETWEEN_BUTTONS);this._redButtonInPortrait=new Button("redGambleButtonInPortrait",562,684);this._blackButtonInPortrait=new Button("blackGambleButtonInPortrait",322,684);this.addChildren(this._mainCard,this._redButton,this._blackButton,this._redButtonInPortrait,this._blackButtonInPortrait);var c=
this;this._blinkTimer=setInterval(function(){g.call(c)},70);this._redButton.addEventListener(MouseEvent.CLICK,d,this);this._blackButton.addEventListener(MouseEvent.CLICK,d,this);this._redButtonInPortrait.addEventListener(MouseEvent.CLICK,d,this);this._blackButtonInPortrait.addEventListener(MouseEvent.CLICK,d,this);this._redButtonInPortrait.visible(!1);this._blackButtonInPortrait.visible(!1);this._redButton.visible(!1);this._blackButton.visible(!1);h.call(this,this._config.gambleAmount);k.call(this,
this._config.amountToWin);this._window=$(window);c=this;setTimeout(e,0);this._window.on("resize",e)},setButtonsEnabled:function(a){this._redButton.enabled(a);this._blackButton.enabled(a);this._redButtonInPortrait.enabled(a);this._blackButtonInPortrait.enabled(a)},getButtonsEnabled:function(){return this._redButton.enabled()&&this._blackButton.enabled()},setResult:function(a,b,d,e,c){0<b?(h.call(this,b),k.call(this,d),this._gambleAttemptsField.setText(e.toString())):this._gambleAttemptsField.setText(this._config.attemptsLeft-
1);this._config.attemptsLeft=e;clearInterval(this._blinkTimer);this._blinkTimer=0;this.dispatchEvent(new Event(GambleView.STOP_CLICK_SOUND));this._mainCard.removeClass("backRed backBlack");this._historyCards[0].removeClass("back");0==a||3==a?(this._mainCard.addClass("faceBlack"),this._historyCards[0].addClass("black")):(this._mainCard.addClass("faceRed"),this._historyCards[0].addClass("red"));var g=this;this._showTimer=setTimeout(function(){l.call(g)},0==e&&0<b?2E3:1E3)},dispose:function(){this._redButton.removeEventListener(MouseEvent.CLICK,
d,this);this._blackButton.removeEventListener(MouseEvent.CLICK,d,this);this._redButtonInPortrait.removeEventListener(MouseEvent.CLICK,d,this);this._blackButtonInPortrait.removeEventListener(MouseEvent.CLICK,d,this);this._blinkTimer&&(clearInterval(this._blinkTimer),this._blinkTimer=0);this._showTimer&&(clearTimeout(this._showTimer),this._showTimer=0);this._super()}}}());
