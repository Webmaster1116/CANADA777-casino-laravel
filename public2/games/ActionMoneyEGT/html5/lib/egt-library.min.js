var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();var __assign=this&&this.__assign||Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc,d;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)if(d=decorators[i])r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r;return c>3&&r&&Object.defineProperty(target,key,r),r};var Pluck;!function(Pluck){var Model=function(){function Model(){}Model.prototype.sendNotification=function(type,body){Pluck.ViewController.getRoot().sendNotification(type,body)};Model.prototype.dispose=function(){};return Model}();Pluck.Model=Model}(Pluck||(Pluck={}));var Pluck;!function(Pluck){var Notification=function(){function Notification(name,body){this._name=name;this._body=body}Object.defineProperty(Notification.prototype,"name",{get:function(){return this._name},enumerable:true,configurable:true});Object.defineProperty(Notification.prototype,"body",{get:function(){return this._body},enumerable:true,configurable:true});return Notification}();Pluck.Notification=Notification}(Pluck||(Pluck={}));var Pluck;!function(Pluck){var NotificationMap=function(){function NotificationMap(){this.data={}}NotificationMap.prototype.register=function(controller){var interests=controller.getInterests();for(var i=0;i<interests.length;i++)this.registerRecipient(interests[i],controller)};NotificationMap.prototype.unregister=function(controller){var interests=controller.getInterests();for(var i=0;i<interests.length;i++){var recipients=this.getRecipients(interests[i]);recipients.splice(recipients.indexOf(controller),1)}};NotificationMap.prototype.notify=function(notification){var recipients=this.getRecipients(notification.name);if(recipients){recipients=recipients.concat();for(var i=0;i<recipients.length;i++)if(recipients[i].shouldReceiveNotifications)recipients[i].handleNotification(notification)}};NotificationMap.prototype.registerRecipient=function(notificationName,controller){if(notificationName in this.data){var recipients=this.getRecipients(notificationName);recipients.push(controller)}else{this.data[notificationName]=[];this.data[notificationName][0]=controller}};NotificationMap.prototype.getRecipients=function(notificationName){return this.data[notificationName]};return NotificationMap}();Pluck.NotificationMap=NotificationMap}(Pluck||(Pluck={}));var Pluck;!function(Pluck){var HashMap=function(){function HashMap(){this.keyArray=[];this.valueArray=[]}HashMap.prototype.add=function(key,value){var index=this.keyArray.indexOf(key);if(index==-1){this.keyArray.push(key);this.valueArray.push(value)}else this.valueArray[index]=value};HashMap.prototype.getVal=function(key){var index=this.keyArray.indexOf(key);return this.valueArray[index]};HashMap.prototype.del=function(key){var index=this.keyArray.indexOf(key);if(index!=-1){this.keyArray.splice(index,1);this.valueArray.splice(index,1)}};return HashMap}();Pluck.HashMap=HashMap}(Pluck||(Pluck={}));var Pluck;!function(Pluck){var ViewController=function(){function ViewController(view,model){if(view===void 0)view=null;if(model===void 0)model=null;this.parent=null;this.children=[];this.autoDispose=true;this._view=view;this._model=model;this._shouldReceiveNotifications=true}ViewController.setRoot=function(root){if(this.root)throw new Error("Root controller has been already set!");this.root=root;this.controllerMap.add(this.root.constructor,this.root);this.root.onRegister();this.notificationMap.register(this.root)};ViewController.getRoot=function(){return this.root};ViewController.disposeRootController=function(){this.shouldRemoveView=false;while(this.root.children.length>0)this.root.removeChildViewController(this.root.children[0]);this.shouldRemoveView=true;this.controllerMap.del(this.root.constructor);this.notificationMap.unregister(this.root);this.root.onUnregister();this.root.dispose();var rootModel=this.root._model;if(rootModel&&"dispose"in rootModel)rootModel.dispose();this.root=null};Object.defineProperty(ViewController.prototype,"shouldReceiveNotifications",{get:function(){return this._shouldReceiveNotifications},enumerable:true,configurable:true});ViewController.prototype.getInterests=function(){return[]};ViewController.prototype.sendNotification=function(type,body){ViewController.notificationMap.notify(new Pluck.Notification(type,body))};ViewController.prototype.handleNotification=function(notification){};ViewController.prototype.onRegister=function(){};ViewController.prototype.onUnregister=function(){};ViewController.prototype.hasChildViewController=function(controller){return this.children.indexOf(controller)!=-1};ViewController.prototype.addChildViewController=function(controller){if(!this.hasChildViewController(controller)){this.children.push(controller);controller.parent=this;ViewController.controllerMap.add(controller.constructor,controller);ViewController.notificationMap.register(controller);if(this._view instanceof PIXI.Container&&controller._view instanceof PIXI.DisplayObject)this._view.addChild(controller._view);controller.onRegister()}return controller};ViewController.prototype.removeChildViewController=function(controller){if(this.hasChildViewController(controller)){while(controller.children.length>0)controller.removeChildViewController(controller.children[0]);this.children.splice(this.children.indexOf(controller),1);controller.parent=null;ViewController.controllerMap.del(controller.constructor);ViewController.notificationMap.unregister(controller);controller.onUnregister();if(controller.autoDispose){controller._shouldReceiveNotifications=false;controller.destroy()}}};ViewController.prototype.destroy=function(){if(this._view instanceof PIXI.DisplayObject&&this._view.parent&&ViewController.shouldRemoveView)this._view.parent.removeChild(this._view);this.dispose();if(this._view&&"dispose"in this._view)this._view.dispose();if(this._model&&"dispose"in this._model)this._model.dispose();this._view=null;this._model=null};ViewController.prototype.dispose=function(){};ViewController.prototype.getController=function(constructor){if(void 0==ViewController.controllerMap.getVal(constructor))return null;return ViewController.controllerMap.getVal(constructor)};ViewController.prototype.unique=function(){return this.getController(this.constructor)||this};Object.defineProperty(ViewController.prototype,"zIndex",{get:function(){if(this._view instanceof PIXI.DisplayObject){var displayObject=this._view;if(displayObject.parent)return displayObject.parent.getChildIndex(displayObject);else return-1}return-1},set:function(value){if(this._view instanceof PIXI.DisplayObject){var displayObject=this._view;if(displayObject.parent)displayObject.parent.setChildIndex(displayObject,value)}},enumerable:true,configurable:true});ViewController.controllerMap=new Pluck.HashMap;ViewController.notificationMap=new Pluck.NotificationMap;ViewController.root=null;ViewController.shouldRemoveView=true;return ViewController}();Pluck.ViewController=ViewController}(Pluck||(Pluck={}));var Pluck;!function(Pluck){var ArrayTools=function(){function ArrayTools(){throw new Error("This is a static class")}ArrayTools.flatten=function(array){var flattened=[];for(var i=0;i<array.length;i++){var obj=array[i];if(obj instanceof Array)flattened=flattened.concat(this.flatten(obj));else flattened.push(obj)}return flattened};ArrayTools.equals=function(arr1,arr2){if(arr1.length!=arr2.length)return false;for(var i=0;i<arr1.length;i++)if(arr1[i]!=arr2[i])return false;return true};ArrayTools.diff=function(array,compare){var unique=[];for(var i=0;i<array.length;i++)if(array.indexOf(compare)>-1)unique.push(array[i]);return unique};return ArrayTools}();Pluck.ArrayTools=ArrayTools}(Pluck||(Pluck={}));var Pluck;!function(Pluck){var External=function(){function External(){}External.prototype.serialize=function(obj){for(var key in obj)if(this.hasOwnProperty(key))if("object"===typeof this[key]&&this[key]instanceof External)this[key].serialize(obj[key]);else if(this[key]instanceof Array&&"object"===typeof this[key][0]&&this[key][0]instanceof External)if(0==obj[key].length)this[key].length=0;else{var objectClassConstructor=this[key][0].constructor;for(var i=0;i<obj[key].length;i++){this[key][i]=new objectClassConstructor;this[key][i].serialize(obj[key][i])}}else this[key]=obj[key]};return External}();Pluck.External=External}(Pluck||(Pluck={}));var Pluck;!function(Pluck){var GlobalFNs=function(){function GlobalFNs(){throw new Error("This is a static class")}GlobalFNs.isMobile=function(){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))return true;else return false};GlobalFNs.getQualifiedClassName=function(object){return object.constructor.Name};return GlobalFNs}();Pluck.GlobalFNs=GlobalFNs}(Pluck||(Pluck={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var DeviceOrientation;!function(DeviceOrientation){DeviceOrientation["Portrait"]="portrait";DeviceOrientation["Landscape"]="landscape"}(DeviceOrientation=library.DeviceOrientation||(library.DeviceOrientation={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var Device=function(){function Device(){}Object.defineProperty(Device,"isMobile",{get:function(){return Device.isiOS||Device.isAndroid},enumerable:true,configurable:true});Object.defineProperty(Device,"isiOS",{get:function(){return null!=navigator.userAgent.match(/iPhone/i)||null!=navigator.userAgent.match(/iPad/i)||null!=navigator.userAgent.match(/iPod/i)},enumerable:true,configurable:true});Object.defineProperty(Device,"isAndroid",{get:function(){return null!=navigator.userAgent.match(/Android/i)},enumerable:true,configurable:true});Object.defineProperty(Device,"isCriOS",{get:function(){return null!=navigator.userAgent.match(/CriOS/i)},enumerable:true,configurable:true});Object.defineProperty(Device,"isChrome",{get:function(){return null!=navigator.userAgent.match(/Chrome/i)},enumerable:true,configurable:true});Object.defineProperty(Device,"isSafari",{get:function(){return null!=navigator.userAgent.match(/Safari/i)},enumerable:true,configurable:true});Object.defineProperty(Device,"isFirefox",{get:function(){return null!=navigator.userAgent.match(/Firefox/i)},enumerable:true,configurable:true});Object.defineProperty(Device,"isIE11",{get:function(){return!Device.isFirefox&&"Netscape"==navigator.appName&&null!=navigator.userAgent.match(/Trident/i)},enumerable:true,configurable:true});Object.defineProperty(Device,"currentOrientation",{get:function(){if(void 0!=window.orientation)if(window.orientation==-90||90==window.orientation)return library.DeviceOrientation.Landscape;else return library.DeviceOrientation.Portrait;else{var orientation=window.screen["orientation"]||window.screen["mozOrientation"]||window.screen.msOrientation;if(orientation&&void 0!=orientation.type)if("landscape-primary"===orientation.type||"landscape-secondary"===orientation.type)return library.DeviceOrientation.Landscape;else return library.DeviceOrientation.Portrait;else return library.DeviceOrientation.Landscape}},enumerable:true,configurable:true});Device.resolveEvent=function(eventName){if("mousedown"==eventName)eventName+=" touchstart";else if("mouseup"==eventName)eventName+=" touchend";else if("mouseupoutside"==eventName)eventName+=" touchendoutside";else if("mousemove"==eventName)eventName+=" touchmove";else if("click"==eventName)eventName+=" tap";return eventName};Device.isSoundSupported=function(){return void 0!=Device.getAudioContext()};Device.getAudioContext=function(){if(window.AudioContext)return AudioContext;else return window.webkitAudioContext};return Device}();library.Device=Device}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var events;!function(events){var Event=function(){function Event(type,data,bubbles,cancelable){if(data===void 0)data=null;if(bubbles===void 0)bubbles=true;if(cancelable===void 0)cancelable=false;this.type=type;this.data=data;this.bubbles=bubbles;this.cancelable=cancelable}return Event}();events.Event=Event}(events=library.events||(library.events={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var events;!function(events){var EventDispatcher=function(){function EventDispatcher(){this._listeners={}}EventDispatcher.prototype.addEventListener=function(type,callback,callbackContext){var registeredObjects=this._listeners[type]||[];var callbacks;var len=registeredObjects.length;for(var i=0;i<len;i++)if(registeredObjects[i].context==callbackContext){callbacks=registeredObjects[i].callbacks;break}if(!callbacks){callbacks=[];var object={context:callbackContext,callbacks:callbacks};registeredObjects.push(object)}len=callbacks.length;for(var i=0;i<len;i++)if(callbacks[i]==callback)return;callbacks.push(callback);this._listeners[type]=registeredObjects};EventDispatcher.prototype.dispatchEvent=function(event,target){var registeredObjects=this._listeners[event.type];if(!registeredObjects)return;registeredObjects=registeredObjects.slice();if(void 0!=target)event.target=target;else event.target=this;event.currentTarget=this;var len=registeredObjects.length;var object,callbacksLen;for(var i=0;i<len;i++){object=registeredObjects[i];callbacksLen=object.callbacks.length;for(var j=0;j<callbacksLen;j++)object.callbacks[j].call(object.context,event)}};EventDispatcher.prototype.removeEventListener=function(type,callback,callbackContext){var registeredObjects=this._listeners[type];if(!registeredObjects)return;var len=registeredObjects.length;var object,callbacksLen;for(var i=0;i<len;i++){object=registeredObjects[i];if(object.context!=callbackContext)continue;callbacksLen=object.callbacks.length;for(var j=0;j<callbacksLen;j++)if(object.callbacks[j]==callback){object.callbacks.splice(j,1);j--;callbacksLen--}if(0==callbacksLen){registeredObjects.splice(i,1);i--;len--}}if(0==len)delete this._listeners[type]};EventDispatcher.prototype.hasEventListener=function(type){return void 0!=this._listeners[type]};EventDispatcher.prototype.dispose=function(){for(var type in this._listeners)delete this._listeners[type]};return EventDispatcher}();events.EventDispatcher=EventDispatcher}(events=library.events||(library.events={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var events;!function(events){var LoaderEvent=function(_super){__extends(LoaderEvent,_super);function LoaderEvent(type,data){if(data===void 0)data=null;return _super.call(this,type,data,false)||this}LoaderEvent.COMPLETE="complete";LoaderEvent.CHILD_COMPLETE="childComplete";LoaderEvent.PROGRESS="progress";LoaderEvent.CHILD_PROGRESS="childProgress";LoaderEvent.ERROR="error";LoaderEvent.CHILD_ERROR="childError";LoaderEvent.DECODE_ERROR="decodeError";return LoaderEvent}(events.Event);events.LoaderEvent=LoaderEvent}(events=library.events||(library.events={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var EventDispatcher=com.egt.library.events.EventDispatcher;var Loader=function(_super){__extends(Loader,_super);function Loader(){var _this=null!==_super&&_super.apply(this,arguments)||this;_this._id="";return _this}Loader.addLoader=function(loader){Loader.loaders[loader._id]=loader};Loader.removeLoader=function(loader){delete Loader.loaders[loader._id]};Loader.getLoader=function(id){return Loader.loaders[id]};Object.defineProperty(Loader.prototype,"id",{get:function(){return this._id},enumerable:true,configurable:true});Loader.loaders={};Loader.prependURL="";return Loader}(EventDispatcher);loading.Loader=Loader}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var LoaderEvent=com.egt.library.events.LoaderEvent;var BaseLoader=function(_super){__extends(BaseLoader,_super);function BaseLoader(src,cacheTimestamp,prependURL,id){var _this=_super.call(this)||this;_this._state=BaseLoader.STATE_IDLE;_this._lastProgress=0;_this._loadingRequested=false;_this._request=null;if(void 0==cacheTimestamp)cacheTimestamp=loading.Loader.cacheTimestamp;_this._cacheTimestamp=cacheTimestamp;if(void 0==prependURL)prependURL=loading.Loader.prependURL;_this._prependURL=prependURL;_this.constructGetParameters();if(void 0==id)id=src;_this._id=id;loading.Loader.addLoader(_this);_this._src=src;_this.setUpRequest();return _this}Object.defineProperty(BaseLoader.prototype,"src",{get:function(){return this._src},enumerable:true,configurable:true});BaseLoader.prototype.isIdle=function(){return this._state==BaseLoader.STATE_IDLE};BaseLoader.prototype.isLoading=function(){return this._state==BaseLoader.STATE_LOADING};BaseLoader.prototype.isLoaded=function(){return this._state==BaseLoader.STATE_LOADED};BaseLoader.prototype.hasError=function(){return this._state==BaseLoader.STATE_ERROR};BaseLoader.prototype.load=function(){if(this._state==BaseLoader.STATE_LOADING)return;else if(this._state==BaseLoader.STATE_LOADED){var self=this;setTimeout(function(){self.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,{progress:1,progressChange:0}));self.onLoaded()},0);return}else if(this._state==BaseLoader.STATE_ERROR||this._request.readyState==XMLHttpRequest.UNSENT)this.openRequest();this._lastProgress=0;this._state=BaseLoader.STATE_LOADING;if(this._request.readyState==XMLHttpRequest.OPENED)this._request.send();else this._loadingRequested=true};BaseLoader.prototype.stop=function(){if(this._state!=BaseLoader.STATE_LOADING)return;this._state=BaseLoader.STATE_IDLE;if(this._request)this._request.abort()};BaseLoader.prototype.dispose=function(){if(this._request){this._request.abort();this._request.onreadystatechange=null;this._request.onprogress=null;this._request=null}loading.Loader.removeLoader(this);_super.prototype.dispose.call(this)};BaseLoader.prototype.setUpRequest=function(){this._request=new XMLHttpRequest;this.openRequest();this._request.responseType=this.getResponseType();this._request.onreadystatechange=this.onXHRReadyStateChange.bind(this);this._request.onprogress=this.onXHRProgress.bind(this)};BaseLoader.prototype.openRequest=function(){var prependURL=this._prependURL?this._prependURL:"";this._request.open("GET",prependURL+this._src+this._getParameters)};BaseLoader.prototype.constructGetParameters=function(){this._getParameters=this._cacheTimestamp?"?v="+this._cacheTimestamp:""};BaseLoader.prototype.onXHRReadyStateChange=function(event){if(this._request.readyState==XMLHttpRequest.OPENED){if(this._loadingRequested){this._request.send();this._loadingRequested=false}}else if(this._request.readyState==XMLHttpRequest.DONE)if(this._request.status>=200&&this._request.status<400){this._state=BaseLoader.STATE_LOADED;this.onLoaded(event)}else if(this._request.status>0){this._state=BaseLoader.STATE_ERROR;this.onError(event)}};BaseLoader.prototype.onXHRProgress=function(event){var newProgress;if(event.lengthComputable)newProgress=event.loaded/event.total;else newProgress=1;var data={progress:newProgress,progressChange:newProgress-this._lastProgress};this._lastProgress=newProgress;this.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,data))};BaseLoader.STATE_IDLE=0;BaseLoader.STATE_LOADING=1;BaseLoader.STATE_LOADED=2;BaseLoader.STATE_ERROR=4;return BaseLoader}(loading.Loader);loading.BaseLoader=BaseLoader}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var LoaderEvent=com.egt.library.events.LoaderEvent;var FontLoader=function(_super){__extends(FontLoader,_super);function FontLoader(fontFamily,fontContent){var _this=_super.call(this,"")||this;_this._fontFamily=fontFamily;_this._fontContent=fontContent;return _this}FontLoader.prototype.getData=function(){return null};FontLoader.prototype.load=function(){if(this._state==loading.BaseLoader.STATE_LOADING)return;else if(this._state==loading.BaseLoader.STATE_LOADED){var self_1=this;setTimeout(function(){self_1.onLoaded()},0);return}this._styleTag.remove();this._styleTag.html(this._fontContent);$("head").append(this._styleTag);var self=this;window["WebFont"].load({custom:{families:[this._fontFamily]},loading:function(){},active:function(){self.onLoaded()}})};FontLoader.prototype.dispose=function(){this._styleTag.remove();this._styleTag=null;_super.prototype.dispose.call(this)};FontLoader.prototype.getResponseType=function(){throw"This method is irrelevant for this type of loader."};FontLoader.prototype.setUpRequest=function(){this._styleTag=$("<style>")};FontLoader.prototype.onLoaded=function(event){this._state=loading.BaseLoader.STATE_LOADED;this.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,{progress:1,progressChange:1}));this.dispatchEvent(new LoaderEvent(LoaderEvent.COMPLETE))};FontLoader.prototype.onError=function(event){this._state=loading.BaseLoader.STATE_ERROR;this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))};return FontLoader}(loading.BaseLoader);loading.FontLoader=FontLoader}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var LoaderEvent=com.egt.library.events.LoaderEvent;var JSONLoader=function(_super){__extends(JSONLoader,_super);function JSONLoader(src,cacheTimestamp,prependURL,id){var _this=_super.call(this,src,cacheTimestamp,prependURL,id)||this;_this._data=null;return _this}JSONLoader.prototype.getData=function(){return this._data};JSONLoader.prototype.getResponseType=function(){return"text"};JSONLoader.prototype.onLoaded=function(event){this._data={jsonContent:JSON.parse(this._request.response),rawContent:this._request.response};this.dispatchEvent(new LoaderEvent(LoaderEvent.COMPLETE,this._data))};JSONLoader.prototype.onError=function(event){this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))};return JSONLoader}(loading.BaseLoader);loading.JSONLoader=JSONLoader}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var LayoutImporter=function(){function LayoutImporter(){}LayoutImporter.prototype["import"]=function(json,loader){this._elementsWithID={};this._pixiLoader=loader;this._mainContainer=this.importElements(json);return{elementsWithID:this._elementsWithID,mainContainer:this._mainContainer}};LayoutImporter.prototype.importElements=function(json){var parent=this.switchType(json);if(json.children)for(var i=0;i<json.children.length;i++){var child=this.importElements(json.children[i]);this.checkForIDandAdd(child,json.children[i],parent)}return parent};LayoutImporter.prototype.switchType=function(json){var element;switch(json.type){case"rectangle":element=this.createRectangle(json);break;case"roundedRect":element=this.createRoundedRectangle(json);break;case"image":element=this.createImage(json);break;case"text":element=this.createText(json);break;case"BText":element=this.createBitmapText(json);break;default:element=new PIXI.Container}return element};LayoutImporter.prototype.createRectangle=function(props){var rect=new PIXI.Graphics;rect.lineStyle(props.strokeWidth,props.strokeColor);rect.beginFill(props.fillColor,props.graphicsAlpha);rect.drawRect(0,0,props.width,props.height);rect.endFill();rect.position={x:props.x,y:props.y};return rect};LayoutImporter.prototype.createRoundedRectangle=function(props){var rect=new PIXI.Graphics;rect.lineStyle(props.strokeWidth,props.strokeColor);rect.beginFill(props.fillColor);rect.drawRoundedRect(0,0,props.width,props.height,props.radius);rect.endFill();rect.position={x:props.x,y:props.y};return rect};LayoutImporter.prototype.createImage=function(props){var img=new PIXI.Sprite;img.texture=this._pixiLoader.getTexture(props.picID);img.position.x=props.x;img.position.y=props.y;img.scale=new PIXI.Point(props.scale,props.scale);return img};LayoutImporter.prototype.createText=function(props){var style={fontSize:props.fontSize,stroke:props.strokeColor,fill:props.fillColor,strokeThickness:props.strokeWidth,align:props.align,lineHeight:props.lineHeight,fontFamily:props.fontFamily,dropShadow:props.dropShadow,dropShadowBlur:props.shadow,dropShadowDistance:props.dropShadowDistance,dropShadowColor:props.shadowColor,fontWeight:props.fontWeight,wordWrap:props.wordWrap,wordWrapWidth:props.wordWrapWidth};var text=new PIXI.Text(props.text,style);text.position.x=props.x;text.position.y=props.y;return text};LayoutImporter.prototype.createBitmapText=function(props){var style={font:{name:props.fontFamily,size:props.fontSize},align:props.align};var text=new PIXI.extras.BitmapText(props.text,style);text.position.x=props.x;text.position.y=props.y;return text};LayoutImporter.prototype.checkForIDandAdd=function(element,props,parent){if(""!=props.id&&null!=props.id){this._elementsWithID[props.id]=element;parent[props.id]=element}parent.addChild(element)};return LayoutImporter}();loading.LayoutImporter=LayoutImporter}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var LoaderEvent=com.egt.library.events.LoaderEvent;var LayoutLoader=function(_super){__extends(LayoutLoader,_super);function LayoutLoader(src,cacheTimestamp,prependURL,id){return _super.call(this,src,cacheTimestamp,prependURL,id)||this}LayoutLoader.prototype.getData=function(){return this._data};LayoutLoader.prototype.getTexture=function(name){var texture=void 0;if(this._pixiLoader)texture=this._pixiLoader.getTexture(name);if(this._videoAlternativeLoader&&!texture)texture=this._videoAlternativeLoader.getTexture(name);return texture};LayoutLoader.prototype.getTextureSequence=function(sequenceName,extension,texturesCount,sequenceDigitsCount){if(sequenceDigitsCount===void 0)sequenceDigitsCount=3;if(this._pixiLoader)return this._pixiLoader.getTextureSequence(sequenceName,extension,texturesCount,sequenceDigitsCount);return};LayoutLoader.prototype.load=function(){if(this._state==loading.BaseLoader.STATE_LOADING)return;else if(this._state==loading.BaseLoader.STATE_LOADED){var self=this;setTimeout(function(){self.onLoaded()},0);return}this._lastProgress=0;this._state=loading.BaseLoader.STATE_LOADING;this._jsonLoader.load()};LayoutLoader.prototype.stop=function(){if(this._state!=loading.BaseLoader.STATE_LOADING)return;this._state=loading.BaseLoader.STATE_IDLE;this._jsonLoader.stop();if(this._resourcesLoader)this._resourcesLoader.stop()};LayoutLoader.prototype.dispose=function(){this._jsonLoader.removeEventListener(LoaderEvent.COMPLETE,this.onJSONLoaded,this);this._jsonLoader.removeEventListener(LoaderEvent.ERROR,this.onError,this);this._jsonLoader.dispose();if(this._resourcesLoader){this._resourcesLoader.removeEventListener(LoaderEvent.COMPLETE,this.onResourcesLoaded,this);this._resourcesLoader.removeEventListener(LoaderEvent.PROGRESS,this.onProgress,this);this._resourcesLoader.removeEventListener(LoaderEvent.ERROR,this.onError,this);this._resourcesLoader.dispose()}if(this._videoLoaders)for(var i=0;i<this._videoLoaders.length;i++)this._videoLoaders[i].removeEventListener(LoaderEvent.DECODE_ERROR,this.onVideoDecodeError,this);if(this._data)this._data.mainContainer.destroy(true);_super.prototype.dispose.call(this)};LayoutLoader.prototype.getResponseType=function(){throw"This method is irrelevant for this type of loader."};LayoutLoader.prototype.setUpRequest=function(){this._jsonLoader=new loading.JSONLoader(this._src,this._cacheTimestamp,this._prependURL,"layoutJSONLoader_"+this._id);this._jsonLoader.addEventListener(LoaderEvent.COMPLETE,this.onJSONLoaded,this);this._jsonLoader.addEventListener(LoaderEvent.ERROR,this.onError,this)};LayoutLoader.prototype.parseLayout=function(){var importer=new loading.LayoutImporter;this._data=importer["import"](this._jsonLoader.getData().jsonContent,loading.Loader.getLoader("layoutPIXILoader"+this._id))};LayoutLoader.prototype.onJSONLoaded=function(event){var resources=event.data.jsonContent.resources;var fontStyles=event.data.jsonContent.fontStyles;var fontNames=event.data.jsonContent.fontNames;var bitmapFonts=event.data.jsonContent.bitmapFonts;var videos=event.data.jsonContent.videos?event.data.jsonContent.videos:[];if(0==resources.length&&0==fontStyles.length&&0==bitmapFonts.length&&0==videos.length){this.parseLayout();this.onLoaded();return}this._resourcesLoader=new loading.LoadingQueue;var length=fontStyles.length;for(var i=0;i<length;i++)this._resourcesLoader.addLoader(new loading.FontLoader(fontNames[i],fontStyles[i]));if(0!=resources.length||0!=bitmapFonts.length){var lastSlashIndex=this._src.lastIndexOf("/");var prependURL=this._src.substring(0,lastSlashIndex);this._pixiLoader=new loading.PIXILoader(this._cacheTimestamp,prependURL,"layoutPIXILoader"+this._id);this._resourcesLoader.addLoader(this._pixiLoader)}if(0!=videos.length){this._videoLoaders=[];length=videos.length;for(var i=0;i<length;i++){var lastSlashIndex=this._src.lastIndexOf("/");var prependURL=this._src.substring(0,lastSlashIndex)+"/images/";var videoLoader=new loading.VideoLoader(videos[i],this._cacheTimestamp,prependURL);videoLoader.addEventListener(LoaderEvent.DECODE_ERROR,this.onVideoDecodeError,this);this._videoLoaders.push(videoLoader);this._resourcesLoader.addLoader(videoLoader)}}length=resources.length;for(var i=0;i<length;i++)this._pixiLoader.addResource(resources[i],"images/"+resources[i]);length=bitmapFonts.length;for(var i=0;i<length;i++)this._pixiLoader.addResource(bitmapFonts[i],"images/"+bitmapFonts[i]+".fnt");this._resourcesLoader.addEventListener(LoaderEvent.COMPLETE,this.onResourcesLoaded,this);this._resourcesLoader.addEventListener(LoaderEvent.PROGRESS,this.onProgress,this);this._resourcesLoader.addEventListener(LoaderEvent.ERROR,this.onError,this);this._resourcesLoader.load()};LayoutLoader.prototype.onResourcesLoaded=function(event){this.parseLayout();this.onLoaded()};LayoutLoader.prototype.onLoaded=function(){this._state=loading.BaseLoader.STATE_LOADED;this.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,{progress:1,progressChange:1-this._lastProgress}));this.dispatchEvent(new LoaderEvent(LoaderEvent.COMPLETE))};LayoutLoader.prototype.onProgress=function(event){var data={progress:event.data.progress,progressChange:event.data.progress-this._lastProgress};this._lastProgress=event.data.progress;this.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,data))};LayoutLoader.prototype.onError=function(event){
this._state=loading.BaseLoader.STATE_ERROR;this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))};LayoutLoader.prototype.onVideoDecodeError=function(){var videoAlternative=this._jsonLoader.getData().jsonContent.videoAlternative;for(var i=0;i<this._videoLoaders.length;i++){var loader=this._videoLoaders[i];this._resourcesLoader.removeLoader(loader);loader.removeEventListener(LoaderEvent.DECODE_ERROR,this.onVideoDecodeError,this);loader.dispose()}this._videoLoaders.length=0;if(videoAlternative&&0!=videoAlternative.length){var lastSlashIndex=this._src.lastIndexOf("/");var prependURL=this._src.substring(0,lastSlashIndex);this._videoAlternativeLoader=new loading.PIXILoader(this._cacheTimestamp,prependURL,"videoAlternativeLoader"+this._id);for(var i=0;i<videoAlternative.length;i++)this._videoAlternativeLoader.addResource(videoAlternative[i],"images/"+videoAlternative[i]);this._resourcesLoader.addLoader(this._videoAlternativeLoader)}else throw new Error("Video alternative should always be provided")};return LayoutLoader}(loading.BaseLoader);loading.LayoutLoader=LayoutLoader}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var LoaderEvent=com.egt.library.events.LoaderEvent;var LoadingQueue=function(_super){__extends(LoadingQueue,_super);function LoadingQueue(asyncScriptExecution,id){var _this=_super.call(this)||this;_this._loadersCount=0;_this._completeLoadersCount=0;_this._progress=0;_this._id=id;if(void 0!=_this._id)loading.Loader.addLoader(_this);_this._state=loading.BaseLoader.STATE_IDLE;_this._asyncScriptExecution=asyncScriptExecution;_this._loaders=[];_this._scriptLoaders=[];return _this}LoadingQueue.prototype.isIdle=function(){return this._state==loading.BaseLoader.STATE_IDLE};LoadingQueue.prototype.isLoading=function(){return this._state==loading.BaseLoader.STATE_LOADING};LoadingQueue.prototype.isLoaded=function(){return this._state==loading.BaseLoader.STATE_LOADED};LoadingQueue.prototype.hasError=function(){return this._state==loading.BaseLoader.STATE_ERROR};LoadingQueue.prototype.addLoader=function(loader){var loadersArray=loader instanceof loading.ScriptLoader?this._scriptLoaders:this._loaders;var loaderIndex=loadersArray.indexOf(loader);if(loaderIndex!=-1)return;loadersArray.push(loader);loader.addEventListener(LoaderEvent.COMPLETE,this.onLoaderLoaded,this);loader.addEventListener(LoaderEvent.PROGRESS,this.onLoaderProgress,this);loader.addEventListener(LoaderEvent.ERROR,this.onLoaderError,this);this._loadersCount++;if(this.isLoading())loader.load()};LoadingQueue.prototype.removeLoader=function(loader){var loadersArray=loader instanceof loading.ScriptLoader?this._scriptLoaders:this._loaders;var loaderIndex=loadersArray.indexOf(loader);if(loaderIndex==-1)return;loadersArray.splice(loaderIndex,1);this.removeLoaderListeners(loader);this._loadersCount--};LoadingQueue.prototype.load=function(){if(this._state==loading.BaseLoader.STATE_LOADING)return;else if(this._state==loading.BaseLoader.STATE_LOADED){var self=this;setTimeout(function(){self._completeLoadersCount--;self.loaderHasLoaded()},0);return}this._completeLoadersCount=0;this._progress=0;this._state=loading.BaseLoader.STATE_LOADING;for(var loaderIndex in this._loaders)this._loaders[loaderIndex].load();if(0!=this._scriptLoaders.length)if(this._asyncScriptExecution)for(var loaderIndex in this._scriptLoaders)this._scriptLoaders[loaderIndex].load();else this._scriptLoaders[0].load()};LoadingQueue.prototype.stop=function(){if(this._state!=loading.BaseLoader.STATE_LOADING)return;this._state=loading.BaseLoader.STATE_IDLE;var length=this._loaders.length;for(var i=0;i<length;i++)this._loaders[i].stop();length=this._scriptLoaders.length;for(var i=0;i<length;i++)this._scriptLoaders[i].stop()};LoadingQueue.prototype.getData=function(){return null};LoadingQueue.prototype.dispose=function(){if(void 0!=this._id)loading.Loader.removeLoader(this);var loaderIndex;var length=this._loaders.length;for(loaderIndex=0;loaderIndex<length;loaderIndex++)this.disposeLoader(this._loaders[loaderIndex]);length=this._scriptLoaders.length;for(loaderIndex=0;loaderIndex<length;loaderIndex++)this.disposeLoader(this._scriptLoaders[loaderIndex]);this._loaders.length=0;this._scriptLoaders.length=0;_super.prototype.dispose.call(this)};LoadingQueue.prototype.disposeLoader=function(loader){this.removeLoaderListeners(loader);loader.dispose()};LoadingQueue.prototype.removeLoaderListeners=function(loader){loader.removeEventListener(LoaderEvent.COMPLETE,this.onLoaderLoaded,this);loader.removeEventListener(LoaderEvent.PROGRESS,this.onLoaderProgress,this);loader.removeEventListener(LoaderEvent.ERROR,this.onLoaderError,this)};LoadingQueue.prototype.loaderHasLoaded=function(event){if(event)this.dispatchEvent(new LoaderEvent(LoaderEvent.CHILD_COMPLETE,event.data),event.target);this._completeLoadersCount++;if(this._completeLoadersCount==this._loadersCount){this._state=loading.BaseLoader.STATE_LOADED;this._progress=1;this.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,{progress:1}));this.dispatchEvent(new LoaderEvent(LoaderEvent.COMPLETE))}};LoadingQueue.prototype.onLoaderLoaded=function(event){if(this._state==loading.BaseLoader.STATE_ERROR||this._state==loading.BaseLoader.STATE_IDLE)return;if(event.target instanceof loading.ScriptLoader&&!this._asyncScriptExecution){var loaderIndex=this._scriptLoaders.indexOf(event.target);if(loaderIndex<this._scriptLoaders.length-1)this._scriptLoaders[loaderIndex+1].load()}this.loaderHasLoaded(event)};LoadingQueue.prototype.onLoaderProgress=function(event){this._progress+=event.data.progressChange/this._loadersCount;this._progress=Math.min(this._progress,1);if(this._state==loading.BaseLoader.STATE_ERROR||this._state==loading.BaseLoader.STATE_IDLE)return;var data={progress:this._progress};this.dispatchEvent(new LoaderEvent(LoaderEvent.CHILD_PROGRESS,event.data),event.target);this.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,data))};LoadingQueue.prototype.onLoaderError=function(event){this.stop();this._state=loading.BaseLoader.STATE_ERROR;this.dispatchEvent(new LoaderEvent(LoaderEvent.CHILD_ERROR,event.data),event.target);this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))};return LoadingQueue}(loading.Loader);loading.LoadingQueue=LoadingQueue}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var LoaderEvent=com.egt.library.events.LoaderEvent;var PIXILoader=function(_super){__extends(PIXILoader,_super);function PIXILoader(cacheTimestamp,prependURL,id){var _this=_super.call(this,"",cacheTimestamp,prependURL,id)||this;_this._textures={};_this._pixiLoader.baseUrl=_this._prependURL?_this._prependURL:"";return _this}PIXILoader.prototype.getData=function(){return null};PIXILoader.prototype.getTexturesCount=function(){return Object.keys(this._textures).length};PIXILoader.prototype.getTexture=function(name){return this._textures[name]};PIXILoader.prototype.getTextureSequence=function(sequenceName,extension,texturesCount,sequenceDigitsCount){if(sequenceDigitsCount===void 0)sequenceDigitsCount=3;var textures=[];if(void 0==texturesCount)texturesCount=this.getTexturesCount();for(var i=0;i<texturesCount;i++)textures[i]=this.getTexture(sequenceName+library.Utils.convertToSequenceString(i,sequenceDigitsCount)+"."+extension);return textures};PIXILoader.prototype.load=function(){if(this._state==loading.BaseLoader.STATE_LOADING)return;else if(this._state==loading.BaseLoader.STATE_LOADED){var self=this;setTimeout(function(){self.onLoaded()},0);return}this._lastProgress=0;this._state=loading.BaseLoader.STATE_LOADING;this._pixiLoader.load()};PIXILoader.prototype.stop=function(){if(this._state!=loading.BaseLoader.STATE_LOADING)return;this._state=loading.BaseLoader.STATE_IDLE;this._pixiLoader.reset()};PIXILoader.prototype.addResource=function(name,src){src+=this._getParameters;this._pixiLoader.add(name,src)};PIXILoader.prototype.dispose=function(){this._pixiLoader.reset();this._pixiLoader.off("complete",this.onLoaded,this);this._pixiLoader.off("progress",this.onProgress,this);this._pixiLoader.off("error",this.onError,this);for(var key in this._textures)this._textures[key].destroy(true);_super.prototype.dispose.call(this)};PIXILoader.prototype.getResponseType=function(){throw"This method is irrelevant for this type of loader."};PIXILoader.prototype.setUpRequest=function(){this._pixiLoader=new PIXI.loaders.Loader;this._pixiLoader.on("complete",this.onLoaded,this);this._pixiLoader.on("progress",this.onProgress,this);this._pixiLoader.on("error",this.onError,this)};PIXILoader.prototype.collectTextures=function(){var resources=this._pixiLoader.resources;for(var resKey in resources)if(resources[resKey].isImage){var index=resKey.lastIndexOf("_image");var jsonName=void 0;if(index!=-1)jsonName=resKey.slice(0,index);if(resources[jsonName]&&resources[jsonName].isJson)for(var textureName in resources[jsonName].textures)this._textures[textureName]=resources[jsonName].textures[textureName];else this._textures[resKey]=resources[resKey].texture}};PIXILoader.prototype.onLoaded=function(event){if(event){var data={progress:event.progress/100,progressChange:(event.progress-this._lastProgress)/100};this._lastProgress=event.progress;this.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,data));for(var key in this._pixiLoader.resources)if(null!=this._pixiLoader.resources[key].error){this.onError(null);return}this.collectTextures()}else this.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,{progress:1,progressChange:0}));this._state=loading.BaseLoader.STATE_LOADED;this.dispatchEvent(new LoaderEvent(LoaderEvent.COMPLETE))};PIXILoader.prototype.onProgress=function(event){var data={progress:event.progress/100,progressChange:(event.progress-this._lastProgress)/100};this._lastProgress=event.progress;this.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,data))};PIXILoader.prototype.onError=function(event){if(this._state==loading.BaseLoader.STATE_ERROR)return;this._state=loading.BaseLoader.STATE_ERROR;this._pixiLoader.reset();this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))};return PIXILoader}(loading.BaseLoader);loading.PIXILoader=PIXILoader}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var LoaderEvent=com.egt.library.events.LoaderEvent;var ScriptLoader=function(_super){__extends(ScriptLoader,_super);function ScriptLoader(src,cacheTimestamp,prependURL,id){return _super.call(this,src,cacheTimestamp,prependURL,id)||this}ScriptLoader.prototype.getData=function(){return this._script};ScriptLoader.prototype.load=function(){if(this._state==loading.BaseLoader.STATE_LOADING)return;else if(this._state==loading.BaseLoader.STATE_LOADED){var self=this;setTimeout(function(){self.onLoaded()},0);return}this._lastProgress=0;this._state=loading.BaseLoader.STATE_LOADING;$("head")[0].appendChild(this._script)};ScriptLoader.prototype.stop=function(){if(this._state!=loading.BaseLoader.STATE_LOADING)return;this._state=loading.BaseLoader.STATE_IDLE};ScriptLoader.prototype.dispose=function(){this._script.onload=null;this._script.onerror=null;$(this._script).remove();_super.prototype.dispose.call(this)};ScriptLoader.prototype.getResponseType=function(){throw"This method is irrelevant for this type of loader."};ScriptLoader.prototype.setUpRequest=function(){this._script=document.createElement("script");this._script.onload=this.onLoaded.bind(this);this._script.onerror=this.onError.bind(this);var prependURL=this._prependURL?this._prependURL:"";this._script.src=prependURL+this._src+this._getParameters};ScriptLoader.prototype.onLoaded=function(event){this._state=loading.BaseLoader.STATE_LOADED;this.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,{progress:1,progressChange:1}));this.dispatchEvent(new LoaderEvent(LoaderEvent.COMPLETE))};ScriptLoader.prototype.onError=function(event){this._state=loading.BaseLoader.STATE_ERROR;this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))};return ScriptLoader}(loading.BaseLoader);loading.ScriptLoader=ScriptLoader}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var LoaderEvent=com.egt.library.events.LoaderEvent;var SoundLoader=function(_super){__extends(SoundLoader,_super);function SoundLoader(src,cacheTimestamp,prependURL,id){var _this=_super.call(this,src,cacheTimestamp,prependURL,id)||this;_this._data=null;return _this}SoundLoader.prototype.getData=function(){return this._data};SoundLoader.prototype.getResponseType=function(){return"arraybuffer"};SoundLoader.prototype.onLoaded=function(event){if(void 0==event){this.dispatchEvent(new LoaderEvent(LoaderEvent.COMPLETE,this._data));return}if(!library.Device.isSoundSupported()){this._state=loading.BaseLoader.STATE_ERROR;this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))}else{var self=this;if(null==window.audioContextInstance)window.audioContextInstance=new(library.Device.getAudioContext());var audioContext=window.audioContextInstance;audioContext.decodeAudioData(this._request.response,function(buffer){self.onBufferDecoded(buffer)},function(){self.onBufferDecodeError()})}};SoundLoader.prototype.onError=function(event){this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))};SoundLoader.prototype.onBufferDecoded=function(buffer){this._data=buffer;this.dispatchEvent(new LoaderEvent(LoaderEvent.COMPLETE,this._data))};SoundLoader.prototype.onBufferDecodeError=function(){this._state=loading.BaseLoader.STATE_ERROR;this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))};return SoundLoader}(loading.BaseLoader);loading.SoundLoader=SoundLoader}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var LoaderEvent=com.egt.library.events.LoaderEvent;var VideoLoader=function(_super){__extends(VideoLoader,_super);function VideoLoader(src,cacheTimestamp,prependURL,id){var _this=_super.call(this,src,cacheTimestamp,prependURL,id)||this;_this._video=null;return _this}VideoLoader.prototype.getData=function(){return this._video};VideoLoader.prototype.getResponseType=function(){return"blob"};VideoLoader.prototype.onLoaded=function(event){this._video=document.createElement("video");this._video.src=URL.createObjectURL(this._request.response);this._video.autoplay=true;this._video.playsInline=true;this._video.muted=true;this._video.oncanplay=this.onCanPlay.bind(this);this._video.oncanplaythrough=this.onCanPlay.bind(this);this._video.onerror=this.onDecodeError.bind(this)};VideoLoader.prototype.onCanPlay=function(){this._video.pause();this._video.currentTime=0;this._video.oncanplay=null;this._video.oncanplaythrough=null;this._video.width=this._video.videoWidth;this._video.height=this._video.videoHeight;this.dispatchEvent(new LoaderEvent(LoaderEvent.COMPLETE))};VideoLoader.prototype.onDecodeError=function(){this.dispatchEvent(new LoaderEvent(LoaderEvent.DECODE_ERROR))};VideoLoader.prototype.onError=function(event){this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))};return VideoLoader}(loading.BaseLoader);loading.VideoLoader=VideoLoader}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var loading;!function(loading){var LoaderEvent=com.egt.library.events.LoaderEvent;var XMLLoader=function(_super){__extends(XMLLoader,_super);function XMLLoader(src,cacheTimestamp,prependURL,id){return _super.call(this,src,cacheTimestamp,prependURL,id)||this}XMLLoader.prototype.getData=function(){return this._request.response};XMLLoader.prototype.getResponseType=function(){return"text"};XMLLoader.prototype.onLoaded=function(event){this.dispatchEvent(new LoaderEvent(LoaderEvent.COMPLETE,this._request.response))};XMLLoader.prototype.onError=function(event){this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))};return XMLLoader}(loading.BaseLoader);loading.XMLLoader=XMLLoader}(loading=library.loading||(library.loading={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var utils;!function(utils){var BrowserDetect=function(){function BrowserDetect(){}BrowserDetect.detect=function(){if("undefined"!==typeof navigator)return BrowserDetect.parseUserAgent(navigator.userAgent);return null};BrowserDetect.detectOS=function(userAgentString){var rules=BrowserDetect.getOperatingSystemRules();var detected=rules.filter(function(os){return os.rule&&os.rule.test(userAgentString)})[0];return detected?detected.name:null};BrowserDetect.parseUserAgent=function(userAgentString){var browsers=BrowserDetect.getBrowserRules();if(!userAgentString)return null;var detected=browsers.map(function(browser){var match=browser.rule.exec(userAgentString);var version=match&&match[1].split(/[._]/).slice(0,3);if(version&&version.length<3)version=version.concat(1==version.length?[0,0]:[0]);return match&&{name:browser.name,version:version.join(".")}}).filter(Boolean)[0]||null;if(detected)detected.os=BrowserDetect.detectOS(userAgentString);if(/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/i.test(userAgentString)){detected=detected||{};detected.bot=true}return detected};BrowserDetect.getBrowserRules=function(){return BrowserDetect.buildRules([["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\ ([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/]])};BrowserDetect.getOperatingSystemRules=function(){return BrowserDetect.buildRules([["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]])};BrowserDetect.buildRules=function(ruleTuples){return ruleTuples.map(function(tuple){return{name:tuple[0],rule:tuple[1]}})};return BrowserDetect}();utils.BrowserDetect=BrowserDetect}(utils=library.utils||(library.utils={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){}(egt=com.egt||(com.egt={}))}(com||(com={}));!function(com){var egt;!function(egt){var library;!function(library){var BrowserDetect=com.egt.library.utils.BrowserDetect;var LogServer=function(){function LogServer(){}LogServer.sendStatisticUsage=function(data){};LogServer.sendError=function(e){e.projectName=e.projectName||com.egt.projectMetadata.projectName;e.projectBuild=e.projectBuild||com.egt.projectMetadata.projectBuild;LogServer.postData(LogServer.serverPostError,e)};LogServer.sendLog=function(objectToLog){LogServer.postData(LogServer.LogObjectServerAdress,objectToLog)};LogServer.postData=function(url,data,callback){if(callback===void 0)callback=null;$.ajax({type:"POST",url:url,data:data,success:callback,dataType:"json"})};LogServer.ErrorLogServerAdress="";LogServer.LogObjectServerAdress="";LogServer.serverPostError=LogServer.ErrorLogServerAdress+"/api/errors";LogServer.serverPostStatistic=LogServer.ErrorLogServerAdress+"/api/statistic";return LogServer}();library.LogServer=LogServer}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var Device=com.egt.library.Device;var MobileView=function(_super){__extends(MobileView,_super);function MobileView(){var _this=_super.call(this)||this;if(!MobileView._isListening){MobileView.listenForOrientationChange();MobileView._isListening=true}MobileView._instances.push(_this);return _this}MobileView.dispose=function(){window.removeEventListener("orientationchange",MobileView.onOrientationChange);MobileView._instances.length=0;MobileView._isListening=false};Object.defineProperty(MobileView,"deviceOrientation",{get:function(){return Device.currentOrientation},enumerable:true,configurable:true});MobileView.listenForOrientationChange=function(){MobileView._currentOrientation=Device.currentOrientation;window.addEventListener("orientationchange",MobileView.onOrientationChange)};MobileView.onOrientationChange=function(){var deviceOrientation=MobileView.deviceOrientation;if(deviceOrientation!==MobileView._currentOrientation){MobileView._currentOrientation=deviceOrientation;MobileView.callOrientationChange();return}};MobileView.callOrientationChange=function(){for(var _i=0,_a=MobileView._instances;_i<_a.length;_i++){var instance=_a[_i];instance.onRotationChange()}};MobileView._instances=new Array;MobileView._currentOrientation=null;MobileView._isListening=false;return MobileView}(PIXI.Container);library.MobileView=MobileView}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var players;!function(players){var MediaEvents;!function(MediaEvents){MediaEvents["play"]="play";MediaEvents["pause"]="pause";MediaEvents["ended"]="ended";MediaEvents["error"]="error";MediaEvents["videoReady"]="videoReady"}(MediaEvents=players.MediaEvents||(players.MediaEvents={}))}(players=library.players||(library.players={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var utils;!function(utils){var log;!function(log_1){log_1.log=LogFunction("log");log_1.warn=LogFunction("warn");log_1.error=LogFunction("error");log_1.isEnabled=false;log_1.isStylized=false;var Config=function(){function Config(){this.isEnabled=false;this.isStylized=false}return Config}();log_1.Config=Config;function decorator(){var args=[];for(var _i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];switch(args.length){case 1:return logClass.apply(this,args);case 2:return logProperty.apply(this,args);case 3:if("number"===typeof args[2])return logParameter.apply(this,args);else if("undefined"===typeof args[2])return logProperty.apply(this,args);return logMethod.apply(this,args);default:throw new Error("Decorators are not valid here!")}}log_1.decorator=decorator;function decoratorConfig(config){return function(target){return logClass(target,config)}}log_1.decoratorConfig=decoratorConfig;var logMethods=["log","warn","error"];var logClass;var logMethod;var logProperty;var logParameter;function noop(){}function LogFunction(level){return function(){var args=[];for(var _i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];output.apply(void 0,[level,level].concat(args))}}function output(level){var args=[];for(var _i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];if("string"===typeof args[0])args[0]="[EGT]["+this+"] "+args[0];else args.unshift("[EGT]["+this+"]");console[level].apply(console,args)}function outputStylized(instance,level,style){var args=[];for(var _i=3;_i<arguments.length;_i++)args[_i-3]=arguments[_i];if("string"===typeof args[0]){args[0]="[EGT][%c"+instance+"%c] "+args[0];args.splice(1,0,style,"")}else args.unshift("[EGT][%c"+instance,style,"]");console[level].apply(console,args)}function addToStringMethod(prototype){if(prototype&&!prototype.hasOwnProperty("toString"))Object.defineProperty(prototype,"toString",{value:function(){return this.constructor["name"]}})}function stringify(o){return JSON.stringify(o,function(k,v){return k?""+v:v})}if(true){logClass=function(target,config){var constructorName=target.prototype.constructor["name"];var objectProperties={};var isForceEnabled=false;var isForceDisabled=false;var isForceStylizedEnabled=false;var isForceStylizedDisabled=false;var style;if(config){if("string"===typeof config.style)style=config.style;if("boolean"===typeof config.isEnabled){isForceEnabled=config.isEnabled?true:false;isForceDisabled=!isForceEnabled}if("boolean"===typeof config.isStylized){isForceStylizedEnabled=config.isStylized?true:false;isForceStylizedDisabled=!isForceStylizedEnabled}}if("string"!==typeof style)if(/View$/.test(constructorName))style="color: #41BBD9;";else if(/Model$/.test(constructorName))style="color: #99C24D;";else if(/Controller$/.test(constructorName))style="color: #F18F01;";logMethods.forEach(function(level){objectProperties[level]={value:function(){var args=[];for(var _i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];if(isForceEnabled||log_1.isEnabled&&!isForceDisabled)if(isForceStylizedEnabled||log_1.isStylized&&!isForceStylizedDisabled)outputStylized.apply(void 0,[this,level,style].concat(args));else output.apply(void 0,[this,level].concat(args))}}});Object.defineProperties(target.prototype,objectProperties);addToStringMethod(target.prototype);return target};logProperty=function(target,key){var value=this[key];var getter=function(){output(target,"log","Get "+target+"."+key+" => "+value);return value};var setter=function(newValue){output(target,"log","Set "+target+"."+key+" => "+newValue);value=newValue};if(delete this[key])Object.defineProperty(target,key,{get:getter,set:setter,enumerable:true,configurable:true})};logMethod=function(target,key,descriptor){addToStringMethod(target);var originalMethod=descriptor.value;descriptor.value=function(){var args=[];for(var _i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var resultString;var argsString=args.map(function(a){try{return stringify(a)}catch(e){return String(a)}}).join(", ");var label=this+"."+key+"("+argsString+")";output(this,"log","Call: "+label);var result=originalMethod.apply(this,args);try{resultString=stringify(result)}catch(e){resultString=String(result)}output(this,"log","Result: "+label+" => "+resultString);return result};return descriptor};logParameter=function(target,key,index){output(target,"log",target+"."+key+"("+index+")")}}else{logClass=function logClass(target,config){var objectProperties={};logMethods.forEach(function(level){objectProperties[level]={value:noop}});Object.defineProperties(target.prototype,objectProperties);return target};logProperty=noop;logMethod=function(target,key,descriptor){return descriptor};logParameter=noop}}(log=utils.log||(utils.log={}))}(utils=library.utils||(library.utils={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var players;!function(players){var log=com.egt.library.utils.log;var Loader=com.egt.library.loading.Loader;var MediaEvents=com.egt.library.players.MediaEvents;var VideoPlayer=function(_super){__extends(VideoPlayer,_super);function VideoPlayer(loaderId,loop,autoPlay,muted,volume,fps){if(loop===void 0)loop=false;if(autoPlay===void 0)autoPlay=false;if(muted===void 0)muted=true;if(volume===void 0)volume=1;if(fps===void 0)fps=30;var _this=_super.call(this)||this;_this.loaderId=loaderId;_this.log("Initializing...");_this.loadVideo();_this.createElements();_this.fps=fps;_this.loop=loop;_this.muted=true;_this.volume=volume;if(autoPlay)_this.play();return _this}VideoPlayer.prototype.play=function(){this.log("Requesting playback, current time[%s]...",this.currentTime);this.attachEvents();this._isVideoReady=false;this._video.play();return this};VideoPlayer.prototype.pause=function(){this.log("Requesting pause...");this._video.pause();return this};VideoPlayer.prototype.destroy=function(){this.log("Destroying...");this._pause(false);this.detachEvents();if(this.parent)this.parent.removeChild(this);if(this._video)this._video=null;this._outputTexture=null;this._outputCanvas=null;this._outputCanvasContext=null;_super.prototype.destroy.call(this,true,true)};Object.defineProperty(VideoPlayer.prototype,"fps",{get:function(){return 1e3/this._frameProcessIntervalMs},set:function(value){this._frameProcessIntervalMs=1e3/value},enumerable:true,configurable:true});Object.defineProperty(VideoPlayer.prototype,"loop",{get:function(){return this._video.loop},set:function(value){this._video.loop=value},enumerable:true,configurable:true});Object.defineProperty(VideoPlayer.prototype,"muted",{get:function(){return this._video.muted},set:function(value){this._video.muted=value},enumerable:true,configurable:true});Object.defineProperty(VideoPlayer.prototype,"volume",{get:function(){return this._video.volume},set:function(value){this._video.volume=value},enumerable:true,configurable:true});Object.defineProperty(VideoPlayer.prototype,"duration",{get:function(){return this._video.duration},enumerable:true,configurable:true});Object.defineProperty(VideoPlayer.prototype,"currentTime",{get:function(){return this._video.currentTime},set:function(value){this._video.currentTime=value},enumerable:true,configurable:true});Object.defineProperty(VideoPlayer.prototype,"ended",{get:function(){return this._video.ended},enumerable:true,configurable:true});Object.defineProperty(VideoPlayer.prototype,"width",{get:function(){return this._width},set:function(value){this.warn("Unable to change width of video. Use scale instead.")},enumerable:true,configurable:true});Object.defineProperty(VideoPlayer.prototype,"height",{get:function(){return this._height},set:function(value){this.warn("Unable to change height of video. Use scale instead.")},enumerable:true,configurable:true});Object.defineProperty(VideoPlayer.prototype,"paused",{get:function(){return this._video.paused},enumerable:true,configurable:true});VideoPlayer.prototype.createElements=function(){this._outputCanvas=new PIXI.CanvasBuffer(this._width,this._height).canvas;this._outputTexture=new PIXI.BaseTexture(this._outputCanvas);this.texture=new PIXI.Texture(this._outputTexture);this._outputCanvasContext=this._outputCanvas.getContext("2d")};VideoPlayer.prototype.setResolution=function(){this._width=this._video.videoWidth;
this._height=this._video.videoHeight};VideoPlayer.prototype.loadVideo=function(){var _this=this;this._video=Loader.getLoader(this.loaderId).getData();this.setResolution();this.log("Video resolution[%sx%s] container resolution[%sx%s]",this._video.videoWidth,this._video.videoHeight,this._width,this._height);this._onPlay=function(){return _this.onPlay()};this._onTimeUpdate=function(){return _this.onTimeUpdate()};this._onPause=function(){return _this.onPause()};this._onEnded=function(){return _this.onEnded()};this._onError=function(){return _this.onError()}};VideoPlayer.prototype.onTimeUpdate=function(){this.log("Time update current time[%s]...",this.currentTime);if(!this._isPlaying&&this.currentTime>0){this._isVideoReady=true;this._play();this.emit(MediaEvents.videoReady)}};VideoPlayer.prototype.processFrame=function(){this._outputCanvasContext.drawImage(this._video,0,0);this._outputTexture.update()};VideoPlayer.prototype.onEnded=function(){this.log("Playback ended, current time[%s]",this.currentTime);this._pause(true);this.detachEvents();this.emit(MediaEvents.ended)};VideoPlayer.prototype.onPlay=function(){this.log("Playback started from[%s]sec fps[%s] loop[%s] volume[%s] muted[%s]",this.currentTime,this.fps,this.loop,this.volume,this.muted);if(this._isVideoReady)this._play();this.emit(MediaEvents.play)};VideoPlayer.prototype.onPause=function(){this.log("Playback paused at[%s]sec",this.currentTime);this._pause(true);this.emit(MediaEvents.pause)};VideoPlayer.prototype.onError=function(){this.error("Playback error code[%s] message",this._video.error.code,this._video.error.message);this.emit(MediaEvents.error,this._video.error)};VideoPlayer.prototype.attachEvents=function(){if(this._video){this.log("Attaching events...");this._video.addEventListener("play",this._onPlay);this._video.addEventListener("timeupdate",this._onTimeUpdate);this._video.addEventListener("pause",this._onPause);this._video.addEventListener("ended",this._onEnded);this._video.addEventListener("error",this._onError)}else this.warn("There is no video to attach event to")};VideoPlayer.prototype.detachEvents=function(){if(this._video){this.log("Detaching events...");this._video.removeEventListener("play",this._onPlay);this._video.removeEventListener("timeupdate",this._onTimeUpdate);this._video.removeEventListener("pause",this._onPause);this._video.removeEventListener("ended",this._onEnded);this._video.removeEventListener("error",this._onError)}else this.warn("There is no video to detach event from")};VideoPlayer.prototype._play=function(){var _this=this;if(this._isPlaying)return this.warn("Already playing current time[%s]...",this.currentTime);this.log("Starting processing frames current time[%s]...",this.currentTime);this._isPlaying=true;this.processFrame();this._frameProcessInterval=setInterval(function(){return _this.processFrame()},this._frameProcessIntervalMs)};VideoPlayer.prototype._pause=function(processLastFrame){if(processLastFrame===void 0)processLastFrame=false;if(!this._isPlaying)return this.warn("Already paused current time[%s]...",this.currentTime);if(processLastFrame)this.processFrame();this.log("Stopped processing frames current time[%s]...",this.currentTime);this._isPlaying=false;clearInterval(this._frameProcessInterval)};VideoPlayer.prototype.toString=function(){return this.constructor["name"]+" "+this.loaderId};VideoPlayer=__decorate([log.decorator],VideoPlayer);return VideoPlayer}(PIXI.Sprite);players.VideoPlayer=VideoPlayer}(players=library.players||(library.players={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var players;!function(players){var VideoPlayerAlpha=function(_super){__extends(VideoPlayerAlpha,_super);function VideoPlayerAlpha(){return null!==_super&&_super.apply(this,arguments)||this}VideoPlayerAlpha.prototype.destroy=function(){this._bufferCanvas=null;this._bufferCanvasContext=null;_super.prototype.destroy.call(this)};VideoPlayerAlpha.prototype.createElements=function(){_super.prototype.createElements.call(this);this._bufferCanvas=new PIXI.CanvasBuffer(this._video.videoWidth,this._video.videoHeight).canvas;this._bufferCanvasContext=this._bufferCanvas.getContext("2d")};VideoPlayerAlpha.prototype.setResolution=function(){this._width=this._video.videoWidth;this._height=this._video.videoHeight/2};VideoPlayerAlpha.prototype.processFrame=function(){this._bufferCanvasContext.drawImage(this._video,0,0);var image=this._bufferCanvasContext.getImageData(0,0,this._width,this._height),imageData=image.data,alphaData=this._bufferCanvasContext.getImageData(0,this._height,this._width,this._height).data;for(var i=3,len=imageData.length;i<len;i+=4)imageData[i]=alphaData[i-1];this._outputCanvasContext.putImageData(image,0,0,0,0,this._width,this._height);this._outputTexture.update()};return VideoPlayerAlpha}(players.VideoPlayer);players.VideoPlayerAlpha=VideoPlayerAlpha}(players=library.players||(library.players={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var sound;!function(sound){var SoundLoader=com.egt.library.loading.SoundLoader;var LoaderEvent=com.egt.library.events.LoaderEvent;var EventDispatcher=com.egt.library.events.EventDispatcher;var Device=com.egt.library.Device;var events=com.egt.library.events;var log=com.egt.library.utils.log;var SoundManager=function(_super){__extends(SoundManager,_super);function SoundManager(cacheTimestamp){var _this=_super.call(this)||this;_this._soundLoaders={};_this._soundSources={};_this._sounds={};_this._soundBuffers={};_this._mute=true;_this._cacheTimestamp=cacheTimestamp;if(Device.isSoundSupported()){if(null==window.audioContextInstance)window.audioContextInstance=new(Device.getAudioContext());_this._audioContext=window.audioContextInstance;_this._masterGain=_this._audioContext.createGain();_this._masterGain.connect(_this._audioContext.destination);_this._masterGain.gain.value=1}return _this}SoundManager_1=SoundManager;SoundManager.prototype.playDummySound=function(dummyBuffer){if(this._audioContext){var source=this._audioContext.createBufferSource();source.buffer=dummyBuffer;source.connect(this._audioContext.destination);source.start(0,0,1)}};SoundManager.prototype.registerSounds=function(sounds,prependURL,cacheTimestamp){if(0==sounds.length)return;var len=sounds.length;for(var i=0;i<len;i++){var id=sounds[i].id||sounds[i].src;if(this._soundSources[id]){this.warn("Sound[%s] already registered",sounds[i].src);continue}this._soundSources[id]=sounds[i].src;var soundGroup=sounds[i].sounds;var len2=soundGroup.length;for(var j=0;j<len2;j++){var obj=soundGroup[j];this._sounds[obj.name]={start:obj.start,duration:obj.duration,soundId:id,name:obj.name}}this.log("Loading sound[%s]...",sounds[i].src);var soundLoader=new SoundLoader(this._soundSources[id],cacheTimestamp||this._cacheTimestamp,prependURL,id);soundLoader.addEventListener(LoaderEvent.COMPLETE,this.onSoundLoaded,this);soundLoader.addEventListener(LoaderEvent.ERROR,this.onSoundError,this);this._soundLoaders[id]=soundLoader}};SoundManager.prototype.hasSound=function(soundName){if(!this._sounds[soundName])return false;return true};SoundManager.prototype.isSoundLoaded=function(soundName){if(!this._sounds[soundName]||!this._soundBuffers[this._sounds[soundName].soundId])return false;return true};SoundManager.prototype.load=function(id){if(!this._audioContext||void 0!==this._soundBuffers[id])return;this._soundBuffers[id]=null;this._soundLoaders[id].load()};SoundManager.prototype.loadAll=function(){for(var key in this._soundSources)this.load(key)};SoundManager.prototype.getSoundDuration=function(soundName){var soundInfo=this._sounds[soundName];if(!soundName||!this._audioContext||!soundInfo||!this._soundBuffers[soundInfo.soundId])return-1;return soundInfo.duration};SoundManager.prototype.play=function(soundName,loop,volume){if(loop===void 0)loop=false;if(volume===void 0)volume=1;if(!soundName||!this._audioContext||!this._sounds[soundName]||!this._soundBuffers[this._sounds[soundName].soundId]){this.warn("Unable to play sound[%s]",soundName);return null}if("suspended"==this._audioContext.state&&void 0!==this._audioContext.resume){this._audioContext.resume();if(!loop)return}var soundInfo=this._sounds[soundName];var source=this._audioContext.createBufferSource();source.buffer=this._soundBuffers[soundInfo.soundId];var instance=new SoundInstance(source,this._masterGain,soundInfo,loop);instance.volume=volume;return instance};SoundManager.prototype.playStream=function(soundURI){var _this=this;if(!soundURI||!this._audioContext){this.warn("Unable to stream sound[%s]",soundURI);return null}var audioElement=document.createElement("audio");audioElement.crossOrigin="anonymous";var source=this._audioContext.createMediaElementSource(audioElement);audioElement.muted=this.isMuted;source.connect(this._audioContext.destination);audioElement.src=soundURI;audioElement.autoplay=true;audioElement.addEventListener("ended",function(){source.disconnect(_this._audioContext.destination)});return new StreamSoundInstance(source,this._masterGain,audioElement)};Object.defineProperty(SoundManager.prototype,"isContextSuspended",{get:function(){return this._audioContext&&"suspended"==this._audioContext.state?true:false},enumerable:true,configurable:true});Object.defineProperty(SoundManager.prototype,"isMuted",{get:function(){return this._mute},set:function(value){if(!this._audioContext)return;this._mute=value;if(this._mute)this._masterGain.gain.value=0;else this._masterGain.gain.value=1},enumerable:true,configurable:true});SoundManager.prototype.dispose=function(){for(var key in this._soundLoaders){var soundLoader=this._soundLoaders[key];soundLoader.removeEventListener(LoaderEvent.COMPLETE,this.onSoundLoaded,this);soundLoader.removeEventListener(LoaderEvent.ERROR,this.onSoundError,this);soundLoader.dispose()}_super.prototype.dispose.call(this)};SoundManager.prototype.onSoundLoaded=function(event){event.target.removeEventListener(LoaderEvent.COMPLETE,this.onSoundLoaded,this);event.target.removeEventListener(LoaderEvent.ERROR,this.onSoundError,this);var id=event.target.id;this.log("Sound loaded[%s]",this._soundSources[id]);this._soundBuffers[id]=event.data;this.dispatchEvent(new events.Event(SoundManager_1.SOUND_LOADED,{soundId:id}))};SoundManager.prototype.onSoundError=function(event){this.error("Unable to load sound[%s]",event.target.src);event.target.removeEventListener(LoaderEvent.COMPLETE,this.onSoundLoaded,this);event.target.removeEventListener(LoaderEvent.ERROR,this.onSoundError,this)};SoundManager.SOUND_LOADED="soundLoaded";SoundManager=SoundManager_1=__decorate([log.decoratorConfig({style:"color: #A3D9FF"})],SoundManager);return SoundManager;var SoundManager_1}(EventDispatcher);sound.SoundManager=SoundManager;var StreamSoundInstance=function(_super){__extends(StreamSoundInstance,_super);function StreamSoundInstance(source,masterGain,audioElement){var _this=_super.call(this)||this;_this._hasSoundEned=false;_this._gainNode=source.context.createGain();_this._gainNode.connect(masterGain);source.connect(_this._gainNode);_this._source=source;_this._audioElement=audioElement;return _this}Object.defineProperty(StreamSoundInstance.prototype,"volume",{get:function(){return this._gainNode.gain.value},set:function(value){value=Math.min(Math.max(value,0),1);this._gainNode.gain.value=value;this._audioElement.volume=value},enumerable:true,configurable:true});StreamSoundInstance.prototype.stop=function(){this._audioElement.pause()};StreamSoundInstance.prototype.onSoundEnded=function(){this.dispatchEvent(new events.Event("ended"))};return StreamSoundInstance}(EventDispatcher);var SoundInstance=function(_super){__extends(SoundInstance,_super);function SoundInstance(source,masterGain,soundInfo,loop){var _this=_super.call(this)||this;_this._hasSoundEned=false;_this._gainNode=source.context.createGain();_this._gainNode.connect(masterGain);source.connect(_this._gainNode);source.loop=loop;source.loopStart=soundInfo.start;source.loopEnd=soundInfo.start+soundInfo.duration;source.onended=_this.onSoundEnded.bind(_this);_this._source=source;_this._soundInfo=soundInfo;_this.log("Started");if(loop)_this._source.start(0,_this._soundInfo.start);else{_this._onEndDelay=TweenMax.delayedCall(soundInfo.duration,_this.onSoundEnded,null,_this);_this._source.start(0,_this._soundInfo.start,_this._soundInfo.duration)}return _this}Object.defineProperty(SoundInstance.prototype,"volume",{get:function(){return this._gainNode.gain.value},set:function(value){value=Math.min(Math.max(value,0),1);this._gainNode.gain.value=value},enumerable:true,configurable:true});Object.defineProperty(SoundInstance.prototype,"playbackRate",{get:function(){return this._source.playbackRate.value},set:function(value){value=Math.abs(value);this._source.playbackRate.value=value},enumerable:true,configurable:true});SoundInstance.prototype.stop=function(){if(!this._isStopped){this.log("Stopped");this._isStopped=true;this._source.stop();if(null!=this._onEndDelay)this._onEndDelay.totalTime(this._onEndDelay.totalDuration())}};SoundInstance.prototype.onSoundEnded=function(){if(!this._hasSoundEned){this.log("Ended");this._hasSoundEned=true;if(this._onEndDelay){this._onEndDelay.kill();this._onEndDelay=null}this.dispatchEvent(new events.Event("ended"))}};SoundInstance.prototype.toString=function(){return this.constructor["name"]+" "+this._soundInfo.soundId+"/"+this._soundInfo.name};SoundInstance=__decorate([log.decoratorConfig({style:"color: #006E90"})],SoundInstance);return SoundInstance}(EventDispatcher)}(sound=library.sound||(library.sound={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var utils;!function(utils){var CanvasConsoleConfig=function(){function CanvasConsoleConfig(){this.consoleWidth=1280;this.consoleHeight=720;this.consoleAlpha=.2;this.addHideButton=true;this.addScrollButtons=false;this.attatchConsoleLog=false;this.attatchConsoleError=true;this.backgroundColor=1048575;this.scrollButtonsColor=16776960;this.showOnError=true}return CanvasConsoleConfig}();utils.CanvasConsoleConfig=CanvasConsoleConfig;var CanvasConsole=function(_super){__extends(CanvasConsole,_super);function CanvasConsole(config){var _this=_super.call(this)||this;_this.errorCounter=0;CanvasConsole.instance=_this;if(!config)config=new CanvasConsoleConfig;_this.config=config;_this.init();_this.attachToConsole();_this.hide();return _this}CanvasConsole.getInstance=function(){if(!this.instance)this.instance=new CanvasConsole;return CanvasConsole.instance};CanvasConsole.prototype.show=function(){this.visible=true;return this};CanvasConsole.prototype.hide=function(){this.visible=false;return this};CanvasConsole.prototype.print=function(message,color,fontSize){if(color===void 0)color=16777215;if(fontSize===void 0)fontSize=30;var text=new PIXI.Text(message,{fill:color,fontSize:fontSize,wordWrap:true,wordWrapWidth:this.config.consoleWidth-CanvasConsole.TEXT_STARTING_X});var currentTextHeight=this.consoleContainer.children.map(function(textContainer){return textContainer.height+CanvasConsole.TEXT_Y_SPACING}).reduce(function(totalHeight,currentHeight){return totalHeight+currentHeight},0);var textContainer=new PIXI.Container;textContainer.addChild(text);textContainer.x=CanvasConsole.TEXT_STARTING_X;textContainer.y=CanvasConsole.TEXT_STARTING_Y+currentTextHeight;this.consoleContainer.addChild(textContainer);if(CanvasConsole.TEXT_STARTING_Y+currentTextHeight>this.config.consoleHeight)this.consoleContainer.y=-currentTextHeight;return this};CanvasConsole.prototype.clearConsole=function(){while(this.consoleContainer.children.length>0)this.consoleContainer.removeChildAt(0);this.errorCounter=0;this.consoleContainer.y=0;return this};CanvasConsole.prototype.scrollDown=function(timesScroll){if(timesScroll===void 0)timesScroll=1;this.consoleContainer.y-=CanvasConsole.SCROLLING_Y_STEP*timesScroll;return this};CanvasConsole.prototype.scrollUp=function(timesScroll){if(timesScroll===void 0)timesScroll=1;if(this.consoleContainer.y<CanvasConsole.SCROLLING_Y_STEP)this.consoleContainer.y+=CanvasConsole.SCROLLING_Y_STEP*timesScroll;return this};CanvasConsole.prototype.dispose=function(){};CanvasConsole.prototype.init=function(){var background=new PIXI.Graphics;background.beginFill(this.config.backgroundColor,this.config.consoleAlpha);background.drawRect(0,0,this.config.consoleWidth,this.config.consoleHeight);background.endFill();this.addChild(background);this.consoleContainer=new PIXI.Container;this.addChild(this.consoleContainer);if(this.config.addHideButton){this.hideButton=this.getRect(6877101,70,70);this.hideButton.y=this.config.consoleHeight-this.hideButton.height-80;this.hideButton.x=this.config.consoleWidth-this.hideButton.width-150;this.addChild(this.hideButton);this.setupHideButtonEvents()}if(this.config.addScrollButtons){this.scrollDownButton=this.getTriangle(this.config.scrollButtonsColor);this.scrollUpButton=this.getTriangle(this.config.scrollButtonsColor);this.scrollUpButton.anchor.x=this.scrollUpButton.anchor.y=this.scrollDownButton.anchor.x=this.scrollDownButton.anchor.y=.5;this.scrollDownButton.x=this.config.consoleWidth-this.scrollDownButton.width-20;this.scrollUpButton.x=this.config.consoleWidth-this.scrollUpButton.width-20;this.scrollDownButton.y=this.config.consoleHeight-this.scrollDownButton.height;this.scrollUpButton.y=this.config.consoleHeight-this.scrollUpButton.height-80;this.scrollDownButton.rotation+=3.15;this.addChild(this.scrollDownButton);this.addChild(this.scrollUpButton);this.setupScrollButtonsEvents()}};CanvasConsole.prototype.attachToConsole=function(){var _this=this;var origLog=console.log;var origError=console.error;var self=this;if(this.config.attatchConsoleLog)console.log=function(){this.log(arguments[0]);return origLog.apply(this,arguments)};if(this.config.attatchConsoleError){window.addEventListener("error",function(e){if(self.config.showOnError)self.show();if(e.error.stack)_this.printError(_this.errorCounter+". "+e.message+"\n\t"+e.error.stack.split("@").join("\n\t"));else _this.printError(_this.errorCounter+". Error at line - "+e.lineno+"\n\t"+e.message+"\n\t"+e.filename+"\n\t")});console.error=function(){if(self.config.showOnError)self.show();this.error(arguments[0]);return origError.apply(this,arguments)}}};CanvasConsole.prototype.printLog=function(message){this.print(message)};CanvasConsole.prototype.printError=function(message){this.errorCounter++;this.print(message,16711680)};CanvasConsole.prototype.setupScrollButtonsEvents=function(on){if(on===void 0)on=true;if(on){this.scrollUpButton.on(library.Device.resolveEvent("click"),this.onScrollUpButtonClicked,this);this.scrollDownButton.on(library.Device.resolveEvent("click"),this.onScrollDownButtonClicked,this)}else{this.scrollUpButton.off(library.Device.resolveEvent("click"),this.onScrollUpButtonClicked,this);this.scrollDownButton.off(library.Device.resolveEvent("click"),this.onScrollDownButtonClicked,this)}};CanvasConsole.prototype.setupHideButtonEvents=function(on){if(on===void 0)on=true;if(on)this.hideButton.on(library.Device.resolveEvent("click"),this.onHideButtonClicked,this);else this.hideButton.off(library.Device.resolveEvent("click"),this.onHideButtonClicked,this)};CanvasConsole.prototype.onHideButtonClicked=function(){this.hide()};CanvasConsole.prototype.onScrollDownButtonClicked=function(){this.scrollDown(2)};CanvasConsole.prototype.onScrollUpButtonClicked=function(){this.scrollUp(2)};CanvasConsole.prototype.getTriangle=function(color){var triangle=new PIXI.Graphics;triangle.beginFill(color);triangle.moveTo(25,0);triangle.lineTo(0,75);triangle.lineTo(50,75);triangle.endFill();var result=new PIXI.Sprite(triangle.generateTexture(PIXI.renderer));result.interactive=true;return result};CanvasConsole.prototype.getRect=function(color,width,height){var rect=new PIXI.Graphics;rect.beginFill(color,1);rect.drawRect(0,0,width,height);rect.endFill();var result=new PIXI.Sprite(rect.generateTexture(PIXI.renderer));result.interactive=true;return result};CanvasConsole.SCROLLING_Y_STEP=40;CanvasConsole.TEXT_STARTING_X=10;CanvasConsole.TEXT_STARTING_Y=10;CanvasConsole.TEXT_Y_SPACING=40;return CanvasConsole}(PIXI.Container);utils.CanvasConsole=CanvasConsole}(utils=library.utils||(library.utils={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var utils;!function(utils){function decimalToHexColorString(value){return"#"+("00000"+Math.abs(value).toString(16)).substr(-6)}utils.decimalToHexColorString=decimalToHexColorString}(utils=library.utils||(library.utils={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var utils;!function(utils){var ErrorSerializer=function(){function ErrorSerializer(){}ErrorSerializer.Serialize=function(value){if("object"===typeof value)return ErrorSerializer.destroyCircular(value,[]);if("function"===typeof value)return"[Function: "+(value.name||"anonymous")+"]";return value};ErrorSerializer.destroyCircular=function(from,seen){var to;if(Array.isArray(from))to=[];else to={};seen.push(from);Object.keys(from).forEach(function(key){var value=from[key];if("function"===typeof value)return;if(!value||"object"!==typeof value){to[key]=value;return}if(seen.indexOf(from[key])===-1){to[key]=ErrorSerializer.destroyCircular(from[key],seen.slice(0));return}to[key]="[Circular]"});if("string"===typeof from.name)to.name=from.name;if("string"===typeof from.message)to.message=from.message;if("string"===typeof from.stack)to.stack=from.stack;var errorEventProps=["message","filename","lineno","colno","error"];errorEventProps.forEach(function(prop){if("string"===typeof from[prop]||"number"===typeof from[prop]){to[prop]=from[prop];return}if("object"===typeof from[prop])to[prop]=ErrorSerializer.Serialize(from[prop])});return to};return ErrorSerializer}();utils.ErrorSerializer=ErrorSerializer}(utils=library.utils||(library.utils={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var utils;!function(utils){function sortCells(cells,isColFirst){if(isColFirst===void 0)isColFirst=true;var lastCellIndex=cells.length-2;var cellIndex=0,leftCol,leftRow,rightCol,rightRow,isLeftColBigger,isLeftRowBigger,isRowSame,shouldSwap,colIndexOffset,rowIndexOffset;if(isColFirst){colIndexOffset=0;rowIndexOffset=1}else{colIndexOffset=1;rowIndexOffset=0}for(;cellIndex<lastCellIndex;){leftCol=cells[cellIndex+colIndexOffset];leftRow=cells[cellIndex+rowIndexOffset];rightCol=cells[cellIndex+2+colIndexOffset];rightRow=cells[cellIndex+2+rowIndexOffset];isLeftRowBigger=leftRow>rightRow;isLeftColBigger=leftCol>rightCol;isRowSame=leftRow===rightRow;shouldSwap=isLeftRowBigger||isRowSame&&isLeftColBigger;if(shouldSwap){cells.splice(cellIndex,4,rightCol,rightRow,leftCol,leftRow);cellIndex=Math.max(0,cellIndex-2)}else cellIndex+=2}return cells}utils.sortCells=sortCells;function splitIntoRows(cells,isColFirst,fillEmptyRows){if(isColFirst===void 0)isColFirst=true;if(fillEmptyRows===void 0)fillEmptyRows=true;var result=[];var lastCellIndex=cells.length;var cellIndex=0,col,row,colIndexOffset,rowIndexOffset;if(isColFirst){colIndexOffset=0;rowIndexOffset=1}else{colIndexOffset=1;rowIndexOffset=0}for(;cellIndex<lastCellIndex;cellIndex+=2){col=cells[cellIndex+colIndexOffset];row=cells[cellIndex+rowIndexOffset];if(!result[row])result[row]=[];if(isColFirst)result[row].push(col,row);else result[row].push(row,col)}if(!fillEmptyRows)result=result.filter(function(row){return row});return result}utils.splitIntoRows=splitIntoRows}(utils=library.utils||(library.utils={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var utils;!function(utils){var EventDispatcher=com.egt.library.events.EventDispatcher;var Timer=function(_super){__extends(Timer,_super);function Timer(delay,repeatCount){if(repeatCount===void 0)repeatCount=0;var _this=_super.call(this)||this;_this._currentCount=0;_this._delay=delay;_this._repeatCount=repeatCount;return _this}Object.defineProperty(Timer.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:true,configurable:true});Object.defineProperty(Timer.prototype,"running",{get:function(){return null!=this._delayedCall},enumerable:true,configurable:true});Object.defineProperty(Timer.prototype,"repeatCount",{get:function(){return this._repeatCount},set:function(value){this._repeatCount=Math.max(0,value);if(this.isFinished)this.stop()},enumerable:true,configurable:true});Object.defineProperty(Timer.prototype,"delay",{get:function(){return this._delay},set:function(value){this._delay=Math.max(0,value);if(this.running){this.stop();this.start()}},enumerable:true,configurable:true});Timer.prototype.start=function(){if(this.running)return;this._delayedCall=TweenMax.delayedCall(this._delay,this.onDelay,null,this)};Timer.prototype.stop=function(){if(this.running){this._delayedCall.kill();this._delayedCall=null}};Timer.prototype.reset=function(){this.stop();this._currentCount=0};Object.defineProperty(Timer.prototype,"isFinished",{get:function(){return this._currentCount>=this._repeatCount&&0!=this._repeatCount},enumerable:true,configurable:true});Timer.prototype.onDelay=function(){this._currentCount++;this.dispatchEvent(new library.events.Event(Timer.TIMER));if(this.isFinished){this.stop();this.dispatchEvent(new library.events.Event(Timer.TIMER_COMPLETE))}else if(this.running){this.stop();this.start()}};Timer.TIMER_COMPLETE="timerComplete";Timer.TIMER="timer";return Timer}(EventDispatcher);utils.Timer=Timer}(utils=library.utils||(library.utils={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var utils;!function(utils){var UncaughtErrorsHandler=function(){function UncaughtErrorsHandler(callback,startListening){if(startListening===void 0)startListening=true;if(!callback)throw new Error("Missing callback function");this._callback=callback;this._listening=false;if(startListening)this._setupEvents()}UncaughtErrorsHandler.prototype.startListening=function(){if(!this._listening)this._setupEvents()};UncaughtErrorsHandler.prototype.stopListening=function(){if(this._listening)this._setupEvents(false)};UncaughtErrorsHandler.prototype.dispose=function(){if(this._listening)this._setupEvents(false);this._callback=null};UncaughtErrorsHandler.prototype._setupEvents=function(attatch){if(attatch===void 0)attatch=true;this._listening=attatch?true:false;if(attatch){if("undefined"!==typeof window)window.addEventListener("error",this._callback)}else if("undefined"!==typeof window)window.removeEventListener("error",this._callback)};return UncaughtErrorsHandler}();utils.UncaughtErrorsHandler=UncaughtErrorsHandler}(utils=library.utils||(library.utils={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var Utils=function(){function Utils(){}Utils.convertToSequenceString=function(num,sequenceDigitsCount){if(sequenceDigitsCount===void 0)sequenceDigitsCount=2;var sequenceString=num.toString();for(var i=sequenceString.length;i<sequenceDigitsCount;i++)sequenceString="0".concat(sequenceString);return sequenceString};Utils.formatMoney=function(num,denom,formatCurrency,noCoins,separator){if(formatCurrency===void 0)formatCurrency=false;if(noCoins===void 0)noCoins=false;if(separator===void 0)separator=" ";var str=formatCurrency?(num/100).toFixed(noCoins?0:2):Math.floor(num/denom).toString();var arr=str.split(".");var n=arr[0];var prefix=n.split("");if(formatCurrency){var counter=3;var i=prefix.length;while(--i>0){counter--;if(0==counter){counter=3;prefix.splice(i,0,separator)}}}if(arr[1])return prefix.join("")+"."+arr[1];else return prefix.join("")};Utils.randomNumberInRange=function(rangeStart,rangeEnd){return rangeStart+Math.random()*(rangeEnd-rangeStart)};return Utils}();library.Utils=Utils}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var widgets;!function(widgets){var BitmapMoneyText=function(_super){__extends(BitmapMoneyText,_super);function BitmapMoneyText(config){var _this=_super.call(this)||this;_this._config=new MoneyTextConfig;_this._config.serialize(config);if(void 0==_this._config.centsFontSize)_this._config.centsFontSize=_this._config.moneyFontSize;if(void 0==_this._config.currencyFontSize)_this._config.currencyFontSize=_this._config.moneyFontSize;if(void 0==_this._config.suffixFontSize)_this._config.suffixFontSize=_this._config.moneyFontSize;if(void 0==_this._config.centsfontFamily)_this._config.centsfontFamily=_this._config.fontFamily;if(void 0==_this._config.currencyfontFamily)_this._config.currencyfontFamily=_this._config.fontFamily;if(void 0==_this._config.suffixfontFamily)_this._config.suffixfontFamily=_this._config.fontFamily;_this._rect=new PIXI.Graphics;_this._rect.beginFill(16711680,1);_this._rect.drawRect(0,0,_this._config.bounds.width,_this._config.bounds.height);_this._rect.endFill();_this.addChild(_this._rect);_this._rect.visible=true;_this._rect.alpha=0;if(_this._config.debug)_this._rect.alpha=1;_this.createTextFields();if(_this._config.diamond){_this._diamondImage=new PIXI.Sprite(_this._config.diamond);_this.addChild(_this._diamondImage);_this._diamondImage.anchor.set(.5);_this._diamondImage.visible=false}return _this}Object.defineProperty(BitmapMoneyText.prototype,"money",{get:function(){return this._config.money},set:function(value){this._config.money=value;this._moneyText.x=0;this._moneyText.y=0;this._centsText.x=0;this._currencyText.x=0;this._moneyText.text=this._config.moneyString;this._centsText.text=this._config.centsString;this.resetCentsTextWidthHeight();this.resetMoneyTextWidthHeight();this.recalcVerticalOffset();if(this._config.shouldHideWhenMoneyValueIsZero&&0==value){this._moneyText.visible=false;this._centsText.visible=false;this._currencyText.visible=false;if(this._diamondImage)this._diamondImage.visible=false}else{if(this._diamondImage)this._diamondImage.visible=true;this._moneyText.visible=true;this._centsText.visible=this._config.shouldCentsHaveValue;this._currencyText.visible=!this._config.isShowingCredits&&this._config.shouldShowCurrency&&!this._config.diamond}if(isNaN(this._config.currencyPositionOffsetPercentX)){this._currencyText.text=" "+this._config.currency;this.resetCurrencyTextWidthHeight()}else{this._currencyText.text=""+this._config.currency;this.resetCurrencyTextWidthHeight()}this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"align",{set:function(value){this._config.align=value;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"bounds",{get:function(){return{width:this._config.bounds.width,height:this._config.bounds.height}},set:function(value){this._config.bounds={width:value.width,height:value.height};this._rect.width=value.width;this._rect.height=value.height;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"isShowingCredits",{set:function(val){if(this._config.diamondPlay){if(this._config.isShowingCredits){this._config.isShowingCredits=false;this.money=this._config.money}return}this._config.isShowingCredits=val;this.money=this._config.money},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"denomination",{
set:function(val){this._config.denomination=val;this.money=this._config.money},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"prefix",{set:function(value){this._config.prefix=value;this._moneyText.text=this._config.moneyString;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"suffix",{set:function(value){this._config.suffix=value;this._suffix.text=this._config.suffix;this._suffix.visible=true;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});BitmapMoneyText.prototype.recalcVerticalOffset=function(){if(isNaN(this._config.centsPositionOffsetPercentY))this._config.centsOffsetCalc(this._centsText.y,this._moneyText.textHeight);if(isNaN(this._config.currencyPositionOffsetPercentY))this._config.currencyOffsetCalc(this._currencyText.y,this._moneyText.textHeight)};Object.defineProperty(BitmapMoneyText.prototype,"moneyTextPositionY",{set:function(y){this._moneyText.y=y},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"centsTextPositionY",{set:function(y){this._centsText.y=y;if(this._moneyText.textHeight>0)this._config.centsOffsetCalc(this._centsText.y,this._moneyText.textHeight)},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"currencyTextPositionY",{set:function(y){this._currencyText.y=y;if(this._moneyText.textHeight>0)this._config.currencyOffsetCalc(this._currencyText.y,this._moneyText.textHeight)},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"font",{get:function(){return{name:this._config.fontFamily,size:this._config.moneyFontSize}},set:function(fontObj){this._moneyText.x=0;this._moneyText.y=0;this._centsText.x=0;this._centsText.y=0;this._currencyText.x=0;this._currencyText.y=0;this._suffix.x=0;this._suffix.y=0;this._moneyText.font=fontObj;this._centsText.font=fontObj;this._currencyText.font=fontObj;this._suffix.font=fontObj;this._config.fontFamily=fontObj.name;this._config.moneyFontSize=fontObj.size;this._config.centsfontFamily=fontObj.name;this._config.centsFontSize=fontObj.size;this._config.currencyfontFamily=fontObj.name;this._config.currencyFontSize=fontObj.size;this._config.suffixfontFamily=fontObj.name;this._config.suffixFontSize=fontObj.size;this._config.centsPositionOffsetPercentY=NaN;this._config.currencyPositionOffsetPercentY=NaN;this._config.centsPositionOffsetPercentX=NaN;this._config.currencyPositionOffsetPercentX=NaN;this.recalcVerticalOffset();this.resetAllTextWidthHeight();this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"moneyFont",{get:function(){return{name:this._config.fontFamily,size:this._config.moneyFontSize}},set:function(moneyFontObj){this._moneyText.x=0;this._moneyText.font=moneyFontObj;this._config.fontFamily=moneyFontObj.name;this._config.moneyFontSize=moneyFontObj.size;this.recalcVerticalOffset();this.resetMoneyTextWidthHeight();this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"centsFont",{get:function(){return{name:this._config.centsfontFamily,size:this._config.centsFontSize}},set:function(font){this._centsText.x=0;this._centsText.y=0;this._centsText.font=font;this._config.centsfontFamily=font.name;this._config.centsFontSize=font.size;this._config.centsPositionOffsetPercentX=NaN;this._config.centsPositionOffsetPercentX=NaN;this.recalcVerticalOffset();this.resetCentsTextWidthHeight();this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"suffixFont",{get:function(){return{name:this._config.suffixfontFamily,size:this._config.suffixFontSize}},set:function(font){this._suffix.x=0;this._suffix.y=0;this._suffix.font=font;this._config.suffixfontFamily=font.name;this._config.suffixFontSize=font.size;this.resetSuffixWidthHeight();this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"currencyFont",{get:function(){return{name:this._config.currencyfontFamily,size:this._config.currencyFontSize}},set:function(font){this._currencyText.x=0;this._currencyText.y=0;this._currencyText.font=font;this._config.currencyfontFamily=font.name;this._config.currencyFontSize=font.size;this._config.currencyPositionOffsetPercentY=NaN;this._config.currencyPositionOffsetPercentX=NaN;this.recalcVerticalOffset();this.resetCurrencyTextWidthHeight();this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(BitmapMoneyText.prototype,"scaleDiamond",{set:function(value){this._diamondImage.scale.set(value,value);this.fitToBounds();this.positionText()},enumerable:true,configurable:true});BitmapMoneyText.prototype.resizeDiamond=function(){this._diamondImage.scale.set(1);var diamandScaleToSet=this._moneyText.textHeight/this._diamondImage.height*this._config.diamondScaleCoef;this._diamondImage.scale.x=diamandScaleToSet;this._diamondImage.scale.y=diamandScaleToSet};Object.defineProperty(BitmapMoneyText.prototype,"setScaleDiamondCoef",{set:function(value){this._config.diamondScaleCoef=value},enumerable:true,configurable:true});BitmapMoneyText.prototype.createTextFields=function(){var textStyle={font:{name:this._config.fontFamily,size:this._config.moneyFontSize},align:"left",tint:this._config.moneyTint};this._moneyText=new PIXI.extras.BitmapText("",textStyle);textStyle={font:{name:this._config.centsfontFamily,size:this._config.centsFontSize},align:"left",tint:this._config.centsTint};this._centsText=new PIXI.extras.BitmapText("",textStyle);textStyle={font:{name:this._config.currencyfontFamily,size:this._config.currencyFontSize},align:"left",tint:this._config.currencyTint};this._currencyText=new PIXI.extras.BitmapText(this._config.currency,textStyle);textStyle={font:{name:this._config.suffixfontFamily,size:this._config.suffixFontSize},align:"left",tint:this._config.suffixTint};this._suffix=new PIXI.extras.BitmapText(this._config.suffix,textStyle);this.resetAllTextWidthHeight();this.addChild(this._moneyText);this.addChild(this._centsText);this.addChild(this._currencyText);this.addChild(this._suffix);this._moneyText.visible=false;this._centsText.visible=false;this._currencyText.visible=false;this._suffix.visible=false};BitmapMoneyText.prototype.positionText=function(){this._moneyText.x=0;this._moneyText.y=0;this._centsText.x=0;this._centsText.y=0;this._currencyText.x=0;this._currencyText.y=0;this._suffix.x=0;this._suffix.y=0;this._moneyText.y=(this._config.bounds.height-this._moneyText.textHeight)/2;this._suffix.y=this._moneyText.y+this._moneyText.textHeight-this._suffix.textHeight;if(this._config.diamond)this._diamondImage.y=this._moneyText.y+this._moneyText.textHeight/2+this._config.posDiamondY;if("left"==this._config.align){if(this._config.diamond){this._diamondImage.x=this._diamondImage.width/2;this._moneyText.x=this._diamondImage.width+this._config.spaceBetweenMoneyAndDiamond+this.moneyTextLetterSpacing}}else if("right"==this._config.align)if(this._config.diamond){this._moneyText.x=this._config.bounds.width-this._moneyText.textWidth;this._diamondImage.x=this._moneyText.x-this._config.spaceBetweenMoneyAndDiamond-this._diamondImage.width/2+this.moneyTextLetterSpacing}else this._moneyText.x=this._config.bounds.width-this.textWidth;else if(this._config.diamond){this._moneyText.x=(this._config.bounds.width-this.textWidth)/2;if(this._config.centerAlignOnlyMoney){this._moneyText.x+=(this._diamondImage.width+this._config.spaceBetweenMoneyAndDiamond)/2-this.moneyTextLetterSpacing;this._diamondImage.x=this._moneyText.x-this._diamondImage.width/2-this._config.spaceBetweenMoneyAndDiamond}else{this._diamondImage.x=this._moneyText.x+this._diamondImage.width/2;this._moneyText.x+=this._diamondImage.width+this._config.spaceBetweenMoneyAndDiamond+this.moneyTextLetterSpacing}}else{this._moneyText.x=(this._config.bounds.width-this.textWidth)/2;if(this._config.centerAlignOnlyMoney&&!this._config.isShowingCredits)this._moneyText.x+=this._currencyText.width/2}this._suffix.x=this._moneyText.x+this._moneyText.textWidth;if(this._centsText.visible){this.calcHorizontalOffset();this._centsText.x=this._moneyText.x+this._moneyText.textWidth+this._config.spaceBetweenMoneyAndCents;this._centsText.y=this._moneyText.y+this._moneyText.textHeight*this._config.centsPositionOffsetPercentY;this._suffix.x=this._centsText.x+this._centsText.textWidth}if(!this._config.isShowingCredits&&this._config.shouldShowCurrency){var leftText=this._centsText.visible?this._centsText:this._moneyText;this._currencyText.x=leftText.x+leftText.width+(!isNaN(this._config.currencyPositionOffsetPercentX)?this._config.currencyPositionOffsetPercentX*this._moneyText.textHeight:0);this._currencyText.y=this._moneyText.y+this._moneyText.textHeight*this._config.currencyPositionOffsetPercentY;this._suffix.x=this._currencyText.x+this._currencyText.textWidth}this._moneyText.x=Math.round(this._moneyText.x);this._moneyText.y=Math.round(this._moneyText.y);this._centsText.x=Math.round(this._centsText.x);this._centsText.y=Math.round(this._centsText.y);this._currencyText.x=Math.round(this._currencyText.x);this._currencyText.y=Math.round(this._currencyText.y);this._suffix.x=Math.round(this._suffix.x);this._suffix.y=Math.round(this._suffix.y)};Object.defineProperty(BitmapMoneyText.prototype,"textWidth",{get:function(){this._moneyText.width;this._centsText.width;this._currencyText.width;this.resetSuffixWidthHeight();var moneyWidth=this._moneyText.textWidth;if(!this._config.isShowingCredits&&!this._config.diamondPlay)this.calcHorizontalOffset();var centsWidth=this._centsText.visible?this._centsText.textWidth+(isNaN(this._config.spaceBetweenMoneyAndCents)?0:this._config.spaceBetweenMoneyAndCents):0;var currencyWidth=this._config.isShowingCredits||!this._config.shouldShowCurrency?0:this._config.diamond?this._diamondImage.width+this._config.spaceBetweenMoneyAndDiamond+this.moneyTextLetterSpacing:this._currencyText.textWidth+(isNaN(this._config.spaceBetweenCentsAndCurrency)?0:this._config.spaceBetweenCentsAndCurrency);var suffixWidth=this._config.suffix?this._suffix.textWidth:0;return moneyWidth+centsWidth+currencyWidth+suffixWidth},enumerable:true,configurable:true});BitmapMoneyText.prototype.setCentsPositionOffsetPercentX=function(muneyEnd,centsBegin,moneyTextHeight){this._config.centsPositionOffsetPercentX=centsBegin==muneyEnd?0:(centsBegin-muneyEnd)/moneyTextHeight};BitmapMoneyText.prototype.setCurrencyPositionOffsetPercentX=function(centsEnd,currencyBegin,moneyTextHeight){this._config.currencyPositionOffsetPercentX=currencyBegin==centsEnd?0:(currencyBegin-centsEnd)/moneyTextHeight};Object.defineProperty(BitmapMoneyText.prototype,"moneyTextLetterSpacing",{get:function(){this._moneyText.text="111111";this.resetMoneyTextWidthHeight();var letterSpacing=this._moneyText.children[1].x-this._moneyText.children[0].x-this._moneyText.children[0].width;this._moneyText.text=this._config.moneyString;this.resetMoneyTextWidthHeight();if(letterSpacing<0)letterSpacing/=2;else letterSpacing=0;return letterSpacing},enumerable:true,configurable:true});BitmapMoneyText.prototype.calcHorizontalOffset=function(){this._moneyText.text="111111";this.resetMoneyTextWidthHeight();var letterSpacing=this._moneyText.children[1].x-this._moneyText.children[0].x-this._moneyText.children[0].width;this._moneyText.text=this._config.moneyString;this.resetMoneyTextWidthHeight();if(!isNaN(this._config.centsPositionOffsetPercentX))letterSpacing=0;this._config.spaceBetweenMoneyAndCents=letterSpacing+(!isNaN(this._config.centsPositionOffsetPercentX)?this._config.centsPositionOffsetPercentX*this._moneyText.textHeight:0);this._centsText.text="111111";this.resetCentsTextWidthHeight();letterSpacing=this._centsText.children[1].x-this._centsText.children[0].x-this._centsText.children[0].width;this._centsText.text=this._config.centsString;this.resetCentsTextWidthHeight();if(!isNaN(this._config.currencyPositionOffsetPercentX))letterSpacing=0;this._config.spaceBetweenCentsAndCurrency=letterSpacing+(!isNaN(this._config.currencyPositionOffsetPercentX)?this._config.currencyPositionOffsetPercentX*this._moneyText.textHeight:0)};BitmapMoneyText.prototype.resetAllTextWidthHeight=function(){this.resetMoneyTextWidthHeight();this.resetCentsTextWidthHeight();this.resetCurrencyTextWidthHeight();this.resetSuffixWidthHeight()};BitmapMoneyText.prototype.resetCurrencyTextWidthHeight=function(){this._currencyText.height;this._currencyText.width};BitmapMoneyText.prototype.resetCentsTextWidthHeight=function(){this._centsText.height;this._centsText.width};BitmapMoneyText.prototype.resetMoneyTextWidthHeight=function(){this._moneyText.height;this._moneyText.width};BitmapMoneyText.prototype.resetSuffixWidthHeight=function(){this._suffix.height;this._suffix.width};BitmapMoneyText.prototype.dispose=function(){this._moneyText.destroy();this._centsText.destroy();this._currencyText.destroy()};BitmapMoneyText.prototype.resetFonts=function(){this._moneyText.font={tint:this._moneyText.font.tint,align:"left",name:this._config.fontFamily,size:this._config.moneyFontSize};this._centsText.font={tint:this._centsText.font.tint,align:"left",name:this._config.centsfontFamily,size:this._config.centsFontSize};this._currencyText.font={tint:this._currencyText.font.tint,align:"left",name:this._config.currencyfontFamily,size:this._config.currencyFontSize};this._suffix.font={tint:this._suffix.font.tint,align:"left",name:this._config.suffixfontFamily,size:this._config.suffixFontSize};this.resetAllTextWidthHeight()};BitmapMoneyText.prototype.fitToBounds=function(){this.resetFonts();if(this._config.diamond)this.resizeDiamond();if(!this._config.shouldFitToBounds)return;var currencyCompensation=0;if(this._config.centerAlignOnlyMoney&&"center"==this._config.align)currencyCompensation=this._config.diamond?this._diamondImage.width+this._config.spaceBetweenMoneyAndDiamond:this._currencyText.width;var moneyFontSize=this._moneyText.font.size;var centsFontSize=this._centsText.font.size;var currencyFontSize=this._currencyText.font.size;var suffixFontSize=this._suffix.font.size;while(this.textWidth>this._config.bounds.width-currencyCompensation&&moneyFontSize>this._config.minFontSize){var coefCurrency=this._config.diamond?this._config.diamondScaleCoef:currencyFontSize/moneyFontSize;var coefCents=centsFontSize/moneyFontSize;var coefSuffix=suffixFontSize/moneyFontSize;moneyFontSize--;this._moneyText.font={tint:this._moneyText.font.tint,align:"left",name:this._config.fontFamily,size:moneyFontSize};centsFontSize=moneyFontSize*coefCents;this._centsText.font={tint:this._centsText.font.tint,align:"left",name:this._config.centsfontFamily,size:centsFontSize};currencyFontSize=moneyFontSize*coefCurrency;if(null!=this._config.diamond&&!this._config.keepDiamondSize)this.resizeDiamond();else if(!this._config.keepCurrencySize)this._currencyText.font={tint:this._currencyText.font.tint,align:"left",name:this._config.currencyfontFamily,size:currencyFontSize};suffixFontSize=moneyFontSize*coefSuffix;this._suffix.font={tint:this._suffix.font.tint,align:"left",name:this._config.suffixfontFamily,size:suffixFontSize}}};return BitmapMoneyText}(PIXI.Container);widgets.BitmapMoneyText=BitmapMoneyText;var MoneyTextConfig=function(_super){__extends(MoneyTextConfig,_super);function MoneyTextConfig(){var _this=null!==_super&&_super.apply(this,arguments)||this;_this.money=0;_this.prefix="";_this.suffix="";_this.denomination=1;_this.currency="";_this.centsVisibilityMoneyLimit=-1;_this.isShowingCredits=false;_this.fontFamily="MyCustomFont";_this.centsfontFamily=void 0;_this.currencyfontFamily=void 0;_this.suffixfontFamily=void 0;_this.align="center";_this.moneyTint=16777215;_this.centsTint=16777215;_this.currencyTint=16777215;_this.suffixTint=16777215;_this.moneyFontSize=1;_this.centsFontSize=void 0;_this.currencyFontSize=void 0;_this.suffixFontSize=void 0;_this.spaceBetweenMoneyAndCents=NaN;_this.spaceBetweenCentsAndCurrency=NaN;_this.spaceBetweenMoneyAndDiamond=5;_this.shouldShowCurrency=true;_this.centerAlignOnlyMoney=false;_this.shouldHideWhenMoneyValueIsZero=false;_this.minFontSize=6;_this.bounds={width:100,height:50};_this.shouldFitToBounds=true;_this.debug=false;_this.diamond=null;_this.diamondScaleCoef=1;_this.posDiamondY=0;_this.diamondPlay=false;_this.keepCurrencySize=false;_this.keepDiamondSize=false;_this.centsPositionOffsetPercentY=NaN;_this.currencyPositionOffsetPercentY=NaN;_this.centsPositionOffsetPercentX=NaN;_this.currencyPositionOffsetPercentX=NaN;_this.hideCents=false;return _this}MoneyTextConfig.prototype.centsOffsetCalc=function(centsPosition,moneyTextHeight){if(0==centsPosition)this.centsPositionOffsetPercentY=0;else this.centsPositionOffsetPercentY=centsPosition/moneyTextHeight};MoneyTextConfig.prototype.currencyOffsetCalc=function(currencyPosition,moneyTextHeight){if(0==currencyPosition)this.currencyPositionOffsetPercentY=0;else this.currencyPositionOffsetPercentY=currencyPosition/moneyTextHeight};Object.defineProperty(MoneyTextConfig.prototype,"moneyString",{get:function(){var str="";if(this.isShowingCredits)str=Math.floor(this.money/this.denomination).toString();else if(this.diamondPlay)str=Math.floor(this.money/100).toString();else{str=(this.money/100).toFixed(2);var moneyParts=str.split(".");var moneyDigits=moneyParts[0].split("");var counter=3;var digitIndex=moneyDigits.length;while(--digitIndex>0){counter--;if(0==counter){counter=3;moneyDigits.splice(digitIndex,0," ")}}str=moneyDigits.join("")+(this.shouldCentsHaveValue?".":"")}if(this.prefix)str=this.prefix+str;return str},enumerable:true,configurable:true});Object.defineProperty(MoneyTextConfig.prototype,"centsString",{get:function(){var str="";if(this.shouldCentsHaveValue)str=(this.money/100).toFixed(2).split(".")[1];return str},enumerable:true,configurable:true});Object.defineProperty(MoneyTextConfig.prototype,"shouldCentsHaveValue",{get:function(){return!this.isShowingCredits&&!this.diamondPlay&&!this.hideCents&&(this.money<=this.centsVisibilityMoneyLimit||this.centsVisibilityMoneyLimit<0)},enumerable:true,configurable:true});return MoneyTextConfig}(Pluck.External)}(widgets=library.widgets||(library.widgets={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var widgets;!function(widgets){var BitmapText=function(_super){__extends(BitmapText,_super);function BitmapText(config,text,font){var _this=_super.call(this)||this;_this._config=new BitmapTextConfig;_this._config.serialize(config);_this._text=new PIXI.extras.BitmapText(text,font);_this._originalFontSize=_this._text.font.size;_this.drawDebugRect();_this.addChild(_this._text);_this.fitToBounds();_this.positionText();return _this}Object.defineProperty(BitmapText.prototype,"text",{get:function(){return this._text.text},set:function(value){if(value!=this._text.text){this._text.text=value;this.fitToBounds();this.positionText()}},enumerable:true,configurable:true});Object.defineProperty(BitmapText.prototype,"config",{set:function(conf){this._config.serialize(conf);this.drawDebugRect();this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(BitmapText.prototype,"font",{get:function(){return this._text.font},set:function(value){if(void 0==value.size)value.size=this._originalFontSize;this._text.font=value;this._originalFontSize=this._text.font.size;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(BitmapText.prototype,"align",{set:function(value){this._config.align=value;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});BitmapText.prototype.dispose=function(){this._text.destroy();if(this._rect)this._rect.destroy();this.destroy()};BitmapText.prototype.fitToBounds=function(){if(!this._config.shouldScale)return;this._text.font.size=this._originalFontSize;var fontSize=this._text.font.size;while(this._text.textWidth>this._config.bounds.width&&fontSize>this._config.minFontSize){fontSize--;this._text.font.size=fontSize;this._text.font=this._text.font;this._text.updateTransform()}};Object.defineProperty(BitmapText.prototype,"textWidth",{get:function(){var textWidth=this._text.textWidth;return textWidth},enumerable:true,configurable:true});BitmapText.prototype.resetFont=function(){this._text.font={tint:this._text.font.tint,align:"left",name:this._config.style.font.name,size:this._config.style.font.size};this.resetTextWidthHeight()};BitmapText.prototype.resetTextWidthHeight=function(){this._text.width;this._text.height};BitmapText.prototype.positionText=function(){if("left"==this._config.align)this._text.x=0;else if("center"==this._config.align)this._text.x=Math.round((this._config.bounds.width-this._text.width)/2);else if("right"==this._config.align)this._text.x=Math.round(this._config.bounds.width-this._text.width);if("middle"===this._config.verticalAlign)this._text.y=Math.round((this._config.bounds.height-this._text.height)/2);else if("top"===this._config.verticalAlign)this._text.y=0;else if("bottom"===this._config.verticalAlign)this._text.y=Math.round(this._config.bounds.height-this._text.height)};BitmapText.prototype.drawDebugRect=function(){if(this._rect)this._rect.destroy();if(this._config.debug){this._rect=new PIXI.Graphics;this._rect.beginFill(16711680);this._rect.drawRect(0,0,this._config.bounds.width,this._config.bounds.height);this._rect.endFill();this.addChild(this._rect)}};return BitmapText}(PIXI.Container);widgets.BitmapText=BitmapText;var BitmapTextConfig=function(_super){__extends(BitmapTextConfig,_super);function BitmapTextConfig(){var _this=null!==_super&&_super.apply(this,arguments)||this;_this.style={font:{tint:null,align:"left",name:"",size:0}};_this.bounds={width:100,height:50};_this.align="left";_this.verticalAlign="middle";_this.shouldScale=false;_this.minFontSize=4;_this.debug=false;return _this}return BitmapTextConfig}(Pluck.External);widgets.BitmapTextConfig=BitmapTextConfig}(widgets=library.widgets||(library.widgets={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var widgets;!function(widgets){var Device=com.egt.library.Device;var Button=function(_super){__extends(Button,_super);function Button(textures){var _this=_super.call(this)||this;_this._isDown=false;_this._isOver=false;_this.shouldScale=false;_this.textures=textures;_this.on(Device.resolveEvent("mousedown"),_this.onMouseDown,_this);_this.on(Device.resolveEvent("mouseup"),_this.onMouseUp,_this);_this.on(Device.resolveEvent("mouseupoutside"),_this.onMouseUp,_this);_this.on(Device.resolveEvent("mouseover"),_this.onMouseOver,_this);_this.on(Device.resolveEvent("mouseout"),_this.onMouseOut,_this);_this._background=new PIXI.Sprite(new PIXI.Texture(new PIXI.BaseTexture(null)));_this.addChild(_this._background);_this.interactive=true;_this.buttonMode=true;_this.setImageForState(Button.STATE_UP);return _this}Button.prototype.refreshState=function(){this.setImageForState(this._state)};Button.prototype.dispose=function(){this.off(Device.resolveEvent("mousedown"),this.onMouseDown,this);this.off(Device.resolveEvent("mouseup"),this.onMouseUp,this);this.off(Device.resolveEvent("mouseupoutside"),this.onMouseUp,this);this.off(Device.resolveEvent("mouseover"),this.onMouseOver,this);this.off(Device.resolveEvent("mouseout"),this.onMouseOut,this);if(this._scaleTween)this._scaleTween.kill()};Object.defineProperty(Button.prototype,"textures",{set:function(value){if(null==value[Button.STATE_UP])throw"At least a 'state up' should be supplied";this._textures=value},enumerable:true,configurable:true});Button.prototype.setImageForState=function(state){if(void 0===this._textures[state])state=Button.STATE_UP;if(!this.interactive&&void 0!==this._textures[Button.STATE_DISABLED])state=Button.STATE_DISABLED;else if(this.interactive&&this._state==Button.STATE_DISABLED)state=Button.STATE_UP;else if(!this.interactive&&void 0===this._textures[Button.STATE_DISABLED])state=Button.STATE_UP;this._state=state;this._background.texture=this._textures[state]};Button.prototype.onMouseDown=function(){this._isDown=true;this.setImageForState(Button.STATE_DOWN)};Button.prototype.onMouseUp=function(){this._isDown=false;if(this._isOver)this.setImageForState(Button.STATE_OVER);else this.setImageForState(Button.STATE_UP)};Button.prototype.onMouseOver=function(){this._isOver=true;if(!this._isDown)this.setImageForState(Button.STATE_OVER);if(this.shouldScale)this._scaleTween=TweenMax.to(this.scale,.3,{x:1.1,y:1.1})};Button.prototype.onMouseOut=function(){this._isOver=false;if(!this._isDown)this.setImageForState(Button.STATE_UP);if(this.shouldScale&&1!=this.scale.x)this._scaleTween=TweenMax.to(this.scale,.3,{x:1,y:1})};Button.STATE_UP="up";Button.STATE_DOWN="down";Button.STATE_OVER="over";Button.STATE_DISABLED="disabled";return Button}(PIXI.Container);widgets.Button=Button}(widgets=library.widgets||(library.widgets={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var widgets;!function(widgets){function DefaultBoxGenerator(styles){styles=styles||{fill:13421772};if(styles["default"]){styles.focused=styles.focused||styles["default"];styles.disabled=styles.disabled||styles["default"]}else{var temp_styles=styles;styles={};styles["default"]=styles.focused=styles.disabled=temp_styles}return function(w,h,state){var style=styles[state.toLowerCase()];var box=new PIXI.Graphics;if(style.fill)box.beginFill(style.fill);if(style.stroke)box.lineStyle(style.stroke.width||1,style.stroke.color||0,style.stroke.alpha||1);if(style.rounded)box.drawRoundedRect(0,0,w,h,style.rounded);else box.drawRect(0,0,w,h);box.endFill();return box}}widgets.DefaultBoxGenerator=DefaultBoxGenerator}(widgets=library.widgets||(library.widgets={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var widgets;!function(widgets){var log=com.egt.library.utils.log;var MoneyText=function(_super){__extends(MoneyText,_super);function MoneyText(config){var _this=_super.call(this)||this;_this._lastCalculatedWidths=null;_this._config=new MoneyTextConfig;_this._config.serialize(config);if(_this._config.debug)_this.createDebugFields();_this.createTextFields();if(_this._config.diamond){_this._diamondImage=new PIXI.Sprite(_this._config.diamond);_this.addChild(_this._diamondImage);_this._diamondImage.pivot.set(_this._diamondImage.texture.width/2,_this._diamondImage.texture.height/2);_this._diamondImage.visible=false}return _this}Object.defineProperty(MoneyText.prototype,"moneyString",{get:function(){return this._config.moneyString},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"centsString",{get:function(){return this._config.centsString},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"money",{get:function(){return this._config.money},set:function(value){var moneyLength=this._moneyText.text.length;var centsLength=this._centsText.text.length;var moneyVisible=this._moneyText.visible;var centsVisible=this._centsText.visible;var currencyVisible=this._currencyText.visible;this._config.money=value;this._moneyText.text=this._config.moneyString;this._centsText.text=this._config.centsString;if(this._config.shouldHideWhenMoneyValueIsZero&&0==value){this._moneyText.visible=false;this._decimalSymbolText.visible=false;this._centsText.visible=false;this._currencyText.visible=false;if(this._diamondImage)this._diamondImage.visible=false}else{if(this._diamondImage)this._diamondImage.visible=true;this._moneyText.visible=true;this._centsText.visible=this._config.shouldCentsHaveValue;this._decimalSymbolText.visible=this._centsText.visible;this._currencyText.visible=!this._config.isShowingCredits&&this._config.shouldShowCurrency&&!this._config.diamond}if(0!=this._config.suffix.length)this._suffix.visible=true;if(!this._lastCalculatedWidths||moneyLength!==this._moneyText.text.length||centsLength!==this._centsText.text.length||moneyVisible!==this._moneyText.visible||centsVisible!==this._centsText.visible||currencyVisible!==this._currencyText.visible){this.fitToBounds();this.positionText()}if(this._config.debug){this._boundsDebug.width=this._config.bounds.width;this._boundsDebug.height=this._config.bounds.height;this._integerDebug.x=this._moneyText.x;this._integerDebug.y=this._moneyText.y;this._integerDebug.width=this._lastCalculatedWidths.integer;this._integerDebug.height=this._moneyText.height;this._decimalSymbolDebug.x=this._decimalSymbolText.x;this._decimalSymbolDebug.y=this._decimalSymbolText.y;this._decimalSymbolDebug.width=this._lastCalculatedWidths.decimalSymbol;this._decimalSymbolDebug.height=this._decimalSymbolText.height;this._decimalDebug.x=this._centsText.x;this._decimalDebug.y=this._centsText.y;this._decimalDebug.width=this._lastCalculatedWidths.decimal;this._decimalDebug.height=this._centsText.height;this._currencyDebug.x=this._currencyText.x;this._currencyDebug.y=this._currencyText.y;this._currencyDebug.width=this._lastCalculatedWidths.currency;this._currencyDebug.height=this._currencyText.height;this._suffixDebug.x=this._suffix.x;this._suffixDebug.y=this._suffix.y;this._suffixDebug.width=this._lastCalculatedWidths.suffix;this._suffixDebug.height=this._suffix.height}},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"bounds",{get:function(){return{width:this._config.bounds.width,height:this._config.bounds.height}},set:function(value){this._config.bounds.height=value.height;this._config.bounds.width=value.width;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"isShowingCredits",{set:function(val){this._config.isShowingCredits=val;this.money=this.money},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"denomination",{set:function(val){this._config.denomination=val;this.money=this.money},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"prefix",{set:function(value){this._config.prefix=value;this._moneyText.text=this._config.moneyString;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"suffix",{set:function(value){this._config.suffix=value;this._suffix.text=this._config.suffix;this._suffix.visible=true;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"style",{set:function(style){var moneyStyle=this._moneyText.style;var centsStyle=this._centsText.style;var currencyStyle=this._currencyText.style;var suffixStyle=this._suffix.style;for(var key in style)if("fontSize"!=key&&"font"!=key){moneyStyle[key]=style[key];centsStyle[key]=style[key];currencyStyle[key]=style[key];suffixStyle[key]=style[key]}this._moneyText.style=moneyStyle;this._centsText.style=centsStyle;this._currencyText.style=currencyStyle;this._suffix.style=suffixStyle;this._decimalSymbolText.style=moneyStyle;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"moneyStyle",{set:function(style){var moneyStyle=this._moneyText.style;for(var key in style)if("fontSize"!=key&&"font"!=key)moneyStyle[key]=style[key];this._moneyText.style=moneyStyle;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"centsStyle",{set:function(style){var centsStyle=this._centsText.style;for(var key in style)if("fontSize"!=key&&"font"!=key)centsStyle[key]=style[key];this._centsText.style=centsStyle;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"currencyStyle",{
set:function(style){var currencyStyle=this._currencyText.style;for(var key in style)if("fontSize"!=key&&"font"!=key)currencyStyle[key]=style[key];this._currencyText.style=currencyStyle;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"suffixStyle",{set:function(style){var suffixStyle=this._suffix.style;for(var key in style)if("fontSize"!=key&&"font"!=key)suffixStyle[key]=style[key];this._suffix.style=suffixStyle;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"moneyFontSize",{get:function(){return this._moneyText.style.fontSize},set:function(value){this._config.moneyFontSize=value;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"centsFontSize",{get:function(){return this._centsText.style.fontSize},set:function(value){this._config.centsFontSize=value;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"currencyFontSize",{get:function(){return this._currencyText.style.fontSize},set:function(value){this._config.currencyFontSize=value;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"scaleDiamond",{set:function(value){this._config.diamondScaleCoef=value;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});MoneyText.prototype.destroy=function(destroyChildren){if(null!=this._diamondImage&&null!=this._diamondImage.parent)this.removeChild(this._diamondImage);_super.prototype.destroy.call(this,destroyChildren)};MoneyText.prototype.resizeDiamond=function(){this._diamondImage.scale.set(1);var diamondScaleToSet=this._moneyText.height/this._diamondImage.height*this._config.diamondScaleCoef;this._diamondImage.width=Math.round(this._diamondImage.width*diamondScaleToSet);this._diamondImage.height=Math.round(this._diamondImage.height*diamondScaleToSet)};MoneyText.prototype.calculateFontProperty=function(){this._moneyText.width;this._centsText.width;this._currencyText.width;this._decimalSymbolText.width;this._suffix.width};MoneyText.prototype.createTextFields=function(){var textStyle={fontFamily:this._config.fontFamily,fontSize:this._config.moneyFontSize};this._moneyText=new PIXI.Text("",textStyle);this._decimalSymbolText=new PIXI.Text(this._config.decimalSymbol,textStyle);textStyle={fontFamily:this._config.fontFamily,fontSize:this._config.centsFontSize};this._centsText=new PIXI.Text("",textStyle);textStyle={fontFamily:this._config.fontFamily,fontSize:this._config.currencyFontSize};this._currencyText=new PIXI.Text(" "+this._config.currency,textStyle);textStyle={fontFamily:this._config.fontFamily,fontSize:this._config.suffixFontSize};this._suffix=new PIXI.Text(this._config.suffix,textStyle);this.calculateFontProperty();this.addChild(this._moneyText);this.addChild(this._decimalSymbolText);this.addChild(this._centsText);this.addChild(this._currencyText);this.addChild(this._suffix);this._moneyText.visible=false;this._decimalSymbolText.visible=false;this._centsText.visible=false;this._currencyText.visible=false;this._suffix.visible=false};MoneyText.prototype.createDebugFields=function(){this._integerDebug=new PIXI.Graphics;this._decimalDebug=new PIXI.Graphics;this._decimalSymbolDebug=new PIXI.Graphics;this._boundsDebug=new PIXI.Graphics;this._currencyDebug=new PIXI.Graphics;this._suffixDebug=new PIXI.Graphics;this._boundsDebug.beginFill(5765376,.5);this._boundsDebug.drawRect(0,0,1,1);this._integerDebug.beginFill(13107243,.5);this._integerDebug.drawRect(0,0,1,1);this._decimalSymbolDebug.beginFill(231154,.5);this._decimalSymbolDebug.drawRect(0,0,1,1);this._decimalDebug.beginFill(14187776,.5);this._decimalDebug.drawRect(0,0,1,1);this._currencyDebug.beginFill(10423536,.5);this._currencyDebug.drawRect(0,0,1,1);this._suffixDebug.beginFill(16776960,.5);this._suffixDebug.drawRect(0,0,1,1);this.addChild(this._boundsDebug,this._integerDebug,this._decimalSymbolDebug,this._decimalDebug,this._currencyDebug,this._suffixDebug)};MoneyText.prototype.positionText=function(){var moneyFontProps=PIXI.Text.fontPropertiesCache[this._moneyText.style.font];var decimalSymbolFontProps=PIXI.Text.fontPropertiesCache[this._decimalSymbolText.style.font];var centsFontProps=PIXI.Text.fontPropertiesCache[this._centsText.style.font];var currencyFontProps=PIXI.Text.fontPropertiesCache[this._currencyText.style.font];var suffixFontProps=PIXI.Text.fontPropertiesCache[this._suffix.style.font];var w=this._lastCalculatedWidths;if(0==this._config.bounds.height)this._moneyText.y=0;else this._moneyText.y=(this._config.bounds.height-this._moneyText.height)/2;this._suffix.y=this._moneyText.y+moneyFontProps.ascent-suffixFontProps.ascent;if(this._config.diamond)this._diamondImage.y=Math.round(this._moneyText.y+this._moneyText.height/2);if("left"==this._config.align){this._moneyText.x=0;if(this._config.diamond){this._diamondImage.x=Math.round(this._diamondImage.width/2);this._moneyText.x+=this._diamondImage.width+this._config.spaceBetweenMoneyAndDiamond}}else if("right"==this._config.align)if(this._config.diamond){this._moneyText.x=this._config.bounds.width-w.integer;this._diamondImage.x=Math.round(this._moneyText.x-this._config.spaceBetweenMoneyAndDiamond-this._diamondImage.width/2)}else this._moneyText.x=this._config.bounds.width-(w.integer+w.decimal+w.decimalSymbol+w.currency+w.suffix);else if(this._config.diamond){this._moneyText.x=(this._config.bounds.width-w.integer)/2;if(!this._config.centerAlignOnlyMoney)this._moneyText.x+=(this._diamondImage.width+this._config.spaceBetweenMoneyAndDiamond)/2;this._diamondImage.x=Math.round(this._moneyText.x-this._diamondImage.width/2-this._config.spaceBetweenMoneyAndDiamond)}else{this._moneyText.x=(this._config.bounds.width-this.textWidth)/2;if(this._config.centerAlignOnlyMoney&&!this._config.isShowingCredits)this._moneyText.x+=w.currency/2}this._suffix.x=this._moneyText.x+w.integer;if(this._centsText.visible){this._decimalSymbolText.x=this._moneyText.x+w.integer;this._decimalSymbolText.y=this._moneyText.y;this._centsText.x=this._decimalSymbolText.x+w.decimalSymbol+this._config.spaceBetweenMoneyAndCents;this._centsText.y=this._moneyText.y+moneyFontProps.ascent-centsFontProps.ascent;this._suffix.x=this._centsText.x+w.decimalText;this._suffix.y=this._centsText.y+centsFontProps.ascent-suffixFontProps.ascent}if(this.isCurrencyVisible){if(this._centsText.visible)this._currencyText.x=this._centsText.x+w.decimal;else this._currencyText.x=this._moneyText.x+w.integer;this._currencyText.y=this._moneyText.style.strokeThickness/2-this._currencyText.style.strokeThickness/2+this._moneyText.y+moneyFontProps.ascent-currencyFontProps.ascent;this._suffix.x=this._currencyText.x+w.currency;this._suffix.y=this._currencyText.y+currencyFontProps.ascent-suffixFontProps.ascent}};Object.defineProperty(MoneyText.prototype,"Y",{get:function(){return this._moneyText.y},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"textWidth",{get:function(){var widths=this.calculateWidths();return widths.integer+widths.decimal+widths.decimalSymbol+widths.currency+widths.suffix},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"isCurrencyVisible",{get:function(){return!!(this._config.shouldShowCurrency&&!this._config.isShowingCredits&&this._currencyText.text.length)},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"isSuffixVisible",{get:function(){return!!this._config.suffix.length},enumerable:true,configurable:true});Object.defineProperty(MoneyText.prototype,"isDiamondVisible",{get:function(){return!!this._config.diamond},enumerable:true,configurable:true});MoneyText.prototype.calculateWidths=function(){this.calculateFontProperty();var config=this._config;var integer=this._moneyText;var decimal=this._centsText;var decimalSymbol=this._decimalSymbolText;var suffix=this._suffix;var isDecimalVisible=decimal.visible;var isSuffixVisible=this.isSuffixVisible;var isCurrencyVisible=this.isCurrencyVisible;var isDiamondVisible=this.isDiamondVisible;var integerTextWidth=integer.context.measureText(integer.text).width;var decimalTextWidth=0;var decimalSymbolTextWidth=0;var suffixTextWidth=0;var integerWidth=integerTextWidth+integer.style.strokeThickness;var decimalWidth=0;var decimalSymbolWidth=0;var suffixWidth=0;var currencyWidth=0;if(isDecimalVisible){decimalTextWidth=decimal.context.measureText(decimal.text).width;decimalSymbolTextWidth=decimalSymbol.context.measureText(decimalSymbol.text).width;decimalWidth=decimalTextWidth+decimal.style.strokeThickness;decimalSymbolWidth=decimalSymbolTextWidth+decimalSymbol.style.strokeThickness}if(isSuffixVisible){suffixTextWidth=suffix.context.measureText(suffix.text).width;suffixWidth=suffixTextWidth+suffix.style.strokeThickness}if(isDiamondVisible)currencyWidth=this._diamondImage.width;else if(isCurrencyVisible)currencyWidth=this._currencyText.context.measureText(this._currencyText.text).width;this._lastCalculatedWidths={integer:integerWidth,integerText:integerTextWidth,decimal:decimalWidth,decimalText:decimalTextWidth,decimalSymbol:decimalSymbolWidth,decimalSymbolText:decimalSymbolTextWidth,currency:currencyWidth,suffix:suffixWidth,suffixText:suffixTextWidth};return this._lastCalculatedWidths};MoneyText.prototype.dispose=function(){this._moneyText.destroy();this._decimalSymbolText.destroy();this._centsText.destroy();this._currencyText.destroy()};MoneyText.prototype.resetFontSizes=function(){this._moneyText.style.fontSize=this._config.moneyFontSize;this._moneyText.style=this._moneyText.style;this._decimalSymbolText.style.fontSize=this._config.moneyFontSize;this._decimalSymbolText.style=this._decimalSymbolText.style;this._centsText.style.fontSize=this._config.centsFontSize;this._centsText.style=this._centsText.style;this._currencyText.style.fontSize=this._config.currencyFontSize;this._currencyText.style=this._currencyText.style;this._suffix.style.fontSize=this._config.suffixFontSize;this._suffix.style=this._suffix.style;this.calculateFontProperty()};MoneyText.prototype.fitToBounds=function(){this.resetFontSizes();if(this._config.diamond)this.resizeDiamond();if(!this._config.shouldFitToBounds){this.calculateWidths();return}var currencyCompensation=0;if(this._config.centerAlignOnlyMoney&&"center"==this._config.align)currencyCompensation=this._config.diamond?this._diamondImage.width+this._config.spaceBetweenMoneyAndDiamond:this._currencyText.context.measureText(this._currencyText.text).width;var moneyFontSize=this._moneyText.style.fontSize;var centsFontSize=this._centsText.style.fontSize;var currencyFontSize=this._currencyText.style.fontSize;var suffixFontSize=this._suffix.style.fontSize;var integerStrokeSize=this._moneyText.style.strokeThickness;var decimalStrokeSize=this._centsText.style.strokeThickness;var integerStrokeRation=integerStrokeSize?moneyFontSize/integerStrokeSize:0;var decimalStrokeRation=decimalStrokeSize?centsFontSize/decimalStrokeSize:0;while(this.textWidth>this._config.bounds.width-currencyCompensation&&moneyFontSize>this._config.minFontSize){var coefCurrency=this._config.diamond?this._config.diamondScaleCoef:currencyFontSize/moneyFontSize;var coefCents=centsFontSize/moneyFontSize;var coefSuffix=suffixFontSize/moneyFontSize;moneyFontSize--;centsFontSize=moneyFontSize*coefCents;currencyFontSize=moneyFontSize*coefCurrency;suffixFontSize=moneyFontSize*coefSuffix;this._moneyText.style.fontSize=moneyFontSize;this._decimalSymbolText.style.fontSize=moneyFontSize;this._centsText.style.fontSize=centsFontSize;if(integerStrokeRation){this._moneyText.style.strokeThickness=moneyFontSize/integerStrokeRation;this._decimalSymbolText.style.strokeThickness=moneyFontSize/integerStrokeRation}if(decimalStrokeRation)this._centsText.style.strokeThickness=centsFontSize/decimalStrokeRation;this._moneyText.style=this._moneyText.style;this._decimalSymbolText.style=this._decimalSymbolText.style;this._centsText.style=this._centsText.style;this.calculateFontProperty();if(this._config.diamond&&!this._config.keepDiamondSize)this.resizeDiamond();else if(!this._config.keepCurrencySize){this._currencyText.style.fontSize=currencyFontSize;this._currencyText.style=this._currencyText.style}if(!this._config.keepSuffixSize){this._suffix.style.fontSize=suffixFontSize;this._suffix.style=this._suffix.style}}};MoneyText=__decorate([log.decorator],MoneyText);return MoneyText}(PIXI.Container);widgets.MoneyText=MoneyText;var MoneyTextConfig=function(_super){__extends(MoneyTextConfig,_super);function MoneyTextConfig(){var _this=null!==_super&&_super.apply(this,arguments)||this;_this.money=0;_this.prefix="";_this.suffix="";_this.decimalSymbol=".";_this.denomination=1;_this.currency="";_this.centsVisibilityMoneyLimit=-1;_this.isShowingCredits=false;_this.fontFamily="Arial";_this.align="left";_this.moneyFontSize=24;_this.centsFontSize=void 0;_this.currencyFontSize=void 0;_this.suffixFontSize=void 0;_this.spaceBetweenMoneyAndCents=0;_this.spaceBetweenMoneyAndDiamond=5;_this.shouldShowCurrency=true;_this.centerAlignOnlyMoney=false;_this.shouldHideWhenMoneyValueIsZero=false;_this.minFontSize=6;_this.bounds={width:0,height:0};_this.shouldFitToBounds=true;_this.debug=false;_this.diamond=null;_this.diamondScaleCoef=1;_this.posDiamondY=0;_this.diamondPlay=false;_this.keepCurrencySize=false;_this.keepDiamondSize=false;_this.shouldHaveSpaceBetweenThousands=true;_this.hideCents=false;_this.keepSuffixSize=false;return _this}MoneyTextConfig.prototype.serialize=function(obj){_super.prototype.serialize.call(this,obj);if(void 0==this.centsFontSize)this.centsFontSize=this.moneyFontSize;if(void 0==this.currencyFontSize)this.currencyFontSize=this.moneyFontSize;if(void 0==this.suffixFontSize)this.suffixFontSize=this.moneyFontSize};Object.defineProperty(MoneyTextConfig.prototype,"moneyString",{get:function(){var str="";if(this.isShowingCredits)str=Math.floor(this.money/this.denomination).toString();else if(this.diamondPlay)str=Math.floor(this.money/100).toString();else{str=(this.money/100).toFixed(2);var moneyParts=str.split(".");var moneyDigits=moneyParts[0].split("");if(this.shouldHaveSpaceBetweenThousands){var counter=3;var digitIndex=moneyDigits.length;while(--digitIndex>0){counter--;if(0==counter){counter=3;moneyDigits.splice(digitIndex,0," ")}}}str=moneyDigits.join("")}if(this.prefix)str=this.prefix+str;return str},enumerable:true,configurable:true});Object.defineProperty(MoneyTextConfig.prototype,"centsString",{get:function(){var str="";if(this.shouldCentsHaveValue)str=(this.money/100).toFixed(2).split(".")[1];return str},enumerable:true,configurable:true});Object.defineProperty(MoneyTextConfig.prototype,"shouldCentsHaveValue",{get:function(){return!this.isShowingCredits&&!this.diamondPlay&&!this.hideCents&&(this.money<=this.centsVisibilityMoneyLimit||this.centsVisibilityMoneyLimit<0)},enumerable:true,configurable:true});return MoneyTextConfig}(Pluck.External)}(widgets=library.widgets||(library.widgets={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var widgets;!function(widgets){var RollingBitmapNumberView=function(_super){__extends(RollingBitmapNumberView,_super);function RollingBitmapNumberView(config){var _this=_super.call(this)||this;_this._config=config;_this._finalCentValue=_this._finalValue=0;_this._currValue=0;_this._finalValue=0;_this._delta=0;_this._direction=0;_this._oldDirection=0;_this._timePerCent=0;_this._dummyObject={value:0};if(!_this._config.separatorSize)_this._config.separatorSize=8;if(void 0===_this._config.topPadding)_this._config.topPadding=0;if(void 0===_this._config.denomination)_this._config.denomination=1;if(void 0===_this._config.horizontalSpacing)_this._config.horizontalSpacing=0;_this._currency=_this._config.currency;_this._digits=[];_this._digitTweens=[];_this.createNumbers();_this.createMask();return _this}RollingBitmapNumberView.prototype.isAnimating=function(){var len=this._digitTweens.length;for(var i=0;i<len;i++)if(this._digitTweens[i])return true;if(this._failSafeTween)return true;return false};RollingBitmapNumberView.prototype.denomination=function(value){this._config.denomination=value;this.currency(this._config.currency)};RollingBitmapNumberView.prototype.killTweens=function(){var len=this._digitTweens.length;for(var i=0;i<len;i++){if(this._digitTweens[i])this._digitTweens[i].kill();this._digitTweens[i]=null}this.killFailSafeTween()};RollingBitmapNumberView.prototype.currency=function(val){this._config.currency=val;this.killTweens();this.createNumbers();this.setValue(this._finalCentValue)};RollingBitmapNumberView.prototype.setBounds=function(value){if(this._failSafeTween)this._finalValue=this._dummyObject.finalValue;this._config.bounds={width:value.width,height:value.height};this.killTweens();this.createNumbers();this.createMask();this.setFinalValue()};RollingBitmapNumberView.prototype.setValue=function(value,animating,time){if(time===void 0)time=0;this._finalCentValue=value;if(this._config.isDiamondPlay)value=Math.floor(value/100);else if(!this._config.currency)value=Math.floor(value/this._config.denomination);else if(0===this._config.numberOfCents)value=Math.floor(value/100);this._finalValue=value;this._totalTime=time;if(animating){this._delta=this._currValue-value;if(0===this._delta)return;this.killFailSafeTween();var prevDir=this._direction;this._direction=this._delta<0?-1:1;this._oldDirection=this._direction;this._timePerCent=Math.abs(time/this._delta);var anim=this.isAnimating();if(anim){if(prevDir!==this._direction)this._oldDirection=prevDir}else this.animateDigit(0)}else{var anim=this.isAnimating();if(anim){this._dummyObject.finalValue=this._finalValue;TweenMax.to(this,.3,{alpha:0,ease:Linear.easeNone,onComplete:this.onFadeOutComplete.bind(this)})}else this.setFinalValue()}};RollingBitmapNumberView.prototype.complete=function(){if(this.isAnimating)TweenMax.to(this,.3,{alpha:0,ease:Linear.easeNone,onComplete:this.onFadeOutComplete.bind(this)})};RollingBitmapNumberView.prototype.createMask=function(){if(null==this._storedMask){this._storedMask=new PIXI.Graphics;this.addChild(this._storedMask);if(!this._config.debug)this.mask=this._storedMask}this._storedMask.clear();this._storedMask.beginFill(16711680,.5);this._storedMask.drawRect(0,0,this._config.bounds.width,this._config.bounds.height);this._storedMask.endFill()};RollingBitmapNumberView.prototype.animateDigit=function(index){if(index===this._digits.length)return;if(this._digitTweens[index])this._digitTweens[index].totalTime(this._digitTweens[index].totalDuration());if(this._timePerCent<.04||1===this._direction){this._dummyObject.value=this._currValue;this._dummyObject.finalValue=this._finalValue;this._failSafeTween=TweenMax.to(this._dummyObject,this._totalTime,{value:this._finalValue,ease:Linear.easeNone,roundProps:["value"],onUpdate:this.onFailSafeTweenUpdate,onUpdateScope:this,onCompleteScope:this,onComplete:function(){this._failSafeTween=null}});return}var digitSprite=this._digits[index];var currDigit=Number(digitSprite.children[0].text);var nextDigit=currDigit-this._direction;if(this._direction===-1){if(nextDigit>9)nextDigit=0;digitSprite.children[1].text=nextDigit.toString();digitSprite.visible=true}else{if(nextDigit<0)nextDigit=9;digitSprite.y=-this._config.bounds.height;digitSprite.children[1].text=currDigit.toString();digitSprite.children[0].text=nextDigit.toString()}if(this._direction===-1&&9===currDigit||1===this._direction&&0===currDigit)this.animateDigit(index+1);this._digitTweens[index]=TweenMax.to(digitSprite,this._timePerCent,{y:digitSprite.y+this._config.bounds.height*this._direction,ease:Linear.easeNone,roundProps:["y"],onComplete:this.onCentAnimationComplete,callbackScope:this,onCompleteParams:[index]})};RollingBitmapNumberView.prototype.killFailSafeTween=function(){if(this._failSafeTween){this._failSafeTween.kill();this._failSafeTween=null}};RollingBitmapNumberView.prototype.setFinalValue=function(){this._currValue=this._finalValue;var value=this._finalValue;var len=this._digits.length;if(value>Math.pow(10,len)-1)value%=Math.pow(10,len);var strValue=value.toString();var strLen=strValue.length;for(var i=len-1;i>=0;i--){this._digits[i].y=this._startPosition;this._digits[i].visible=true;if(i>=strLen){this._digits[i].children[0].text="0";if(!this._config.currency||i>this._config.numberOfCents)this._digits[i].visible=false}else this._digits[i].children[0].text=strValue.charAt(strLen-1-i)}this.alpha=1};RollingBitmapNumberView.prototype.onCentAnimationComplete=function(index){this._digitTweens[index]=null;var digitSprite=this._digits[index];if(this._oldDirection===-1){digitSprite.y=this._startPosition;digitSprite.children[0].text=digitSprite.children[1].text}if(0===index){this._currValue=this._currValue-this._oldDirection;if(1===this._oldDirection){var limit=this._config.currency?this._config.numberofCents+1:1;for(var i=this._digits.length-1;i>=limit;i--)if(!this._digits[i].visible)continue}this._oldDirection=this._direction;if(this._currValue!==this._finalValue)this.animateDigit(0)}};RollingBitmapNumberView.prototype.onFailSafeTweenUpdate=function(){this._finalValue=this._dummyObject.value;this.setFinalValue()};RollingBitmapNumberView.prototype.onFadeOutComplete=function(){if(this._failSafeTween)this._finalValue=this._dummyObject.finalValue;this.killTweens();this.setFinalValue()};RollingBitmapNumberView.prototype.createNumbers=function(){var digitsLength=this._digits.length;for(var i=0;i<digitsLength;i++)this.removeChild(this._digits[i]);this._digits.length=0;if(null!=this._dotTextField){this.removeChild(this._dotTextField);this._dotTextField=null}if(this._config.currency&&0!=this._config.numberOfCents)this._dotTextField=new PIXI.extras.BitmapText(".",this._config.style);var textField=new PIXI.extras.BitmapText("0",this._config.style);this._startPosition=Math.round((this._config.bounds.height-textField.textHeight)/2+this._config.topPadding);var count=this._config.digitsCount;var singleDigitWidth=textField.textWidth+this._config.horizontalSpacing;var dotSymbolWidth=null!=this._dotTextField?this._dotTextField.textWidth+this._config.horizontalSpacing:0;var properCountOfNumbers=count-(this._config.currency?this._config.numberOfCents:0);var numberOfSeparators=Math.floor((properCountOfNumbers-1)/3);var totalSeparatorsWidth=this._config.currency?numberOfSeparators*this._config.separatorSize:0;var calculatedWidth=count*singleDigitWidth+(totalSeparatorsWidth-this._config.horizontalSpacing)+dotSymbolWidth;var startX=this._config.bounds.width-calculatedWidth;var sepCounter=properCountOfNumbers;var sepCount=0;for(var i=0;i<properCountOfNumbers;i++){var cont=new PIXI.Container;for(var j=0;j<2;j++){var txt=new PIXI.extras.BitmapText(j.toString(),this._config.style);cont.addChild(txt);if(1===j)txt.position.y=this._config.bounds.height}if(sepCounter%3===0&&0!=i&&this._config.currency)sepCount++;cont.position.x=startX+i*singleDigitWidth+sepCount*this._config.separatorSize;cont.position.x=Math.round(cont.position.x);this._digits.unshift(cont);this.addChild(cont);sepCounter--}if(this._dotTextField){this._dotTextField.x=Math.round(startX+properCountOfNumbers*singleDigitWidth+sepCount*this._config.separatorSize);this._dotTextField.y=this._startPosition;this.addChild(this._dotTextField);for(var i=0;i<this._config.numberOfCents;i++){var cont=new PIXI.Container;for(var j=0;j<2;j++){var txt=new PIXI.extras.BitmapText(j.toString(),this._config.style);cont.addChild(txt);if(1===j)txt.position.y=this._config.bounds.height}cont.position.x=startX+properCountOfNumbers*singleDigitWidth+i*singleDigitWidth+dotSymbolWidth+sepCount*this._config.separatorSize;this.addChild(cont);this._digits.unshift(cont);cont.position.x=Math.round(cont.position.x)}}};return RollingBitmapNumberView}(PIXI.Container);widgets.RollingBitmapNumberView=RollingBitmapNumberView}(widgets=library.widgets||(library.widgets={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var widgets;!function(widgets){var RollingNumberView=function(_super){__extends(RollingNumberView,_super);function RollingNumberView(config){var _this=_super.call(this)||this;_this._config=config;_this._finalCentValue=_this._finalValue=0;_this._currValue=0;_this._finalValue=0;_this._delta=0;_this._direction=0;_this._oldDirection=0;_this._timePerCent=0;_this._dummyObject={value:0};if(!_this._config.separatorSize)_this._config.separatorSize=8;if(void 0===_this._config.topPadding)_this._config.topPadding=0;if(void 0===_this._config.denomination)_this._config.denomination=1;if(void 0===_this._config.horizontalSpacing)_this._config.horizontalSpacing=0;_this._currency=_this._config.currency;_this._digits=[];_this._digitTweens=[];_this.createNumbers();_this.createMask();return _this}RollingNumberView.prototype.isAnimating=function(){var len=this._digitTweens.length;for(var i=0;i<len;i++)if(this._digitTweens[i])return true;if(this._failSafeTween)return true;return false};RollingNumberView.prototype.denomination=function(value){this._config.denomination=value;this.currency(this._config.currency)};RollingNumberView.prototype.killTweens=function(){var len=this._digitTweens.length;for(var i=0;i<len;i++){if(this._digitTweens[i])this._digitTweens[i].kill();this._digitTweens[i]=null}this.killFailSafeTween()};RollingNumberView.prototype.currency=function(val){this._config.currency=val;this.killTweens();this.createNumbers();this.setValue(this._finalCentValue)};RollingNumberView.prototype.setBounds=function(value){if(this._failSafeTween)this._finalValue=this._dummyObject.finalValue;this._config.bounds=value;this.killTweens();this.createNumbers();this.createMask();this.setFinalValue()};RollingNumberView.prototype.setValue=function(value,animating,time){if(time===void 0)time=0;this._finalCentValue=value;if(this._config.isDiamondPlay)value=Math.floor(value/100);else if(!this._config.currency)value=Math.floor(value/this._config.denomination);else if(0===this._config.numberOfCents)value=Math.floor(value/100);this._finalValue=value;this._totalTime=time;if(animating){this._delta=this._currValue-value;if(0===this._delta)return;this.killFailSafeTween();var prevDir=this._direction;this._direction=this._delta<0?-1:1;this._oldDirection=this._direction;this._timePerCent=Math.abs(time/this._delta);var anim=this.isAnimating();if(anim){if(prevDir!==this._direction)this._oldDirection=prevDir}else this.animateDigit(0)}else{var anim=this.isAnimating();if(anim){this._dummyObject.finalValue=this._finalValue;TweenMax.to(this,.3,{alpha:0,ease:Linear.easeNone,onComplete:this.onFadeOutComplete.bind(this)})}else this.setFinalValue()}};RollingNumberView.prototype.complete=function(){if(this.isAnimating)TweenMax.to(this,.3,{alpha:0,ease:Linear.easeNone,onComplete:this.onFadeOutComplete.bind(this)})};RollingNumberView.prototype.destroy=function(destroyChildren){_super.prototype.destroy.call(this,destroyChildren);TweenMax.killTweensOf(this);this.killTweens()};RollingNumberView.prototype.createMask=function(){if(null!=this._storedMask)this._storedMask.destroy(true);this._storedMask=new PIXI.Graphics;this._storedMask.beginFill(16711680,.5);this._storedMask.drawRect(0,0,this._config.bounds.width,this._config.bounds.height);this._storedMask.endFill();this.addChild(this._storedMask);if(!this._config.debug)this.mask=this._storedMask};RollingNumberView.prototype.animateDigit=function(index){if(index===this._digits.length)return;if(this._digitTweens[index])this._digitTweens[index].totalTime(this._digitTweens[index].totalDuration());if(this._timePerCent<.04||1===this._direction){this._dummyObject.value=this._currValue;this._dummyObject.finalValue=this._finalValue;this._failSafeTween=TweenMax.to(this._dummyObject,this._totalTime,{value:this._finalValue,ease:Linear.easeNone,roundProps:["value"],onUpdate:this.onFailSafeTweenUpdate,onUpdateScope:this,onCompleteScope:this,onComplete:function(){this._failSafeTween=null}});return}var digitSprite=this._digits[index];var currDigit=Number(digitSprite.children[0].text);var nextDigit=currDigit-this._direction;if(this._direction===-1){if(nextDigit>9)nextDigit=0;digitSprite.children[1].text=nextDigit.toString();digitSprite.visible=true}else{if(nextDigit<0)nextDigit=9;digitSprite.y=-this._config.bounds.height;digitSprite.children[1].text=currDigit.toString();digitSprite.children[0].text=nextDigit.toString()}if(this._direction===-1&&9===currDigit||1===this._direction&&0===currDigit)this.animateDigit(index+1);this._digitTweens[index]=TweenMax.to(digitSprite,this._timePerCent,{y:digitSprite.y+this._config.bounds.height*this._direction,ease:Linear.easeNone,roundProps:["y"],onComplete:this.onCentAnimationComplete,callbackScope:this,onCompleteParams:[index]})};RollingNumberView.prototype.killFailSafeTween=function(){if(this._failSafeTween){this._failSafeTween.kill();this._failSafeTween=null}};RollingNumberView.prototype.setFinalValue=function(){this._currValue=this._finalValue;var value=this._finalValue;var len=this._digits.length;if(value>Math.pow(10,len)-1)value%=Math.pow(10,len);var strValue=value.toString();var strLen=strValue.length;for(var i=len-1;i>=0;i--){this._digits[i].y=this._startPosition;this._digits[i].visible=true;if(i>=strLen){this._digits[i].children[0].text="0";if(!this._config.currency||i>this._config.numberOfCents)this._digits[i].visible=false}else this._digits[i].children[0].text=strValue.charAt(strLen-1-i)}this.alpha=1};RollingNumberView.prototype.onCentAnimationComplete=function(index){this._digitTweens[index]=null;var digitSprite=this._digits[index];if(this._oldDirection===-1){digitSprite.y=this._startPosition;digitSprite.children[0].text=digitSprite.children[1].text}if(0===index){this._currValue=this._currValue-this._oldDirection;if(1===this._oldDirection){var limit=this._config.currency?this._config.numberofCents+1:1;for(var i=this._digits.length-1;i>=limit;i--)if(!this._digits[i].visible)continue}this._oldDirection=this._direction;if(this._currValue!==this._finalValue)this.animateDigit(0)}};RollingNumberView.prototype.onFailSafeTweenUpdate=function(){this._finalValue=this._dummyObject.value;this.setFinalValue()};RollingNumberView.prototype.onFadeOutComplete=function(){if(this._failSafeTween)this._finalValue=this._dummyObject.finalValue;this.killTweens();this.setFinalValue()};RollingNumberView.prototype.createNumbers=function(){var digitsLength=this._digits.length;for(var i=0;i<digitsLength;i++){this.removeChild(this._digits[i]);this._digits[i].destroy(true)}this._digits.length=0;if(null!=this._dotTextField){this.removeChild(this._dotTextField);this._dotTextField.destroy(true);this._dotTextField=null}this._config.style={align:"left",fill:this._config.color?this._config.color:16777215,fontFamily:this._config.font?this._config.font:"Arial",fontSize:this._config.size?this._config.size:23,fontWeight:this._config.bold?this._config.bold:"bolder"};if(this._config.currency&&0!=this._config.numberOfCents)this._dotTextField=new PIXI.Text(".",this._config.style);var textField=new PIXI.Text("0",this._config.style);this._startPosition=(this._config.bounds.height-textField.height)/2+this._config.topPadding;var count=this._config.digitsCount;var singleDigitWidth=textField.width+this._config.horizontalSpacing;var dotSymbolWidth=null!=this._dotTextField?this._dotTextField.width+this._config.horizontalSpacing:0;textField.destroy(true);var properCountOfNumbers=count-(this._config.currency?this._config.numberOfCents:0);var numberOfSeparators=Math.floor((properCountOfNumbers-1)/3);var totalSeparatorsWidth=this._config.currency?numberOfSeparators*this._config.separatorSize:0;var calculatedWidth=count*singleDigitWidth+(totalSeparatorsWidth-this._config.horizontalSpacing)+dotSymbolWidth;var startX=this._config.bounds.width-calculatedWidth;var sepCounter=properCountOfNumbers;var sepCount=0;for(var i=0;i<properCountOfNumbers;i++){
var cont=new PIXI.Container;for(var j=0;j<2;j++){var txt=new PIXI.Text(j.toString(),this._config.style);cont.addChild(txt);if(1===j)txt.position.y=this._config.bounds.height}if(sepCounter%3===0&&0!=i&&this._config.currency)sepCount++;cont.position.x=startX+i*singleDigitWidth+sepCount*this._config.separatorSize;this._digits.unshift(cont);this.addChild(cont);sepCounter--}if(this._dotTextField){this._dotTextField.x=startX+properCountOfNumbers*singleDigitWidth+sepCount*this._config.separatorSize;this._dotTextField.y=this._startPosition;this.addChild(this._dotTextField);for(var i=0;i<this._config.numberOfCents;i++){var cont=new PIXI.Container;for(var j=0;j<2;j++){var txt=new PIXI.Text(j.toString(),this._config.style);cont.addChild(txt);if(1===j)txt.position.y=this._config.bounds.height}cont.position.x=startX+properCountOfNumbers*singleDigitWidth+i*singleDigitWidth+dotSymbolWidth+sepCount*this._config.separatorSize;this.addChild(cont);this._digits.unshift(cont)}}};return RollingNumberView}(PIXI.Container);widgets.RollingNumberView=RollingNumberView}(widgets=library.widgets||(library.widgets={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var widgets;!function(widgets){var ScrollView=function(_super){__extends(ScrollView,_super);function ScrollView(){var _this=_super.call(this)||this;_this._posY=0;_this._lastPosY=0;_this._startPosY=0;_this._startTouchPosY=0;_this._scrollSpeed=0;_this.createMask(0,0);_this.on(library.Device.resolveEvent("mousedown"),_this.onMouseDown,_this);_this.on(library.Device.resolveEvent("mousemove"),_this.onMouseMove,_this);_this.on(library.Device.resolveEvent("mouseup"),_this.onMouseUp,_this);_this.interactive=true;PIXI.ticker.shared.add(_this.animateScroll,_this);return _this}Object.defineProperty(ScrollView.prototype,"contentView",{get:function(){return this._contentView},set:function(view){if(this._contentView!=view){if(null!=this._contentView)this.removeChild(this._contentView);this._contentView=view;if(null!=this._contentView)this.addChild(this._contentView)}},enumerable:true,configurable:true});ScrollView.prototype.setSize=function(width,height){this.createMask(width,height)};ScrollView.prototype.dispose=function(){this._stopAnimation=true;this.off(library.Device.resolveEvent("mousedown"),this.onMouseDown,this);this.off(library.Device.resolveEvent("mousemove"),this.onMouseMove,this);this.off(library.Device.resolveEvent("mouseup"),this.onMouseUp,this);PIXI.ticker.shared.remove(this.animateScroll,this)};ScrollView.prototype.createMask=function(width,height){if(null==this._maskSize)this._maskSize=new PIXI.Point;this._maskSize.set(width,height);var mask;if(this.mask instanceof PIXI.Graphics)mask=this.mask;else mask=new PIXI.Graphics;mask.clear();mask.beginFill(16711680);mask.drawRect(0,0,width,height);mask.endFill();this.mask=mask};ScrollView.prototype.animateScroll=function(){if(this._stopAnimation)return;if(!this._touchDown&&this._contentView){this._scrollSpeed*=ScrollView.DECAY;var bouncing=0;var y=this._posY;if(y>0){bouncing=-y*ScrollView.BOUNCING_SPRINGESS;this._scrollSpeed*=ScrollView.BOUNCING_DECAY}else if(y+this._contentView.height<this._maskSize.y){bouncing=(this._maskSize.y-this._contentView.height-y)*ScrollView.BOUNCING_SPRINGESS;this._scrollSpeed*=ScrollView.BOUNCING_DECAY}this._posY=y+this._scrollSpeed+bouncing;this._contentView.position.set(0,this._posY)}};ScrollView.prototype.onMouseDown=function(event){if(!this._contentView||this._contentView.height<=this._maskSize.y)return;this._scrollSpeed=0;this._touchDown=true;var coords=event.data.getLocalPosition(this);this._lastPosY=coords.y;this._startPosY=this._posY;this._startTouchPosY=coords.y};ScrollView.prototype.onMouseMove=function(event){if(this._touchDown){var coords=event.data.getLocalPosition(this);var decay=1;var y=this._startPosY+(coords.y-this._startTouchPosY);if(y>0||y+this._contentView.height<this._maskSize.y)decay=ScrollView.DRAG_DECAY;this._posY=this._posY+(coords.y-this._lastPosY)*decay;this._scrollSpeed=(coords.y-this._lastPosY)*ScrollView.SPEED_SPRINGNESS;this._lastPosY=coords.y;this._contentView.position.set(0,this._posY)}};ScrollView.prototype.onMouseUp=function(event){this._touchDown=false};ScrollView.DECAY=.97;ScrollView.BOUNCING_DECAY=.8;ScrollView.SPEED_SPRINGNESS=.8;ScrollView.BOUNCING_SPRINGESS=.15;ScrollView.DRAG_DECAY=.4;return ScrollView}(PIXI.Container);widgets.ScrollView=ScrollView}(widgets=library.widgets||(library.widgets={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var widgets;!function(widgets){var StateButton=function(_super){__extends(StateButton,_super);function StateButton(states,initialState){var _this=_super.call(this,states[initialState])||this;_this._texturesState=initialState;_this._states=states;return _this}StateButton.prototype.state=function(state){if(void 0==state)return this._texturesState;this._texturesState=state;this.textures=this._states[state];this.setImageForState(widgets.Button.STATE_UP)};return StateButton}(widgets.Button);widgets.StateButton=StateButton}(widgets=library.widgets||(library.widgets={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var com;!function(com){var egt;!function(egt){var library;!function(library){var widgets;!function(widgets){var Text=function(_super){__extends(Text,_super);function Text(config,text,style){var _this=_super.call(this)||this;_this._config=new TextConfig;_this._config.serialize(config);_this._text=new PIXI.Text(text,style);_this._originalFontSize=_this._text.style.fontSize;_this.drawDebugRect();_this.addChild(_this._text);_this.fitToBounds();_this.positionText();return _this}Object.defineProperty(Text.prototype,"text",{get:function(){return this._text.text},set:function(value){if(value!=this._text.text){this._text.text=value;this.fitToBounds();this.positionText()}},enumerable:true,configurable:true});Object.defineProperty(Text.prototype,"config",{set:function(conf){this._config.serialize(conf);this.drawDebugRect();this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(Text.prototype,"style",{get:function(){return this._text.style},set:function(value){if(void 0==value.fontSize)value.fontSize=this._originalFontSize;this._text.style=value;this._originalFontSize=this._text.style.fontSize;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Object.defineProperty(Text.prototype,"align",{set:function(value){this._config.align=value;this.fitToBounds();this.positionText()},enumerable:true,configurable:true});Text.prototype.dispose=function(){this._text.destroy();if(this._rect)this._rect.destroy();this.destroy()};Text.prototype.fitToBounds=function(){if(!this._config.shouldScale)return;this._text.style.fontSize=this._originalFontSize;this._text.style=this._text.style;var fontSize=this._text.style.fontSize;while(this._text.width>this._config.bounds.width&&fontSize>this._config.minFontSize){fontSize--;this._text.style.fontSize=fontSize;this._text.style=this._text.style}};Text.prototype.positionText=function(){if("left"==this._config.align)this._text.x=0;else if("center"==this._config.align)this._text.x=Math.round((this._config.bounds.width-this._text.width)/2);else if("right"==this._config.align)this._text.x=Math.round(this._config.bounds.width-this._text.width);if("middle"===this._config.verticalAlign)this._text.y=Math.round((this._config.bounds.height-this._text.height)/2);else if("top"===this._config.verticalAlign)this._text.y=0;else if("bottom"===this._config.verticalAlign)this._text.y=Math.round(this._config.bounds.height-this._text.height)};Text.prototype.drawDebugRect=function(){if(this._rect)this._rect.destroy();if(this._config.debug){this._rect=new PIXI.Graphics;this._rect.beginFill(16711680,.3);this._rect.drawRect(0,0,this._config.bounds.width,this._config.bounds.height);this._rect.endFill();this.addChild(this._rect)}};return Text}(PIXI.Container);widgets.Text=Text;var TextConfig=function(_super){__extends(TextConfig,_super);function TextConfig(){var _this=null!==_super&&_super.apply(this,arguments)||this;_this.bounds={width:100,height:50};_this.align="left";_this.verticalAlign="middle";_this.shouldScale=false;_this.minFontSize=4;_this.debug=false;return _this}return TextConfig}(Pluck.External);widgets.TextConfig=TextConfig}(widgets=library.widgets||(library.widgets={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));var DefaultBoxGenerator=com.egt.library.widgets.DefaultBoxGenerator;var com;!function(com){var egt;!function(egt){var library;!function(library){var widgets;!function(widgets){var TextInput=function(_super){__extends(TextInput,_super);function TextInput(styles){var _this=_super.call(this)||this;_this._substituteText=true;_this._box_cache={};_this._previous={};_this._dom_added=false;_this._dom_visible=true;_this._placeholder="";_this._placeholderColor=11119017;var defaultInputStyle={position:"absolute",background:"none",border:"none",outline:"none",transformOrigin:"0 0",lineHeight:"1"};_this._input_style=__assign({},defaultInputStyle,styles.input);if(styles.box)_this._box_generator="function"===typeof styles.box?styles.box:widgets.DefaultBoxGenerator(styles.box);else _this._box_generator=null;if(_this._input_style.hasOwnProperty("multiline")){_this._multiline=!!_this._input_style.multiline;delete _this._input_style.multiline}else _this._multiline=false;_this._createDOMInput();_this._setState("DEFAULT");_this._addListeners();return _this}Object.defineProperty(TextInput.prototype,"substituteText",{get:function(){return this._substituted},set:function(substitute){if(this._substituted==substitute)return;this._substituted=substitute;if(substitute){this._createSurrogate();this._dom_visible=false}else{this._destroySurrogate();this._dom_visible=true}this.placeholder=this._placeholder;this._update()},enumerable:true,configurable:true});Object.defineProperty(TextInput.prototype,"placeholder",{get:function(){return this._placeholder},set:function(text){this._placeholder=text;if(this._substituted){this._updateSurrogate();this._dom_input.placeholder=""}else this._dom_input.placeholder=text},enumerable:true,configurable:true});Object.defineProperty(TextInput.prototype,"disabled",{get:function(){return this._disabled},set:function(disabled){this._disabled=disabled;this._dom_input.disabled=disabled;this._setState(disabled?"DISABLED":"DEFAULT")},enumerable:true,configurable:true});Object.defineProperty(TextInput.prototype,"text",{get:function(){return this._dom_input.value},set:function(text){this._dom_input.value=text;if(this._substituted)this._updateSurrogate()},enumerable:true,configurable:true});Object.defineProperty(TextInput.prototype,"htmlInput",{get:function(){return this._dom_input},enumerable:true,configurable:true});TextInput.prototype.focus=function(){if(this._substituted&&!this.dom_visible)this._setDOMInputVisible(true);this._dom_input.focus()};TextInput.prototype.blur=function(){this._dom_input.blur()};TextInput.prototype.select=function(){this.focus();this._dom_input.select()};TextInput.prototype.setInputStyle=function(key,value){this._input_style[key]=value;this._dom_input.style[key]=value;if(this._substituted&&("fontFamily"===key||"fontSize"===key))this._updateFontMetrics();if(this._last_renderer)this._update()};TextInput.prototype.dispose=function(options){this._destroyBoxCache();_super.prototype.destroy.call(this,options)};TextInput.prototype._createDOMInput=function(){if(this._multiline){this._dom_input=document.createElement("textarea");this._dom_input.style.resize="none"}else{this._dom_input=document.createElement("input");this._dom_input.type="text"}for(var key in this._input_style)this._dom_input.style[key]=this._input_style[key]};TextInput.prototype._addListeners=function(){this.on("added",this._onAdded.bind(this));this.on("removed",this._onRemoved.bind(this));this._dom_input.addEventListener("keydown",this._onInputKeyDown.bind(this));this._dom_input.addEventListener("input",this._onInputInput.bind(this));this._dom_input.addEventListener("keyup",this._onInputKeyUp.bind(this));this._dom_input.addEventListener("focus",this._onFocused.bind(this));this._dom_input.addEventListener("blur",this._onBlurred.bind(this))};TextInput.prototype._onInputKeyDown=function(e){this.emit("keydown",e.keyCode)};TextInput.prototype._onInputInput=function(e){if(this._substituted)this._updateSubstitution();this.emit("input",this.text,this.id)};TextInput.prototype._onInputKeyUp=function(e){this.emit("keyup",e.keyCode)};TextInput.prototype._onFocused=function(){this._setState("FOCUSED");this.emit("focus")};TextInput.prototype._onBlurred=function(){this._setState("DEFAULT");this.emit("blur")};TextInput.prototype._onAdded=function(){document.body.appendChild(this._dom_input);this._dom_input.style.display="none";this._dom_added=true};TextInput.prototype._onRemoved=function(){document.body.removeChild(this._dom_input);this._dom_added=false};TextInput.prototype._setState=function(state){this.state=state;this._updateBox();if(this._substituted)this._updateSubstitution()};TextInput.prototype.renderWebGL=function(renderer){_super.prototype.renderWebGL.call(this,renderer);this._renderInternal(renderer)};TextInput.prototype.renderCanvas=function(renderer){_super.prototype.renderCanvas.call(this,renderer);this._renderInternal(renderer)};TextInput.prototype._renderInternal=function(renderer){this._resolution=renderer.resolution;this._last_renderer=renderer;this._canvas_bounds=this._getCanvasBounds();if(this._needsUpdate())this._update()};TextInput.prototype._update=function(){this._updateDOMInput();if(this._substituted)this._updateSurrogate();this._updateBox()};TextInput.prototype._updateBox=function(){if(!this._box_generator)return;if(this._needsNewBoxCache())this._buildBoxCache();if(this.state==this._previous.state&&this._box==this._box_cache[this.state])return;if(this._box)this.removeChild(this._box);this._box=this._box_cache[this.state];this.addChildAt(this._box,0);this._previous.state=this.state};TextInput.prototype._updateSubstitution=function(){if("FOCUSED"===this.state){this._dom_visible=true;this._surrogate.visible=0===this.text.length}else{this._dom_visible=false;this._surrogate.visible=true}this._updateDOMInput();this._updateSurrogate()};TextInput.prototype._updateDOMInput=function(){if(!this._canvas_bounds)return;this._dom_input.style.top=this._canvas_bounds.top+"px";this._dom_input.style.left=this._canvas_bounds.left+"px";this._dom_input.style.transform=this._pixiMatrixToCSS(this._getDOMRelativeWorldTransform());this._dom_input.style.opacity=this.worldAlpha;this._setDOMInputVisible(this.worldVisible&&this._dom_visible);this._previous.canvas_bounds=this._canvas_bounds;this._previous.world_transform=this.worldTransform.clone();this._previous.world_alpha=this.worldAlpha;this._previous.world_visible=this.worldVisible};TextInput.prototype._needsUpdate=function(){return!this._comparePixiMatrices(this.worldTransform,this._previous.world_transform)||!this._compareClientRects(this._canvas_bounds,this._previous.canvas_bounds)||this.worldAlpha!=this._previous.world_alpha||this.worldVisible!=this._previous.world_visible};TextInput.prototype._needsNewBoxCache=function(){var input_bounds=this._getDOMInputBounds();return!this._previous.input_bounds||input_bounds.width!=this._previous.input_bounds.width||input_bounds.height!=this._previous.input_bounds.height};TextInput.prototype._createSurrogate=function(){this._surrogate_hotbox=new PIXI.Graphics;this._surrogate_hitbox.alpha=0;this._surrogate_hitbox.interactive=true;this._surrogate_hitbox.cursor="text";this._surrogate_hitbox.on("pointerdown",this._onSurrogateFocus.bind(this));this.addChild(this._surrogate_hitbox);this._surrogate_mask=new PIXI.Graphics;this.addChild(this._surrogate_mask);this._surrogate=new PIXI.Text("",{});this.addChild(this._surrogate);this._surrogate.mask=this._surrogate_mask;this._updateFontMetrics();this._updateSurrogate()};TextInput.prototype._updateSurrogate=function(){var padding=this._deriveSurrogatePadding();var input_bounds=this._getDOMInputBounds();this._surrogate.style=this._deriveSurrogateStyle();this._surrogate.style.padding=Math.max.apply(Math,padding);this._surrogate.y=this._multiline?padding[0]:(input_bounds.height-this._surrogate.height)/2;this._surrogate.x=padding[3];this._surrogate.text=this._deriveSurrogateText();this._updateSurrogateHitbox(input_bounds);this._updateSurrogateMask(input_bounds,padding)};TextInput.prototype._updateSurrogateHitbox=function(bounds){this._surrogate_hitbox.clear();this._surrogate_hitbox.beginFill(0);this._surrogate_hitbox.drawRect(0,0,bounds.width,bounds.height);this._surrogate_hitbox.endFill();this._surrogate_hitbox.interactive=!this._disabled};TextInput.prototype._updateSurrogateMask=function(bounds,padding){this._surrogate_mask.clear();this._surrogate_mask.beginFill(0);this._surrogate_mask.drawRect(padding[3],0,bounds.width-padding[3]-padding[1],bounds.height);this._surrogate_mask.endFill()};TextInput.prototype._destroySurrogate=function(){if(!this._surrogate)return;this.removeChild(this._surrogate);this.removeChild(this._surrogate_hitbox);this._surrogate.destroy();this._surrogate_hitbox.destroy();this._surrogate=null;this._surrogate_hitbox=null};TextInput.prototype._onSurrogateFocus=function(){this._setDOMInputVisible(true);setTimeout(this._ensureFocus.bind(this),10)};TextInput.prototype._ensureFocus=function(){if(!this._hasFocus())this.focus()};TextInput.prototype._deriveSurrogateStyle=function(){var style={fill:0,fontFamily:"Arial",fontSize:0,fontWeight:0,fontStyle:null};for(var key in this._input_style)switch(key){case"color":style.fill=this._input_style.color;break;case"fontFamily":case"fontSize":case"fontWeight":case"fontVariant":case"fontStyle":style[key]=this._input_style[key]}if(0===this._dom_input.value.length)style.fill=this._placeholderColor;return style};TextInput.prototype._deriveSurrogatePadding=function(){if(this._input_style.padding&&this._input_style.padding.length>0){var components=this._input_style.padding.trim().split(" ");if(1==components.length){var padding=parseFloat(components[0]);return[padding,padding,padding,padding]}else if(2==components.length){var paddingV=parseFloat(components[0]);var paddingH=parseFloat(components[1]);return[paddingV,paddingH,paddingV,paddingH]}else if(4==components.length)return components.map(function(component){return parseFloat(component)})}return[0,0,0,0]};TextInput.prototype._deriveSurrogateText=function(){return 0===this._dom_input.value.length?this._placeholder:this._dom_input.value};TextInput.prototype._updateFontMetrics=function(){var style=this._deriveSurrogateStyle()};TextInput.prototype._buildBoxCache=function(){this._destroyBoxCache();var states=["DEFAULT","FOCUSED","DISABLED"];var input_bounds=this._getDOMInputBounds();for(var i in states)this._box_cache[states[i]]=this._box_generator(input_bounds.width,input_bounds.height,states[i]);this._previous.input_bounds=input_bounds};TextInput.prototype._destroyBoxCache=function(){if(this._box){this.removeChild(this._box);this._box=null}for(var i in this._box_cache){this._box_cache[i].destroy();this._box_cache[i]=null;delete this._box_cache[i]}};TextInput.prototype._hasFocus=function(){return document.activeElement===this._dom_input};TextInput.prototype._setDOMInputVisible=function(visible){this._dom_input.style.display=visible?"block":"none"};TextInput.prototype._getCanvasBounds=function(){var rect=this._last_renderer.view.getBoundingClientRect();var bounds={top:rect.top,left:rect.left,width:rect.width,height:rect.height};bounds.left+=window.scrollX;bounds.top+=window.scrollY;return bounds};TextInput.prototype._getDOMInputBounds=function(){var remove_after=false;if(!this._dom_added){document.body.appendChild(this._dom_input);remove_after=true}var org_transform=this._dom_input.style.transform;var org_display=this._dom_input.style.display;this._dom_input.style.transform="";this._dom_input.style.display="block";var bounds=this._dom_input.getBoundingClientRect();this._dom_input.style.transform=org_transform;this._dom_input.style.display=org_display;if(remove_after)document.body.removeChild(this._dom_input);return bounds};TextInput.prototype._getDOMRelativeWorldTransform=function(){var canvas_bounds=this._last_renderer.view.getBoundingClientRect();var matrix=this.worldTransform.clone();matrix.scale(this._resolution,this._resolution);matrix.scale(canvas_bounds.width/this._last_renderer.width,canvas_bounds.height/this._last_renderer.height);return matrix};TextInput.prototype._pixiMatrixToCSS=function(m){return"matrix("+[m.a,m.b,m.c,m.d,m.tx,m.ty].join(",")+")"};TextInput.prototype._comparePixiMatrices=function(m1,m2){if(!m1||!m2)return false;return m1.a==m2.a&&m1.b==m2.b&&m1.c==m2.c&&m1.d==m2.d&&m1.tx==m2.tx&&m1.ty==m2.ty};TextInput.prototype._compareClientRects=function(r1,r2){if(!r1||!r2)return false;return r1.left==r2.left&&r1.top==r2.top&&r1.width==r2.width&&r1.height==r2.height};return TextInput}(PIXI.Container);widgets.TextInput=TextInput}(widgets=library.widgets||(library.widgets={}))}(library=egt.library||(egt.library={}))}(egt=com.egt||(com.egt={}))}(com||(com={}));
//# sourceMappingURL=egt-library.min.js.map