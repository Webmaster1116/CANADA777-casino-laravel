!function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=0)}([function(e,t,i){i(1),i(2),i(3),e.exports=i(8)},function(e,t){function i(){FingerprintJS.load({token:fingerprintConfig.browser_token}).then((function(e){return e.get()})).then((function(e){e.visitorId||console.log("You can not use this website!!!"),localStorage.setItem("visitorId",e.visitorId),console.log(e.visitorId)})).catch((function(e){return console.log(e)}))}function n(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];$(".modal-content-deposit-button").prop("disabled",e),$(".modal-content-deposit_currency").prop("disabled",e),$(".modal-content-deposit-amount").prop("disabled",e),$(".payment-method-button-element").prop("disabled",e),$("#crypto_deposit_amount").prop("disabled",e)}function a(e,t,i,a){n(!0);var s=a,o=e;$.ajax({url:"/cryptocurrencies_list",type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},dataType:"JSON",data:{currency:o,crypto_deposit_amount:t,currency_to:i,get_address_flag:s},success:function(e){if(e.error)return $(".error-body").show("slow",(function(){$(".error-body").css("display","block")})),void $(".error-content").append("<span>"+e.error+"</span>");var t=e.currency_rate,i=e.address,a=e.minimum_amount;document.querySelector(".crypto-address-details")&&$(".crypto-address-details").remove(),$(".crypto-address-link").append('<div class="crypto-address-details"></div>');var r="";"0"==s?(r=o,i=$("#crypto_address").val()):$("#crypto_address").val(i);var c="";c+="<p>This is your private depositing address. Any transactions you make to this address will show in your balance after 1 confirmation. Kindly note the minimum deposit limit stated, as deposits below this limit cannot be processed.</p>",c+='<div class="crypto-qr-code" style="display:flex; flex-direction:row;"><a href="'+(r="BTC"==t.rate_to_currency?"bitcoin":"BCH"==t.rate_to_currency?"bitcoincash":"LTC"==t.rate_to_currency?"litecoin":"ethereum")+":"+i+'" target="_blank" ><img src="https://chart.googleapis.com/chart?chs=150x150&amp;cht=qr&amp;chl='+r+":"+i+'&amp;choe=UTF-8"></a>',c+='<div class="crypto-description mt-4" style="display:flex; flex-direction:column;"><span>Copy this '+t.rate_to_currency+' address or follow the link to open your wallet application</span><div class="copy-part" style="display:flex; flex-direction:row"><span >'+i+'</span><a href="javascript:fn_copy_address(`address`)" style="padding-left:10px; font-size: 18px">COPY</a></div><span>Currency Rate : '+t.rate_from+t.rate_from_currency+" ~ "+t.rate_to+t.rate_to_currency+"</span><span>minimum deposit :"+a+"</span></div>",c+="</div><p>Please be careful to send only "+t.rate_to_currency+" to this address. Sending any other currency may result in a deposit delay or funds being lost. The deposits made less than the minimal limits may result in the loss of the funds.</p>",c+="<p>Deposit can take up to 10 minutes.</p>",$(".crypto-address-details").append(c),n(!1)},error:function(e){console.log(e),n(!1)}})}$(document).ready((function(){var e,t,s,o="",r="";function c(){dataLayer.push(arguments)}!function(e,t,i){var n=0,a=window.setInterval((function(){e(),++n===i&&window.clearInterval(a)}),t)}((function(){var e=localStorage.getItem("timer_count");null!=e&&300!=e||(e=0),295==e&&"1"==$("#auth_status").val()&&parseFloat($("#user_balance_amount").val())<=0&&$("#nobalance-modal").modal({fadeDuration:300}),localStorage.setItem("timer_count",parseInt(e)+5)}),5e3,1200),"1"==$("#auth_status").val()&&$.ajax({url:"/check_freespin100",type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},dataType:"JSON",success:function(e){1==e.status?setTimeout((function(){lepopup_popup_open(e.popupmodal)}),1e3):parseFloat($("#user_balance_amount").val())<=0&&$("#nobalance-modal").modal({fadeDuration:300})},error:function(){},complete:function(){}}),2==performance.navigation.type&&location.reload(!0),window.dataLayer=window.dataLayer||[],c("js",new Date),c("config","G-YV3LJDK5G6"),localStorage.getItem("freespin_signup")&&"1"==localStorage.getItem("freespin_signup")&&(localStorage.getItem("visitorId")||i(),$("#visitorId").val(localStorage.getItem("visitorId")),$("#freespinuser").val("freespin"),function(){lepopup_close("popup-welcome-bonus*popup-welcome-bonus-mobile"),localStorage.getItem("visitorId")&&null!=localStorage.getItem("visitorId")&&""!=localStorage.getItem("visitorId")||i();$("#visitorId").val(localStorage.getItem("visitorId")),"inline-block"==$("#signup-modal").css("display")?($("#signup-modal").css("display","none"),showSignup()):showSignup()}(),localStorage.removeItem("freespin_signup")),$("#loginresult").val()&&(localStorage.getItem("visitorId")||i(),$("#login_visitorId").val(localStorage.getItem("visitorId")),showSignin()),$(".d-sm-block").contents().find("#choose_pics").click((function(){alert("test")})),window.addEventListener("message",(function(e){"child"==e.data.from&&"playNow"==e.data.type&&console.log("Play Now")})),$("#registerresult").val()&&(localStorage.getItem("visitorId")||i(),$("#visitorId").val(localStorage.getItem("visitorId")),showSignup()),$("#forgotpasswordresult").val()&&showForgot(),$("#resetpasswordresult").val()&&$("#resetpassword-modal").modal({fadeDuration:300,escapeClose:!1,clickClose:!1}),fn_deposit=function(e){e?$("#deposit-modal").modal({fadeDuration:300,escapeClose:!1,clickClose:!1}):(localStorage.getItem("visitorId")||i(),$("#login_visitorId").val(localStorage.getItem("visitorId")),showSignin())},fn_price=function(t,i){e=t,$("#deposit_amount").val(e),$("input[name='deposit_amount']").val(t),$("span#deposit_currency").text($("#deposit_currency option:selected").text()),$(i).hasClass("modal-selected-deposit-currency")||($(i).addClass("modal-selected-deposit-currency"),$(".modal-content-deposit-amount").map((function(e,t){t!==i&&$(t).hasClass("modal-selected-deposit-currency")&&$(t).removeClass("modal-selected-deposit-currency")})))},fn_crypto_price=function(e,t){s=e,$("#crypto_deposit_amount").val(s),$("input[name='crypto_deposit_amount']").val(e),$("span#crypto_deposit_currency").text($("#deposit_currency option:selected").text()),$(t).hasClass("modal-selected-deposit-currency")||($(t).addClass("modal-selected-deposit-currency"),$(".modal-content-deposit-amount").map((function(e,i){i!==t&&$(i).hasClass("modal-selected-deposit-currency")&&$(i).removeClass("modal-selected-deposit-currency")})),"crypto"==$("#payment_method").val()&&""!=o&&a(o,e,r,"0"))},fn_selected_currency=function(e,t){$("#sel_currency").val(e),$(t).hasClass("modal-selected-deposit-currency")||($(t).addClass("modal-selected-deposit-currency"),$(".modal-content-currency-type").map((function(e,i){i!==t&&$(i).hasClass("modal-selected-deposit-currency")&&$(i).removeClass("modal-selected-deposit-currency")})))},fn_payment_method_select=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"interac",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!$(e).hasClass("payment-method-button-element-selected")){if("crypto"==t){o=i;var a=$("#deposit_currency option:selected").text();if(r=$("#deposit_currency option:selected").text(),$("#currency_to").val(a),""==$("#crypto_deposit_amount").val()&&(s=25,$("#crypto_deposit_amount").val(s),$("input[name='crypto_deposit_amount']").val(s),$("span#crypto_deposit_currency").text($("#deposit_currency option:selected").text())),$(".deposit-crypto-content").css("display","block"),$(".deposit-interac-content").css("display","none"),""==$("#sel_currency").val()){n(!0);var c="1";$.ajax({url:"/cryptocurrencies_list",type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},dataType:"JSON",data:{currency:i,crypto_deposit_amount:s,currency_to:a,get_address_flag:c},success:function(e){if(e.error)return $(".error-body").show("slow",(function(){$(".error-body").css("display","block")})),void $(".error-content").append("<span>"+e.error+"</span>");var t=e.currency_rate,i=e.address,a=e.minimum_amount;$("#crypto_address").val(i),document.querySelector(".crypto-address-details")&&$(".crypto-address-details").remove(),$(".crypto-address-link").append('<div class="crypto-address-details"></div>');var s="",o="";o+="<p>This is your private depositing address. Any transactions you make to this address will show in your balance after 1 confirmation. Kindly note the minimum deposit limit stated, as deposits below this limit cannot be processed.</p>",o+='<div class="crypto-qr-code" style="display:flex; flex-direction:row;"><a href="'+(s="BTC"==t.rate_to_currency?"bitcoin":"BCH"==t.rate_to_currency?"bitcoincash":"LTC"==t.rate_to_currency?"litecoin":"ethereum")+":"+i+'" target="_blank" ><img src="https://chart.googleapis.com/chart?chs=150x150&amp;cht=qr&amp;chl='+s+":"+i+'&amp;choe=UTF-8"></a>',o+='<div class="crypto-description mt-4" style="display:flex; flex-direction:column;"><span>Copy this '+t.rate_to_currency+' address or follow the link to open your wallet application</span><div class="copy-part" style="display:flex; flex-direction:row"><span >'+i+'</span><a href="javascript:fn_copy_address(`address`)" style="padding-left:10px; font-size: 18px">COPY</a></div><span>Currency Rate : '+t.rate_from+t.rate_from_currency+" ~ "+t.rate_to+t.rate_to_currency+"</span><span>minimum deposit :"+a+"</span></div>",o+="</div><p>Please be careful to send only "+t.rate_to_currency+" to this address. Sending any other currency may result in a deposit delay or funds being lost. The deposits made less than the minimal limits may result in the loss of the funds.</p>",o+="<p>Deposit can take up to 10 minutes.</p>",$(".crypto-address-details").append(o),n(!1)},error:function(e){console.log(e),n(!1)}})}}else $(".deposit-crypto-content").css("display","none"),$(".deposit-interac-content").css("display","block");$(e).addClass("payment-method-button-element-selected"),$("#payment_method").val(t),$(".payment-method-button-element").map((function(t,i){i!==e&&$(i).hasClass("payment-method-button-element-selected")&&$(i).removeClass("payment-method-button-element-selected")}))}},fn_withdraw_payment_method_select=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"interac",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";$(e).hasClass("payment-method-button-element-selected")||($(e).addClass("payment-method-button-element-selected"),$("#payment_method").val(t),$(".payment-method-button-element").map((function(t,i){i!==e&&$(i).hasClass("payment-method-button-element-selected")&&$(i).removeClass("payment-method-button-element-selected")}))),"crypto"==t?($("#withdraw_crypto_type").val(i),$("#payment_method").val(t),$("#withdrawemail").attr("placeholder","CryptoCurrency Address"),$(".form__description").css("display","none")):($("#withdrawemail").attr("placeholder","Email"),$(".form__description").css("display","block")),$("#payment_method").val(t)},fn_copy_address=function(e){var t=$("<input>");$("body").append(t),t.val($("#crypto_address").val()).select(),document.execCommand("copy"),t.remove()},fn_add_currency_type=function(){},fn_amount_input=function(){$("span#deposit_currency").text($("#deposit_currency option:selected").text())},fn_change_currency=function(){$("span#deposit_currency").text($("#deposit_currency option:selected").text()),$("span#crypto_deposit_currency").text($("#deposit_currency option:selected").text()),r=$("#deposit_currency option:selected").text(),"crypto"==$("#payment_method").val()&&""!=o&&a(o,s,r,"1")},fn_crypto_amount_input=function(e){$("span#crypto_deposit_currency").text($("#deposit_currency option:selected").text()),(s=e)>=25?($(".info-body-min-deposit").fadeOut(1e3),"crypto"==$("#payment_method").val()&&""!=o&&a(o,s,r,"0")):$(".info-body-min-deposit").fadeIn(1e3)},fn_deposit_submit=function(){t=$("#deposit_currency option:selected").text(),$("#cur_deposit_currency").val(t),$("#deposit_amount").val()&&$("#deposit_email").val()&&$("#deposit_phone").val()&&$.ajax({url:$("#deposit-form").attr("action"),type:$("#deposit-form").attr("method"),headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:$("#deposit-form").serialize(),success:function(e){window.location.href(e.redirectUrl)},error:function(){},complete:function(){}})},fn_deposit_close=function(){$("#profile-modal").modal("hide"),location.reload()},fn_withdraw_submit=function(){if($("#amount").val()&&$("#withdrawemail").val()&&$("#phone").val()){if(!/^(1)?\d{10}$/.test($("#phone").val()))return $(".error-body").show("slow",(function(){$(".error-body").css("display","block")})),void $(".error-content").html("<span>Telephone number is not correct</span>");$.ajax({url:$("#withdraw-form").attr("action"),type:$("#withdraw-form").attr("method"),headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:$("#withdraw-form").serialize(),success:function(e){e.error?$(".error-body").show("slow",(function(){if($(".error-body").removeClass("alert-success"),$(".error-body").addClass("alert-danger"),$(".error-body").css("display","block"),$(".error-body strong").html("Wrong"),e.msg.indexOf("play through required")>-1){var t="<span>".concat(e.msg,"</span><div><strong>Your Balance Summary</strong>\n\t\t\t\t\t\t\t\t\t<p>Cash Balance : ").concat(e.realBalance,"</p>\n\t\t\t\t\t\t\t\t\t<p>Bonus Balance : ").concat(e.bonusBalance,"</p>\n\t\t\t\t\t\t\t\t\t<p>Total Balance : ").concat(e.totalBalance,"</p></div>\n\t\t\t\t\t\t\t\t\t<div><strong>Your Bonus Summary</strong>\n\t\t\t\t\t\t\t\t\t<p>Current Playthrough Achieved : ").concat(e.playWager,"</p>\n\t\t\t\t\t\t\t\t\t<p>Playthrough Required : ").concat(e.wager,"</p></div>");$(".error-content").html(t)}else $(".error-content").html("<span>"+e.msg+"</span>")})):($(".error-body").show("slow",(function(){$(".error-body").removeClass("alert-danger"),$(".error-body").addClass("alert-success"),$(".error-body").css("display","block"),$(".error-body strong").html("Success")})),$(".error-content").html("<span>Your withdrawal has been requested.</span>"),$(".form__actions button").prop("disabled",!0))},error:function(){},complete:function(){}})}},fn_alert_close=function(){$(".error-body").fadeOut("slow",(function(){$(".error-body").css("display","none")}))},fn_cashout=function(){$("#cashout-modal").modal({fadeDuration:300,escapeClose:!1,clickClose:!1})},fn_cashout_submit=function(){$("#cashout_amount").val()&&$.ajax({url:$("#cashout-form").attr("action"),type:$("#cashout-form").attr("method"),headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:$("#cashout-form").serialize(),success:function(e){e.error?alert(e.msg):window.location.href(e.redirectUrl)},error:function(){},complete:function(){}})},fn_forgetPassword=function(){$("#forget_email").val()&&$.ajax({url:$("#forgot-password-form").attr("action"),type:$("#forgot-password-form").attr("method"),headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:$("#forgot-password-form").serialize(),success:function(e){$(".alert-danger").hide(),$(".alert-success").hide(),"error"==e.type?($(".alert-danger").show(),$(".alert-danger span").html(e.msg)):($(".alert-success").show(),$(".alert-success span").html(e.msg))},error:function(){},complete:function(){}})},$("img").lazyload({effect:"fadeIn"}),$("#menu-toggle").on("click",(function(){$("#menu_checkbox").prop("checked")?(console.log("true"),$("#menu_checkbox").prop("checked",!1)):(console.log("false"),$("#menu_checkbox").prop("checked",!0)),$("header").toggleClass("active"),$("main").toggleClass("active"),$("body").toggleClass("position-fixed")})),$("#menu_label").on("click",(function(e){e.stopPropagation()}));var l,d=(l=0,function(e,t){clearTimeout(l),l=setTimeout(e,t)});$(".search_game").keyup((function(){d((function(){fn_search_game()}),1e3)})),$("a[href='#search-modal']").on("click",(function(e){$("#search_game_keyword").val(""),$(".search_game_content").html(""),$("#search-modal").modal({fadeDuration:300})})),$("a[href='#playfun-modal']").on("click",(function(e){$("#playfun-modal").modal({fadeDuration:300})})),$("a[href='#signin-modal']").on("click",(function(e){localStorage.getItem("visitorId")&&null!=localStorage.getItem("visitorId")&&""!=localStorage.getItem("visitorId")||i(),$("#login_visitorId").val(localStorage.getItem("visitorId")),showSignin()})),$("a[href='#signup-modal']").on("click",(function(e){localStorage.getItem("visitorId")&&null!=localStorage.getItem("visitorId")&&""!=localStorage.getItem("visitorId")||i(),$("#visitorId").val(localStorage.getItem("visitorId")),showSignup()})),$("a[href='#forgotpassword-modal']").on("click",(function(e){showForgot()})),jQuery.validator.addMethod("noSpace",(function(e,t){return""==e||0!=e.trim().length}),"No space please and don't leave it empty"),jQuery.validator.addMethod("checkEmail",(function(e,t){var i=/\S+@\S+\.\S+/;if(1==i.test(e))return i.test(e)}),"Please enter a valid email address"),jQuery.validator.addMethod("validateCity",(function(e,t){var i=/^([a-zA-Z][a-zA-Z ]{0,49})$/;if(i.test(e))return i.test(e)}),"Please enter a valid city address"),jQuery.validator.addMethod("validatePostalCode",(function(e,t){var i=/^([a-zA-Z][a-zA-Z ]{0,49})$/;if(i.test(e))return i.test(e)}),"Please enter a valid Postal Code");var u=$("#sign-up-form").show();u.validate({rules:{username:{minlength:2,maxlength:50,noSpace:!0},password:{minlength:8,maxlength:50},email:{required:!0,checkEmail:!0},first_name:{minlength:2,maxlength:50,noSpace:!0},last_name:{minlength:2,maxlength:50,noSpace:!0},city:{minlength:2,maxlength:50,noSpace:!0},address:{minlength:2,maxlength:50,noSpace:!0},postalCode:{minlength:2,maxlength:50,noSpace:!0}}}),u.steps({headerTag:"h3",bodyTag:"fieldset",transitionEffect:"slideLeft",onStepChanging:function(e,t,i){if(t>i)return!0;if(3===i&&Number($("#age-2").val())<18)return!1;if(t<i&&(u.find(".body:eq("+i+") label.error").remove(),u.find(".body:eq("+i+") .error").removeClass("error")),1!=t)return u.validate().settings.ignore=":disabled,:hidden",u.valid();if(h.isValidNumber())return $(".invalid-phone").css("display","none"),u.validate().settings.ignore=":disabled,:hidden",u.valid();var n=document.querySelector(".invalid-phone");n.style.display="",n.innerHTML="Invalid phone number",u.validate().settings.ignore=":disabled,:hidden",u.valid()},onStepChanged:function(e,t,i){$("#phoneNumber").attr("placeholder","(000) 000-0000"),2===t&&Number($("#age-2").val())>=18&&u.steps("next")},onFinishing:function(e,t){return u.validate().settings.ignore=":disabled",u.valid()},onFinished:function(e,t){$("#phoneNumber").val(h.getNumber()),localStorage.getItem("visitorId")&&null!=localStorage.getItem("visitorId")&&""!=localStorage.getItem("visitorId")&&""!=$("#visitorId").val||(i(),$("#visitorId").val(localStorage.getItem("visitorId"))),u.submit()}}).validate({errorPlacement:function(e,t){t.before(e)},rules:{acceptAge:{required:!0}}});var p=document.createElement("script");p.setAttribute("src","https://maps.googleapis.com/maps/api/js?key=AIzaSyD6jg2Vx3oL5bQAItFPcYZTZJDJLzZIUSE&callback=initAutocomplete&libraries=places&v=weekly"),document.body.appendChild(p),$("#phoneNumber").is(":focus")&&$(".invalid-phone").css("display","none");var g=document.querySelector("#phoneNumber");g.addEventListener("focus",(function(e){$(".invalid-phone").css("display","none")})),g.addEventListener("focusout",(function(e){if(h.isValidNumber())$(".invalid-phone").css("display","none");else{var t=document.querySelector(".invalid-phone");t.style.display="",t.innerHTML="Invalid phone number"}}));var h=window.intlTelInput(g,{preferredCountries:["ca","us","cn"],onlyCountries:["ca","us","cn"],utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js"}),f=$('input[name="birthday"]'),m=$(".bootstrap-iso form").length>0?$(".bootstrap-iso form").parent():"body";f.datepicker({format:"mm/dd/yyyy",container:m,todayHighlight:!0,autoclose:!0,startDate:"1910-01-01",endDate:new Date((new Date).setFullYear((new Date).getFullYear()-18))}),$(".top-category-list").slick({dots:!1,infinite:!1,speed:300,slidesToShow:6,slidesToScroll:6,responsive:[{breakpoint:1024,settings:{slidesToShow:4,slidesToScroll:4,infinite:!0}},{breakpoint:967,settings:{slidesToShow:3,slidesToScroll:3}}]}),$(".mobile-top-category-list").slick({dots:!1,infinite:!1,variableWidth:!0,speed:300,slidesToShow:5,slidesToScroll:5}),$(".dropdown-toggle").on("click",(function(e){$(".category-toggle-button").toggleClass("show"),$(".dropdown-menu").toggleClass("show")})),$(".dropdown-menu").on("click",(function(e){e.stopPropagation()})),$(".welcomepackage-games").slick({dots:!0,infinite:!0,speed:300,slidesToShow:3,slidesToScroll:3}),fn_profile=function(){$("#profile-modal").modal({fadeDuration:300,escapeClose:!1,clickClose:!1}),fn_profile_load("balance")},fn_side_menu=function(){$("#side-modal").modal({fadeDuration:300,escapeClose:!1,clickClose:!1})},fn_profile_load=function(e){"none"===$("#profile-modal").css("display")&&$("#profile-modal").modal({fadeDuration:300,escapeClose:!1,clickClose:!1}),$.ajax({url:"/profile/"+e,type:"GET",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){e.success&&$("#profile-modal>div.profile-modal-modal-content").html(e.html)},error:function(){},complete:function(){}})},enableButton=function(){$("button[name='updatedetail']").attr("disabled",!1)},changePassword=function(){var e=$("input[name='oldPassword']").val(),t=$("input[name='newPassword']").val(),i=$("input[name='passwordVerify']").val();$(".message.error").css("display","block"),""!=e?""!=t?""!=i?t==i?($(".message.error").css("display","none"),$.ajax({url:"/profile/password/update",type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{old_password:e,password:t},success:function(e){1==e.status&&location.reload()},error:function(e){if(e.responseJSON&&-1==e.responseJSON.status)return $(".message.error").html("Invalid old password"),void $(".message.error").css("display","block")},complete:function(){}})):$(".message.error").html("Two password is not matched!"):$(".message.error").html("Input confirm new password!"):$(".message.error").html("Input new password!"):$(".message.error").html("Input old password!")},$(".game-item img").each((function(){$(this).attr("src",$(this).data("original"))})),$(".horizontal-slider-section").slick({slidesToShow:5,slidesToScroll:5,focusOnSelect:!0,responsive:[{breakpoint:1200,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:990,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:767,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]})})),"1"!==$("#auth_status").val()&&lepopup_add_event("onload",{item:"popup-welcome-bonus",item_mobile:"popup-welcome-bonus-mobile",mode:"every-time",period:24,delay:120,close_delay:0}),fn_search_game=function(){var e=parseInt($("#search_game_load_count").val())+1;""!=$("#search_game_keyword").val()&&$.ajax({url:"/search",type:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{pagegame:e,keyword:$("#search_game_keyword").val()},dataType:"JSON",success:function(e){var t=e.games,i=e.apigames,n="";if("1"!=$("#auth_status").val()){if(t.length>0)for(var a=0;a<t.length;a++)n+='<div class="game-item">                                                    <img src="/frontend/Default/ico/'+t[a].name+'.jpg" data-original="/frontend/Default/ico/'+t[a].name+'.jpg" data-image-blur-on-load-update-occured="true" style="filter: opacity(1);"/>                                                    <div class="game-overlay">                                                        <a href="javascript:fn_playreal_auth()">Play For Real</a>                                                        <a href="/game/'+t[a].name+'/prego">Play For Fun</a>                                                    </div>                                                </div>';if(Object.keys(i).length>0)for(val in i)1==i[val].play_for_fun_supported?n+='<div class="game-item api-game-item">\t\t\t\t\t\t\t\t\t\t\t\t<img src="'+i[val].image_filled+'" data-original="'+i[val].image_filled+'" data-image-blur-on-load-update-occured="true" style="filter: opacity(1);"/>\t\t\t\t\t\t\t\t\t\t\t\t<div class="game-overlay">\t\t\t\t\t\t\t\t\t\t\t\t\t<a href="javascript:fn_playreal_auth()">Play For Real</a>\t\t\t\t\t\t\t\t\t\t\t\t\t<a href="javascript:fn_playreal_auth()">Play For Fun</a>\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t</div>':n+='<div class="game-item api-game-item">\t\t\t\t\t\t\t\t\t\t\t<img src="'+i[val].image_filled+'" data-original="'+i[val].image_filled+'" data-image-blur-on-load-update-occured="true" style="filter: opacity(1);"/>\t\t\t\t\t\t\t\t\t\t\t<div class="game-overlay">\t\t\t\t\t\t\t\t\t\t\t\t<a href="javascript:fn_playreal_auth()">Play For Real</a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>'}else{if(t.length>0)for(a=0;a<t.length;a++)n+='<div class="game-item">                                                    <img src="/frontend/Default/ico/'+t[a].name+'.jpg" data-original="/frontend/Default/ico/'+t[a].name+'.jpg" data-image-blur-on-load-update-occured="true" style="filter: opacity(1);"/>                                                    <div class="game-overlay">                                                        <a href="/game/'+t[a].name+'/realgo">Play For Real</a>                                                        <a href="/game/'+t[a].name+'/prego">Play For Fun</a>                                                    </div>                                                </div>';if(Object.keys(i).length>0)for(val in i)1==i[val].play_for_fun_supported?n+='<div class="game-item api-game-item">\t\t\t\t\t\t\t\t\t\t\t\t<img src="'+i[val].image_filled+'" data-original="'+i[val].image_filled+'" data-image-blur-on-load-update-occured="true" style="filter: opacity(1);"/>\t\t\t\t\t\t\t\t\t\t\t\t<div class="game-overlay">\t\t\t\t\t\t\t\t\t\t\t\t\t<a href="/apigame/'+i[val].game_id+'/api_go">Play For Real</a>\t\t\t\t\t\t\t\t\t\t\t\t\t<a href="/apigame/'+i[val].game_id+'/demo_go">Play For Fun</a>\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t\t</div>':n+='<div class="game-item api-game-item">\t\t\t\t\t\t\t\t\t\t\t<img src="'+i[val].image_filled+'" data-original="'+i[val].image_filled+'" data-image-blur-on-load-update-occured="true" style="filter: opacity(1);"/>\t\t\t\t\t\t\t\t\t\t\t<div class="game-overlay">\t\t\t\t\t\t\t\t\t\t\t\t<a href="/apigame/'+i[val].game_id+'/api_go">Play For Real</a>\t\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t</div>'}$(".search_game_content").html(n)},error:function(e){console.log(e)}})},showSignin=function(){$("#signin-modal input[type='text']").val(""),$("#signin-modal").modal({fadeDuration:300,escapeClose:!1,clickClose:!1})},showSignup=function(){$("#signup-modal input[type='text']").val(""),$("#signup-modal").modal({fadeDuration:300,escapeClose:!1,clickClose:!1})},showForgot=function(){$("#forgotpassword-modal input[type='text']").val(""),$("#forgotpassword-modal").modal({fadeDuration:300,escapeClose:!1,clickClose:!1})}},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){var t,i,a,r,c,l,d,u,p,g,h,f,m,v,b=!1,_=!1,y=!1,w=!1,k=[],S=document.title,C={},T=e(window).width()<429,A=new Date,x="",$=!1,B="undefined",E=!0,I="",j=6e4*(new Date).getTimezoneOffset();e.fn.extend({manualExpandTextarea:function(){var t=this[0];t.style.height="auto",t.style.maxHeight="25px",window.getComputedStyle(t),t.style.height=(t.scrollHeight>350?350:t.scrollHeight)+"px",t.style.maxHeight="",e(t).trigger("textareaChanged")},autoExpandTextarea:function(){var t=this[0];t.addEventListener("input",(function(i){e(t).manualExpandTextarea()}),!1)}}),function(){var e=[].slice;String.prototype.autoLink=function(){var t,i,n,a,s,o,r;return o=/(^|[\s\n]|<[A-Za-z]*\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi,0<(s=1<=arguments.length?e.call(arguments,0):[]).length?(a=s[0],t=a.callback,n=function(){var e;for(i in e=[],a)r=a[i],"callback"!==i&&e.push(" "+i+"='"+r+"'");return e}().join(""),this.replace(o,(function(e,i,a){return""+i+(("function"==typeof t?t(a):void 0)||"<a href='"+a+"'"+n+">"+a+"</a>")}))):this.replace(o,"$1<a href='$2'>$2</a>")}}.call(this);var M={ajax:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t["login-cookie"]=this.null(this.cookie("sb-login"))?I:this.cookie("sb-login"),!("user_id"in t)&&O()&&(t.user_id=O().id),"language"in t||("undefined"==typeof SB_LANG?"undefined":o(SB_LANG))==B||(t.language=SB_LANG),e.ajax({method:"POST",url:SB_AJAX_URL,data:t}).done((function(e){var n;if(Array.isArray(e))n=e;else try{n=JSON.parse(e)}catch(i){console.log(e),M.error(e.length>500?e.substr(0,500)+"... Check the console for more details.":e,"SBF.ajax.".concat(t.function))}"success"==n[0]?0!=i&&i(n[1]):M.errorValidation(n)?0!=i&&i(n):(b&&"security-error"==n[1]&&setTimeout((function(){M.reset()}),1e3),M.error(n[1]+(M.null(n[2])?"":"\nFunction name: "+n[2])+(M.null(n[3])?"":"\nError message: "+("string"==typeof n[3]?n[3]:"error"in n[3]&&"message"in n[3].error?"".concat(n[3].error.message," in function '").concat(n[3].error.function,"'"):n[3])),"SBF.ajax.".concat(t.function)),G.is_busy_update=!1,G.busy(!1))}))},cors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"GET",t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,n=new XMLHttpRequest;if("withCredentials"in n)n.open(e,t,!0);else{if(("undefined"==typeof XDomainRequest?"undefined":o(XDomainRequest))==B)return!1;(n=new XDomainRequest).open(e,t)}n.onload=function(){i(n.responseText)},n.onerror=function(){return!1},n.send()},upload:function(e,t){jQuery.ajax({url:SB_URL+"/include/upload.php",cache:!1,contentType:!1,processData:!1,data:e,type:"POST",success:function(e){t(e)}})},UTC:function(e){return new Date(e).getTime()-j},null:function(e){return null==e||"null"===e||!1===e||!(e.length>0||"number"==typeof e||void 0===e.length)||"undefined"===e},deactivateAll:function(){i.find(".sb-popup, .sb-tooltip, .sb-list .sb-menu, .sb-select ul").sbActivate(!1)},deselectAll:function(){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},getURL:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0==t&&(t=location.search),0==e){for(var i=t.split("?").pop().split("&"),n={},a=0;a<i.length;a++){var s=i[a].split("=");n[s[0]]=s[1]}return n}return t.indexOf("?")>0&&(t=t.substr(0,t.indexOf("?"))),decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(t)||[,""])[1].replace(/\+/g,"%20")||"")},restoreJson:function(e){return M.null(e)||"string"!=typeof e?"":e.replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\f/g,"\f").replace(/\\'/g,"'").replace(/\\"/g,'"').replace(/\\\\/g,"\\")},stringToSlug:function(e){e=(e=e.trim()).toLowerCase();for(var t="åàáãäâèéëêìíïîòóöôùúüûñç·/_,:;",i=0,n=t.length;i<n;i++)e=e.replace(new RegExp(t.charAt(i),"g"),"aaaaaaeeeeiiiioooouuuunc------".charAt(i));return e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+/,"").replace(/-+$/,"").replace(/ /g,"")},slugToString:function(e){return(e=e.replace(/_/g," ").replace(/-/g," ")).charAt(0).toUpperCase()+e.slice(1)},random:function(){for(var e="",t=5;t>0;--t)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return e},isAgent:function(e){return"agent"==e||"admin"==e||"bot"==e},beautifyTime:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("0000-00-00 00:00:00"==e)return"";if(e.indexOf("-")>0){var a=e.split(/[- :]/);t=new Date(a[0],a[1]-1,a[2],a[3],a[4],a[5])}else{var s=e.split(/[. :]/);t=new Date(s[2],s[1]-1,s[0],s[3],s[4],s[5])}var o=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds())),r=Math.round((new Date-o)/864e5)*(n?-1:1),c=[U("Sunday"),U("Monday"),U("Tuesday"),U("Wednesday"),U("Thursday"),U("Friday"),U("Saturday")],l=o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return r<1?(i?U("Today")+" ":"")+l:r<8?"<span>".concat(c[o.getDay()],"</span>").concat(i?" <span>".concat(l,"</span>"):""):"<span>".concat(o.toLocaleDateString(),"</span>").concat(i?" <span>".concat(l,"</span>"):"")},unix:function(e){var t=e.split(/[- :]/);return Date.UTC(t[0],t[1]-1,t[2],t[3],t[4],t[5])},getLocationTimeString:function(e,t){if("timezone"in e){var i={};i.timezone=e.timezone.value,i.country="country"in e?e.country.value:i.timezone.split("/")[0].replace(/_/g," "),i.city="city"in e?e.city.value:i.timezone.split("/")[1].replace(/_/g," "),M.cors("GET","https://worldtimeapi.org/api/timezone/"+i.timezone,(function(e){if(e=JSON.parse(e),M.null(e)||!M.null(e.error))M.error(e,"SBF.getLocationTimeString()"),t(responseonSuccess);else{var n=e.datetime.replace("T"," ");t("".concat(new Date(n.substr(0,n.indexOf("."))).toLocaleString([],{hour:"2-digit",minute:"2-digit"})," ").concat(U("in")," ").concat(""!=i.city?i.city:"").concat(""!=i.country?", "+i.country:""))}}))}},dateDB:function(e){return"now"==e?((e=(new Date).toISOString().replace("T"," ")).indexOf(".")>0&&(e=e.substr(0,e.indexOf("."))),e):"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate()," ").concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds())},updateUsersActivity:function(e,t,i){N.active?i(N.online_ids.includes(t)?"online":"offline"):M.ajax({function:"update-users-last-activity",user_id:e,return_user_id:t,check_slack:!b&&C["slack-active"]},(function(e){i("online"===e?"online":"offline")}))},search:function(e,t){(e=e.toLowerCase())!=r?(clearTimeout(y),y=setTimeout((function(){r=e,t()}),200)):i.find(".sb-search-btn i").sbLoading(!1)},searchClear:function(t,i){""!=e(t).next().val()&&(e(t).next().val(""),i())},error:function(e,t){throw e instanceof Error&&(e=e.message),"."==e[e.length-1]&&(e=e.slice(0,-1)),e.includes("Support Board Error")&&(e=e.replace("Support Board Error ","").replace("]:","]")),!b||""==e||t.includes("update-users-last-activity")||t.startsWith("security-error")||SBAdmin.dialog("[Error] [".concat(t,"] ").concat(e,". Check the console for more details."),"info"),i.find(".sb-loading").sbLoading(!1),M.event("SBError",{message:e,function_name:t}),new Error("Support Board Error [".concat(t,"]: ").concat(e,"."))},errorValidation:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Array.isArray(e)&&"validation-error"===e[0]&&(!0===t||e[1]==t)},loginForm:function(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!(t=e(t)).sbLoading()){var s=(n=!1===n?t.closest(".sb-rich-login"):e(n)).find("#email input").val(),o=n.find("#password input").val();""==s||""==o?n.find(".sb-info").html(U("Please insert an email and password.")).sbActivate():(M.ajax({function:"login",email:s,password:o},(function(e){0!=e&&Array.isArray(e)?!b&&i.isAgent(e[0].user_type)?(V.showErrorMessage(n,"You cannot sign in as an agent."),G.scrollBottom()):(M.loginCookie(e[1]),M.event("SBLoginForm",new P(e[0])),!1!==a&&a(e)):(n.find(".sb-info").html(U("Invalid email or password.")).sbActivate(),b||G.scrollBottom()),t.sbLoading(!1)})),n.find(".sb-info").html("").sbActivate(!1),t.sbLoading(!0))}},loginCookie:function(e){I=e,this.cookie("sb-login",e,3650,"set")},login:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];M.ajax({function:"login",email:t,password:i,user_id:n,token:a},(function(t){return!(0==t||!Array.isArray(t))&&(e.loginCookie(t[1]),0!=s&&s(t),!0)}))},logout:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];G.stopRealTime(),this.cookie("sb-login","","",!1),this.cookie("sb-cloud","","",!1),L("open-conversation",""),G.conversations=!1,O(!1),("undefined"==typeof sb_beams_client?"undefined":o(sb_beams_client))!==B&&sb_beams_client.stop(),M.ajax({function:"logout"},(function(){M.event("SBLogout"),e&&setTimeout((function(){location.reload()}),500)}))},activeUser:function(){return O()},getActiveUser:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,i=z.login();!i&&(L("wp-login")||L("whmcs-login")||L("perfex-login")||L("aecommerce-login"))&&(this.cookie("sb-login","","","delete"),O(!1),L("wp-login",""),L("whmcs-login",""),L("perfex-login",""),L("aecommerce-login","")),M.ajax({function:"get-active-user",db:e,login_app:i,user_token:M.getURL("token")},(function(e){if(!e)return t(),!1;if("cookie"in e&&M.loginCookie(e.cookie),"user_type"in e)if(!b&&M.isAgent(e.user_type)){var n="You are logged in as both agent and user. Logout or use another browser, Incognito or Private mode, to login as user. Force a logout by running the function SBF.reset() in the console.";L("double-login-alert")||(L("double-login-alert",!0),alert(n)),console.warn("Support Board: "+n),M.event("SBDoubleLoginError")}else O(new P(e,"phone"in e?{phone:e.phone}:{})),N.start(),i&&L(i[1]+"-login",!0),t()}))},reset:function(){this.cookie("sb-login","",0,!1),z.dialogflow.unknowCookie(!0);try{localStorage.removeItem("support-board")}catch(e){}this.logout()},lightbox:function(n){var a=e(b?i:t).find(".sb-lightbox-media");a.sbActivate().find(" > div").html(n),b&&(SBAdmin.open_popup=a)},storage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B;try{if(("undefined"==typeof localStorage?"undefined":o(localStorage))==B)return!1}catch(e){return!1}var i=localStorage.getItem("support-board");if(i=null===i?{}:JSON.parse(i),t===B)return e in i&&i[e];""==t?delete i[e]:i[e]=t,localStorage.setItem("support-board",JSON.stringify(i))},cookie:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"get",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s="https:"==location.protocol?"SameSite=None;Secure;":"",o=C&&C["cookie-domain"]?"domain="+C["cookie-domain"]+";":"";if("get"==n){if(!E)return this.storage(e);for(var r=document.cookie.split(";"),c=0;c<r.length;c++){for(var l=r[c];" "==l.charAt(0);)l=l.substring(1);if(0==l.indexOf(e)){var d=l.substring(e.length+1,l.length);return!this.null(d)&&d}}return!1}if("set"==n)if(E){var u=new Date;u.setTime(u.getTime()+i*(a?1:86400)*1e3),document.cookie=e+"="+t+";expires="+u.toUTCString()+";path=/;"+s+o}else this.storage(e,t);else this.cookie(e)&&(E?document.cookie=e+"="+t+";expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;"+s+o:this.storage(e,""))},storageTime:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!1!==t)return 0==L(e)||A.getTime()-L(e)>36e5*t;L(e,A.getTime())},setting:function(e){return o(C)!==B&&e in C?C[e]:-1},shortcode:function(e){return W.shortcode(e)},event:function(t,i){e(document).trigger(t,i),this.setting("webhooks")&&["SBSMSSent","SBLoginForm","SBUserDeleted","SBMessageSent","SBBotMessage","SBEmailSent","SBNewMessagesReceived","SBNewConversationReceived","SBNewConversationCreated","SBActiveConversationStatusUpdated","SBSlackMessageSent","SBMessageDeleted","SBRegistrationForm","SBRichMessageSubmit","SBNewEmailAddress"].includes(t)&&M.ajax({function:"webhooks",function_name:t,parameters:i})},translate:function(e){if(!b&&M.null(C)||b&&("undefined"==typeof SB_TRANSLATIONS?"undefined":o(SB_TRANSLATIONS))===B)return e;var t=b?SB_TRANSLATIONS:C.translations;return t&&e in t?""==t[e]?e:t[e]:e},escape:function(e){return e=R(e,"<script","&lt;script"),e=R(e,"</script","&lt;/script"),e=R(e,"javascript:",""),e=R(e,"onclick=",""),e=R(e,"onerror=","")},visibilityChange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";"hidden"==e?(b||G.stopRealTime(),G.tab_active=!1):(O()&&!b&&G.startRealTime(),G.tab_active=!0,clearInterval(w),document.title=S)},settingsStringToArray:function(e){if(this.null(e))return[];var t=[];e=e.split(",");for(var i=0;i<e.length;i++){var n=e[i].split(":");t[n[0]]="false"!=n[1]&&("true"==n[1]||n[1])}return t},openWindow:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:550,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:350,n=screen.width/2-t/2,a=screen.height/2-i/2;return window.open(e,"targetWindow","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width="+t+",height="+i+", top="+a+", left="+n),!1},convertUTCDateToLocalDate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e=new Date(e),e=new Date(e.getTime()+36e5*t),new Date(e.getTime()+-1*j)},loadResource:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=document.getElementsByTagName("head")[0],n=document.createElement(t?"script":"link");t?n.src=e+"?v=3.3.2":(n.id="support-board",n.rel="stylesheet",n.type="text/css",n.href=e+"?v=3.3.2",n.media="all"),i.appendChild(n)},debounce:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;t in k||(k[t]=!0,e(),setTimeout((function(){delete k[t]}),i))}},N={channels:{},channels_presence:[],active:!1,pusher:!1,started:!1,pusher_beams:!1,initialized:!1,online_ids:[],init_push_notifications:!1,init:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(N.active){if(this.pusher)return!i||i();if(!i)return;e(window).one("SBPusherInit",(function(){i()})),this.initialized=!0,e.getScript("https://js.pusher.com/7.0/pusher.min.js",(function(){t.pusher=new Pusher(b?SB_ADMIN_SETTINGS["pusher-key"]:C["pusher-key"],{cluster:b?SB_ADMIN_SETTINGS["pusher-cluster"]:C["pusher-cluster"],authEndpoint:SB_URL+"/include/pusher.php",auth:{params:{login:M.cookie("sb-login")}}}),M.event("SBPusherInit")}))}},initPushNotifications:function(){var t=this;(O()||b)&&e.getScript("https://js.pusher.com/beams/1.0/push-notifications-cdn.js",(function(){window.navigator.serviceWorker.ready.then((function(e){t.pusher_beams=new PusherPushNotifications.Client({instanceId:b?SB_ADMIN_SETTINGS["push-notifications-id"]:C["push-notifications-id"],serviceWorkerRegistration:e}),t.pusher_beams.start().then((function(){return t.pusher_beams.setDeviceInterests(b?[SB_ACTIVE_AGENT.id,"agents"]:[O().id,"users"])})).catch(console.error),t.init_push_notifications=!1}))}))},initServiceWorker:function(){"serviceWorker"in navigator&&(navigator.serviceWorker.register(b?SB_URL+"/sw.js?v=3.3.2":C["push-notifications-url"]+"?v=3.3.2").then((function(e){e.update()})).catch((function(e){console.warn(e)})),navigator.serviceWorker.onmessage=function(e){b&&e.data.conversation_id&&SBAdmin.conversations.openConversation(e.data.conversation_id,e.data.user_id),b||"sb-open-chat"!=e.data||G.open()})},start:function(){var e=this;b||this.started||!O()||(this.active&&this.init((function(){e.event("client-typing",(function(e){e.user_id==G.agent_id&&G.conversation&&e.conversation_id==G.conversation.id&&(G.typing(-1,"start"),clearTimeout(y),y=setTimeout((function(){G.typing(-1,"stop")}),1e3))})),e.event("new-message",(function(){G.update()})),e.event("update-conversations",(function(){G.updateConversations()}),"global"),e.presence(),e.started=!0,G.automations.run_all()})),C["push-notifications"]&&(("undefined"==typeof Notification?"undefined":o(Notification))!=B&&"granted"==Notification.permission?this.initPushNotifications():this.init_push_notifications=!0))},subscribe:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.pusher)return this.init((function(){t.subscribe(e,i)}));var n=this.pusher.subscribe(e);n.bind("pusher:subscription_error",(function(e){return console.log(e)})),n.bind("pusher:subscription_succeeded",(function(){t.channels[e]=n,i&&i()}))},event:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"private-user-"+O().id;if(!this.pusher)return this.init((function(){i.event(e,t,n)}));n in this.channels?(this.channels[n].unbind(e),this.channels[n].bind(e,(function(e){t(e)}))):this.subscribe(n,(function(){i.event(e,t,n)}))},trigger:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"private-user-"+O().id;if(0==e.indexOf("client-"))return this.channels[i].trigger(e,t);M.ajax({function:"pusher-trigger",channel:i,event:e,data:t},(function(e){return e}))},presence:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1?arguments[1]:void 0;if(!this.pusher)return this.init((function(){e.presence()}));var n=this.pusher.subscribe("presence-"+t);n.bind("pusher:subscription_succeeded",(function(n){if(n.count>98)return e.subscribe(t+1);n.each((function(t){e.presenceCheck(t)&&e.online_ids.push(t.id)})),G.updateUsersActivity(),i&&i()})),n.bind("pusher:subscription_error",(function(e){return console.log(e)})),n.bind("pusher:member_added",(function(t){e.presenceCheck(t)&&e.presenceAdd(t.id)})),n.bind("pusher:member_removed",(function(t){e.presenceRemove(t.id)})),this.channels_presence.push(n),!b&&C["slack-active"]&&(this.event("add-user-presence",(function(t){e.presenceAdd(t.agent_id)})),M.ajax({function:"slack-presence",list:!0},(function(t){for(var i=0;i<t.length;i++)e.presenceAdd(t[i]);G.updateUsersActivity()})))},presenceCheck:function(e){var t=M.isAgent(e.info.user_type);return(b&&!t||!b&&t)&&!this.online_ids.includes(e.id)},presenceAdd:function(e){this.online_ids.includes(e)||(this.online_ids.push(e),this.presenceUpdateAdmin(),G.updateUsersActivity())},presenceRemove:function(e){var t=this.online_ids.indexOf(e);-1!==t&&(this.online_ids.splice(t,1),this.presenceUpdateAdmin(),G.updateUsersActivity())},presenceUnsubscribe:function(){for(var e=0;e<this.channels_presence.length;e++)this.channels_presence[e].unsubscribe("presence-"+(e+1))},presenceUpdateAdmin:function(){b&&i.find(".sb-area-users.sb-active").length&&SBAdmin.users.update()},pushNotification:function(e){var t=b?SB_ACTIVE_AGENT.profile_image:O().image;M.ajax({function:"push-notification",title:b?SB_ACTIVE_AGENT.full_name:O().name,message:(new q).strip(e),icon:t.indexOf("user.svg")>0?C["notifications-icon"]:t,interests:G.getRecipientUserID(),conversation_id:0!=G.conversation&&G.conversation.id},(function(e){return e}))}};function R(e,t,i){if(M.null(e))return e;var n=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),a=new RegExp(n,"ig");return e.replace(a,i)}function D(t){return!!e(t).sbLoading()||(e(t).sbLoading(!0),!1)}function L(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B;return M.storage(e,t)}function U(e){return M.translate(e)}function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;if(-1===e)return window.sb_current_user;window.sb_current_user=e}window.SBF=M,window.SBPusher=N,window.sb_current_user=!1,e.fn.sbActivate=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e(this).setClass("sb-active",t),this},e.fn.sbActive=function(){return e(this).hasClass("sb-active")},e.fn.sbLoading=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"check";return"check"==t?e(this).hasClass("sb-loading"):(e(this).setClass("sb-loading",t),this)},e.fn.sbTogglePopup=function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=!0;return b&&(SBAdmin.open_popup=!1),e(this).sbActive()?(e(this).sbActivate(!1),i.removeClass("sb-popup-active"),a=!1):(i.addClass("sb-popup-active"),i.find(".sb-popup").sbActivate(!1),n&&e(this).css("left",e(n).offset().left+15).sbActivate(),b&&setTimeout((function(){SBAdmin.open_popup=t}),500),M.deselectAll()),a},e.fn.sbUploadFiles=function(t){for(var i=e(this).prop("files"),n=0;n<i.length;n++){var a=i[n],s=new FormData;s.append("file",a),M.upload(s,t)}e(this).value=""},e.fn.setProfile=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return M.null(t)&&(t=0!=O()?O().name:""),M.null(i)&&(i=0!=O()?O().image:SB_URL+"/media/user.svg"),e(this).find("img").attr("src",i),e(this).find(".sb-name").html(t),this},e.fn.setClass=function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];i?e(this).addClass(t):e(this).removeClass(t)};var P=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,e),this.details=t,this.extra=i,this.conversations=[],this.processArray(t)}return s(e,[{key:"id",get:function(){return""==this.get("id")?this.get("user_id"):this.get("id")}},{key:"type",get:function(){return this.get("user_type")}},{key:"name",get:function(){return"first_name"in this.details?this.details.first_name+(""!=this.details.last_name?" "+this.details.last_name:""):""}},{key:"nameBeautified",get:function(){return"last_name"in this.details&&"#"!=this.details.last_name.charAt(0)?this.name:C["visitor-default-name"]}},{key:"image",get:function(){return this.get("profile_image")}},{key:"language",get:function(){var e=this.getExtra("language");return""==e&&(e=this.getExtra("browser_language")),""==e?"":e.value.toLowerCase()}},{key:"get",value:function(e){return e in this.details&&!M.null(this.details[e])?this.details[e]:""}},{key:"getExtra",value:function(e){return e in this.extra&&!M.null(this.extra[e])?this.extra[e]:""}},{key:"set",value:function(e,t){this.details[e]=t}},{key:"setExtra",value:function(e,t){this.extra[e]=t}},{key:"processArray",value:function(e){if(e&&"details"in e){for(var t=0;t<e.details.length;t++)this.setExtra(e.details[t].slug,e.details[t]);delete e.details,this.details=e}}},{key:"update",value:function(e){var t=this;""!=this.id?M.ajax({function:"get-user",user_id:this.id,extra:!0},(function(i){t.processArray(i),e()})):M.error("Missing user ID","SBUser.update")}},{key:"getConversations",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1?arguments[1]:void 0;""!=this.id?M.ajax({function:"get-user-conversations",user_id:this.id,exclude_id:i},(function(i){for(var n=[],a=0;a<i.length;a++){var s=new F([new q(i[a])],{id:i[a].conversation_id,conversation_status_code:i[a].conversation_status_code,department:i[a].department,title:i[a].title});n.push(s)}e.conversations=n,0!=t&&t(n)})):M.error("Missing user ID","SBUser.getConversations")}},{key:"getConversationsCode",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="",i=0!=G.conversation?G.conversation.id:-1;0==e&&(e=this.conversations);for(var n=0;n<e.length;n++)e[n]instanceof F?t+="<li ".concat(i==e[n].id?'class="sb-active" ':"",'data-conversation-status="').concat(e[n].get("conversation_status_code"),'" data-conversation-id="').concat(e[n].id,'" data-department="').concat(e[n].get("department"),'">').concat(e[n].getCode(),"</li>"):M.error("Conversation not of type SBConversation","SBUser.getConversationsCode");return""==t&&(t='<p class="sb-no-results">'.concat(U("No conversations found."),"</p>")),t}},{key:"getFullConversation",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!1!==e?M.ajax({function:"get-conversation",conversation_id:e},(function(e){for(var i=[],n=0;n<e.messages.length;n++)i.push(new q(e.messages[n]));0!=t&&t(new F(i,e.details))})):M.error("Missing conversation ID","SBUser.getFullConversation")}},{key:"getConversationByID",value:function(e){for(var t=0;t<this.conversations.length;t++)if(this.conversations[t].id==e)return this.conversations[t];return!1}},{key:"addConversation",value:function(e){if(e instanceof F){for(var t=e.id,i=!0,n=0;n<this.conversations.length;n++)if(this.conversations[n].id==t){this.conversations[n]=e,i=!1;break}return i&&this.conversations.unshift(e),i}M.error("Conversation not of type SBConversation","SBUser.addConversation")}},{key:"getLastConversation",value:function(){return!this.isConversationsEmpty()&&this.conversations[this.conversations.length-1]}},{key:"isConversationsEmpty",value:function(){return 0==this.conversations.length}},{key:"isExtraEmpty",value:function(){return 0===Object.keys(this.extra).length&&this.extra.constructor===Object}},{key:"delete",value:function(e){var t=this;""!=this.id?M.ajax({function:"delete-user",user_id:this.id},(function(){return M.event("SBUserDeleted",t.id),e(),!0})):M.error("Missing user ID","SBUser.delete")}}]),e}();window.SBUser=P;var q=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,t),this.details=e,"first_name"in this.details&&(this.details.full_name=this.details.first_name+" "+this.details.last_name),this.set("payload",""!=this.get("payload")?JSON.parse(this.get("payload")):{})}return s(t,[{key:"id",get:function(){return this.get("id")}},{key:"attachments",get:function(){return M.null(this.details.attachments)?[]:JSON.parse(this.details.attachments)}},{key:"message",get:function(){return this.get("message")}},{key:"get",value:function(e){return e in this.details&&!M.null(this.details[e])?this.details[e]:""}},{key:"set",value:function(e,t){this.details[e]=t}},{key:"payload",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.get("payload");if(!1!==e&&!1!==t)i[e]=t,this.set("payload",i);else if(!1!==e)return e in i?i.key:"id"in i&&i.id==e&&i;return i}},{key:"getCode",value:function(){var e=M.isAgent(this.details.user_type),t=b?SBAdmin.conversations.messageMenu(e):"",i=this.render(this.details.message),n=this.attachments,a="",s="",o=b||e&&!C["hide-agents-thumb"]||!e&&C["display-users-thumb"]?'<div class="sb-thumb"><img src="'.concat(this.details.profile_image,'"><div>').concat(this.details.full_name,"</div></div>"):"",r=(e?"":"sb-right")+(""==o?"":" sb-thumb-active"),c="";if(""==i&&0==n.length)return"";if(e){for(var l=i.match(/\[.+?\]/g)||[],d=!1,u=0;u<l.length;u++){var p=W.shortcode(l[u]),g=W.generate(p[1],p[0]);0!=g&&("["!=i.charAt(0)&&(g=g.replace("sb-rich-message","sb-rich-message sb-margin-top")),"]"!=i.charAt(i.length-1)&&(g=g.replace("sb-rich-message","sb-rich-message sb-margin-bottom")),i=i.replace(l[u],g),d=!0,c='data-type="'.concat(p[0],'"'))}d&&(r+=" sb-rich-cnt",l.length>1&&(c='data-type="multiple"'))}if(n.length){a='<div class="sb-message-attachments">';for(u=0;u<n.length;u++){var h=n[u][1];/.jpg|.jpeg|.png|.gif/.test(h)?s+='<div class="sb-image'.concat(h.includes(".png")?" sb-image-png":"",'"><img src="').concat(h,'" /></div>'):a+='<a rel="noopener" target="_blank" href="'.concat(h,'">').concat(n[u][0],"</a>")}a+="</div>"}return'<div data-id="'.concat(this.details.id,'" class="').concat(r,'" ').concat(c,">").concat(o,'<div class="sb-cnt"><div class="sb-message').concat(""!=s&&""==i?" sb-message-media":"",'">').concat(i).concat(s,"</div>").concat(a,'<div class="sb-time">').concat(M.beautifyTime(this.details.creation_time,!0),"</div></div>").concat(t,"</div>")}},{key:"render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!1===t&&(t=""+this.details.message);for(var i=t.length,n=t.match(/```([\s\S]*)```/)||[],a=0;a<n.length;a++)t=t.replace(n[a],"[code-"+a+"]");t=(t=(t=(t=(t=t.replace(/(?:\r\n|\r|\n)/g,"<br>")).replace(/\*([^\**]+)\*/g,"<b>$1</b>")).replace(/\__([^\____]+)\__/g,"<i>$1</i>")).replace(/\~([^\~~]+)\~/g,"<del>$1</del>")).replace(/\`([^\``]+)\`/g,"<code>$1</code>");var s=["cede","ubbed"];for(a=0;a<s.length;a++)t=t.replaceAll(s[a],"[U".concat(a,"]"));t=(t=t.replaceAll("uccede","[U1]")).replace(/u([0-9a-f]{4,5})/im,"&#x$1;");for(a=0;a<s.length;a++)t=t.replaceAll("[U".concat(a,"]"),s[a]);((6==i||5==i)&&t.startsWith("&#x")||i<3&&t.match(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/))&&(t='<span class="emoji-large">'.concat(t,"</span>")),t.includes("http")&&(t=t.autoLink({target:"_blank"}));for(a=0;a<n.length;a++)t=t.replace("[code-"+a+"]","<pre>"+e.trim(e.trim(n[a]).substr(3,n[a].length-6).replace(/(?:\r\n|\r|\n)/g,"<br>")))+"</pre>";return t}},{key:"strip",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!1===e&&(e=""+this.details.message);for(var t=[e.match(/\*([^\**]+)\*/g),e.match(/\__([^\____]+)\__/g),e.match(/\~([^\~~]+)\~/g),e.match(/\`([^\``]+)\`/g)],i=["*","__","~","`"],n=0;n<t.length;n++){var a=t[n];if(!M.null(a))for(var s=0;s<a.length;s++)e=e.replace(a[s],a[s].replaceAll(i[n],""))}return e}}]),t}();window.SBMessage=q;var F=function(){function e(t,i){n(this,e),this.details=M.null(i)?{}:i,Array.isArray(t)?(this.messages=[],t.length&&(t[0]instanceof q?this.messages=t:M.error("Messages not of type SBMessage","SBConversation.constructor"))):M.error("Message array not of type Array","SBConversation.constructor")}return s(e,[{key:"id",get:function(){return""==this.get("id")?this.get("conversation_id"):this.get("id")}},{key:"get",value:function(e){if(e in this.details&&!M.null(this.details[e]))return this.details[e];if("title"==e){if(!M.null(this.details.first_name))return this.details.first_name+" "+this.details.last_name;if(this.messages.length)return this.messages[0].get("full_name")}return""}},{key:"set",value:function(e,t){this.details[e]=t}},{key:"getMessage",value:function(e){for(var t=0;t<this.messages.length;t++)if(this.messages[t].id==e)return this.messages[t].set("index",t),this.messages[t];return!1}},{key:"getLastMessage",value:function(){var e=this.messages.length;return e>0&&this.messages[e-1]}},{key:"getLastUserMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!1===e&&(e=this.messages.length-1);for(var i=e;i>-1;i--){var n=this.messages[i].get("user_type");if(!t&&!M.isAgent(n)||!0===t&&("agent"==n||"admin"==n)||"bot"==t&&"bot"==n||"no-bot"==t&&"bot"!=n)return this.messages[i].set("index",i-1),this.messages[i]}return!1}},{key:"updateMessage",value:function(e,t){if(t instanceof q){for(var i=0;i<this.messages.length;i++)if(this.messages[i].id==e)return this.messages[i]=t,!0}else M.error("Message not of type SBMessage","SBConversation.updateMessage");return!1}},{key:"addMessages",value:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t]instanceof q&&this.messages.push(e[t]);else e instanceof q?this.messages.push(e):M.error("Messages not of type SBMessage","SBConversation.addMessages()");return this}},{key:"getCode",value:function(){var e=this.messages.length;if(e){var t=this.messages[e-1],i=t.message;if(!1!==i.indexOf("[")){var n=i.match(/\[.+?\]/g)||[];if(n.length){var a=W.shortcode(n[0]);i=i.replace(n[0],U(M.null(a[1].message)?M.null(a[1].title)?"":a[1].title:a[1].message))}}var s=_&&!C["tickets-conversations-title-user"]?this.get("title"):U(b||"#"!=t.get("last_name").charAt(0)?t.get("full_name"):"You");return'<div class="sb-conversation-item" data-user-id="'.concat(t.get("user_id"),'"><img src="').concat(t.get("profile_image"),'"><div><span class="sb-name">').concat(s,'</span><span class="sb-time">').concat(M.beautifyTime(t.get("creation_time")),'</span></div><div class="sb-message">').concat(i.length>114?i.substr(0,114)+" ...":i,"</div></div>")}return""}},{key:"deleteMessage",value:function(e){for(var t=0;t<this.messages.length;t++)if(this.messages[t].id==e)return this.messages.splice(t,1),!0;return!1}},{key:"searchMessages",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[],n=0;n<this.messages.length;n++){var a=this.messages[n].message;(t&&a==e||!t&&a.includes(e))&&i.push[messages[n]]}return i}},{key:"getUserMessages",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"user",t=[],i="user"==e?["visitor","lead","user"]:"agents"==e?["agent","admin"]:["bot"],n=0;n<this.messages.length;n++)i.includes(this.messages[n].get("user_type"))&&t.push(this.messages[n]);return t}},{key:"getAttachments",value:function(){for(var e=[],t=0;t<this.messages.length;t++)for(var i=this.messages[t].attachments,n=0;n<i.length;n++){var a=i[n][1];e.push([i[n][0],a,a.substr(a.lastIndexOf(".")+1),this.messages[t].id])}return e}}]),e}();window.SBConversation=F;var G={rich_messages_list:["chips","buttons","select","inputs","table","list"],emoji_options:{range:0,range_limit:47,list:[],list_now:[],touch:!1},initialized:!1,editor_listening:!1,conversation:!1,is_busy:!1,is_busy_update:!1,chat_open:!1,real_time:!1,agent_id:-1,agent_online:!1,user_online:!1,expanded:!1,main_header:!0,start_header:!1,desktop_notifications:!1,flash_notifications:!1,datetime_last_message:"2000-01-01 00:00:00",datetime_last_message_conversation:"2000-01-01 00:00:00",audio:!1,audio_out:!1,tab_active:!0,notifications:[],typing_settings:{typing:!1,sent:!1,timeout:!1},email_sent:!1,dashboard:!1,articles:!1,articles_categories:!1,slack_channel:[-1,-1],skip:!1,queue_interval:!1,departments:!1,default_department:null,default_agent:null,offline_message_set:!1,sendMessage:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=(v||m)&&z.dialogflow.active(),p=!1;if(0==this.conversation){var g=!b&&O().getLastConversation();if(!g||"new-conversation"==x)return void this.newConversation(r,i,"",[],b&&""!=SB_ACTIVE_AGENT.department?SB_ACTIVE_AGENT.department:null,null,(function(){return t.sendMessage(i,n,a,s,o)}));this.openConversation(g.id),this.setConversation(g),x=!1}-1==i&&(i=b?SB_ACTIVE_AGENT.id:O().id);var h=i!=f;0==a.length&&l.find(".sb-attachments > div").each((function(){a.push([e(this).attr("data-name"),e(this).attr("data-value")])})),""==n&&(n=d.val().trim(),b&&SBAdmin.must_translate&&(z.dialogflow.translate([n],O().language,(function(e){e&&(o?o["original-message"]=n:o={"original-message":n},e[0].translatedText&&(n=e[0].translatedText)),t.sendMessage(i,n,a,s,o,r)})),p=!0)),this.busy(!0),h&&(d.val("").css("height",""),l.find(".sb-attachments").html("")),this.activateBar(!1),p||(!1===r&&i==f&&(r="skip"),!b&&h&&v&&!z.dialogflow.active()&&(r=2),""!=n||a.length||o?(M.ajax({function:"send-message",user_id:i,conversation_id:this.conversation.id,message:n,attachments:a,conversation_status_code:r,queue:!b&&C.queue&&h,payload:o,recipient_id:!!b&&O().id},(function(e){var c=b||!u;!C.routing&&!C["hide-conversations-routing"]||t.agent_online||3!=G.conversation.get("conversation_status_code")||M.ajax({function:"update-conversation-agent",conversation_id:G.conversation.id,agent_id:C["hide-conversations-routing"]?"routing-unassigned":"routing"}),(b&&!t.user_online||!b&&!t.agent_online)&&t.update(),!b&&t.dashboard&&i==f&&t.updateConversations(),!b&&h&&C.follow.active&&t.followUp(),!h||u&&M.null(o["skip-dialogflow"])||((!b&&C["notify-agent-email"]||b&&!t.user_online&&SB_ADMIN_SETTINGS["notify-user-email"]&&!M.null(O().get("email")))&&t.sendEmail(n,a),(!b&&C["sms-active-agents"]||b&&!t.user_online&&SB_ADMIN_SETTINGS["sms-active-users"]&&O().getExtra("phone"))&&t.sendSMS(n)),(!L("queue")&&!b&&C["push-notifications"]&&h&&!u||b&&SB_ADMIN_SETTINGS["push-notifications-users"])&&N.pushNotification(n),h&&(!o||"sb-human-takeover"!=o.id&&M.null(o["skip-dialogflow"]))&&z.dialogflow.message(n,a),!b&&h&&"visitor"==O().type?M.ajax({function:"update-user-to-lead",user_id:i},(function(){O().set("user_type","lead"),C["slack-active"]&&c&&t.slackMessage(i,O().name,O().image,n,a)})):c&&!t.skip&&(b&&SB_ADMIN_SETTINGS["slack-active"]?t.slackMessage(O().id,SB_ACTIVE_AGENT.full_name,SB_ACTIVE_AGENT.profile_image,n,a):C["slack-active"]&&t.slackMessage(O().id,h?O().name:C["bot-name"],h?O().image:C["bot-image"],n,a)),h&&!C["dialogflow-offline-message"]&&t.offlineMessage(),h&&C["language-detection"]&&t.conversation&&n.split(" ").length>1&&!M.storage("language-detection-completed")&&(M.ajax({function:"google-language-detection-update-user",user_id:i,string:n,token:z.dialogflow.token}),M.storage("language-detection-completed",!0)),!t.articles||b||!C.articles||C["office-hours"]||t.isInitDashboard()||setTimeout((function(){t.conversation&&(t.sendMessage(f,"[articles]"),t.scrollBottom(),t.articles=!1)}),5e3),e.queue&&t.queue(t.conversation.id);var l={user_id:i,conversation_id:t.conversation.id,conversation_status_code:r,message_id:e["message-id"],message:n,attachments:a};M.event("SBMessageSent",l),_&&SBTickets.onMessageSent(),!1!==s&&s(l),t.skip&&(t.skip=!1),t.busy(!1)})),h&&(n=M.escape(n),c.append(new q({id:"sending",profile_image:b?SB_ACTIVE_AGENT.profile_image:O().image,full_name:O().name,creation_time:"0000-00-00 00:00:00",message:n,user_type:b?"agent":"user"}).getCode().replace('<div class="sb-time"></div>','<div class="sb-time">'.concat(U("Sending"),"<i></i></div>"))),this.dashboard||this.scrollBottom()),(this.audio&&!b&&this.chat_open&&h&&["a","aa"].includes(C["chat-sound"])||b&&"a"==SB_ADMIN_SETTINGS.sounds)&&this.audio_out.play()):this.busy(!1))},sendBotMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return z.dialogflow.message(e,t)},updateMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";M.ajax({function:"update-message",message_id:e,message:t})},sendEmail:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=i?O().id:this.getRecipientUserID();if(!b&&!isNaN(n)&&this.agent_online)return!1;M.ajax({function:"create-email",recipient_id:n,sender_name:i?C["bot-name"]:b?SB_ACTIVE_AGENT.full_name:O().name,sender_profile_image:i?C["bot-image"]:b?SB_ACTIVE_AGENT.profile_image:O().image,message:e,attachments:t,department:!!this.conversation&&this.conversation.get("department"),conversation_id:!!this.conversation&&this.conversation.id},(function(){M.event("SBEmailSent",{recipient_id:n,message:e,attachments:t})}))},sendSMS:function(e){var t=this,i=this.getRecipientUserID();if(!b&&!isNaN(i)&&this.agent_online)return!1;M.ajax({function:"send-sms",to:i,message:e,conversation_id:!!this.conversation&&this.conversation.id},(function(i){"sent"==i.status||"queued"==i.status?M.event("SBSMSSent",{recipient_id:t.getRecipientUserID(),message:e,response:i}):i.message&&M.error(i.message,"SBChat.sendSMS")}))},pushNotification:function(e){N.pushNotification(e)},desktopNotification:function(e,t,i){var n=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("granted"!==Notification.permission)Notification.requestPermission();else{var o=new Notification(e,{body:(new q).strip(t),icon:i.indexOf("user.svg")>0?C["notifications-icon"]:i});o.onclick=function(){b?a&&SBAdmin.conversations.openConversation(a,0==s?O().id:s):n.start(),window.focus()}}},getRecipientUserID:function(){return b?O().id:this.lastAgent(!1)?this.lastAgent(!1).user_id:M.null(this.conversation.get("agent_id"))?M.null(this.conversation.get("department"))?"agents":"department-"+this.conversation.get("department"):this.conversation.get("agent_id")},submit:function(){var e=this;if(!this.is_busy){if(0==O()&&!b)return this.addUserAndLogin((function(){e.newConversation(2,-1,"",[],null,null,(function(){e.sendMessage()}))})),void this.busy(!0);this.sendMessage(),C["cron-email-piping-active"]&&(setInterval((function(){M.ajax({function:"email-piping"})}),6e4),C["cron-email-piping-active"]=!1),N.init_push_notifications&&N.initPushNotifications()}},initChat:function(){var e=this;b||M.getActiveUser(!0,(function(){var t=!1!==O(),i=!!t&&O().type;_||!C.popup.active||L("popup")||T&&C["popup-mobile-hidden"]||e.popup(),_||!C.privacy||C["registration-required"]||L("privacy-approved")?(("undefined"==typeof Notification?"undefined":o(Notification))!==B&&!C["push-notifications-users"]&&("all"==C["desktop-notifications"]||"users"==C["desktop-notifications"]||b&&"agents"==C["desktop-notifications"])&&(e.desktop_notifications=!0),("all"==C["flash-notifications"]||"users"==C["flash-notifications"]||b&&"agents"==C["flash-notifications"])&&(e.flash_notifications=!0),!e.registration(!0)||_?(t||!(("undefined"==typeof SB_WP_WAITING_LIST?"undefined":o(SB_WP_WAITING_LIST))!==B||C["visitors-registration"]||C.welcome||C.subscribe||_)||_&&C["tickets-registration-required"]?0==e.conversation&&t?e.populateConversations():e.finalizeInit():e.addUserAndLogin((function(){e.welcome(),e.subscribe(),z.woocommerce.waitingList(),e.finalizeInit()})),C["header-name"]&&t&&"user"==i&&!_&&u.find(".sb-title").html("".concat(U("Hello")," ").concat(O().nameBeautified,"!")),e.welcome(),e.subscribe(),N.active||(setInterval((function(){e.updateConversations(),e.updateUsersActivity()}),10200),G.automations.run_all()),z.woocommerce.waitingList(),e.scrollBottom(!0)):e.registration()):e.privacy()}))},finalizeInit:function(){var e=this;this.initialized||(t.attr("style",""),b||_||(this.isInitDashboard()&&this.showDashboard(),!T&&window.innerHeight<760&&t.find(" > .sb-body").css("max-height",window.innerHeight-130+"px")),this.initialized=!0,b||(O()&&!this.registration(!0)&&(L("open-conversation")&&this.openConversation(L("open-conversation")),M.getURL("conversation")&&this.openConversation(M.getURL("conversation"))),(!this.chat_open&&(L("chat-open")||"open"==M.getURL("chat"))||M.getURL("conversation"))&&setTimeout((function(){e.start()}),500),C["woocommerce-returning-visitor"]&&(!1===L("returning-visitor")?M.storageTime("returning-visitor"):M.storageTime("returning-visitor",24)&&!L("returning-visitor-processed")&&setTimeout((function(){M.ajax({function:"woocommerce-returning-visitor"},(function(){L("returning-visitor-processed",!0)}))}),15e3)),C["timetable-type"]&&G.offlineMessage()),_&&SBTickets.init(),M.event("SBInit"))},start:function(){this.initialized&&(this.populate(),this.headerAgent(),this.updateUsersActivity(),this.startRealTime(),this.chat_open=!0,this.popup(!0),0!=this.conversation&&this.updateNotifications("remove",this.conversation.id),t.sbActivate(),e("body").addClass("sb-chat-open"),"open"==C["welcome-trigger"]&&this.welcome())},open:function(){var i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];i&&!this.chat_open?(this.start(),this.chat_open=!0,this.startRealTime(),t.sbActivate(),e("body").addClass("sb-chat-open"),L("chat-open",!0),M.event("SBChatOpen")):!i&&this.chat_open&&(t.sbActivate(!1),this.stopRealTime(),this.chat_open=!1,L("chat-open",!1),e("body").removeClass("sb-chat-open"),M.event("SBChatClose"))},openConversation:function(e){var t=this;O().getFullConversation(e,(function(i){if(""==i.id)return L("open-conversation",""),!1;t.setConversation(i),t.hideDashboard(),t.populate(),t.main_header=!1,L("queue")==e&&t.queue(e),(t.chat_open||_)&&t.updateNotifications("remove",e),_&&SBTickets.activateConversation(i),L("open-conversation",e),M.event("SBConversationOpen",i)}))},update:function(){var e=this;if(0!=this.conversation&&!this.is_busy_update){var t=this.conversation.getLastMessage(),i=!1;M.ajax({function:"get-new-messages",conversation_id:this.conversation.id,datetime:this.datetime_last_message_conversation},(function(n){var a=n.length;if(e.is_busy_update=!1,0!=e.conversation&&Array.isArray(n)&&a>0&&(!t||t.id!=n[a-1].id||t.message!=n[a-1].message||t.payload!=n[a-1].payload||t.attachments!=n[a-1].attachments)){for(var s="",o=[],r=[],l=!1,d=0;d<a;d++)if(!r.includes(n[d].id)){var u=new q(n[d]),p=u.payload();if(e.datetime_last_message_conversation=u.get("creation_time"),"boolean"!=typeof p&&"event"in p){var g=p.event;("delete-message"==g&&!1!==e.conversation.getMessage(u.id)||!b&&""==u.message&&!u.attachments.length)&&e.deleteMessage(u.id),"woocommerce-update-cart"!=g||b||z.woocommerce.updateCart(p.action,p.id),z.dialogflow.active()||"conversation-status-update-3"!=g&&"conversation-status-update-4"!=g&&"activate-bot"!=g||(z.dialogflow.active("activate"),l=!0)}0==e.conversation.getMessage(n[d].id)?(e.conversation.addMessages(u),s+=u.getCode()):(e.conversation.updateMessage(u.id,u),c.find('[data-id="'.concat(u.id,'"]')).replaceWith(u.getCode()),i=!0),o.push(u),r.push(u.id)}c.append(s);var h=e.conversation.getLastMessage(),f=h.get("user_type"),m=M.isAgent(f);!b&&m&&"bot"!=f&&(e.chat_open&&(-1==h.message.indexOf("sb-rich-success")&&e.setConversationStatus(0),C.follow.active&&clearTimeout(y)),l||(z.dialogflow.active(!1),z.dialogflow.unknowCookie(!0))),L("queue")==e.conversation.id&&m&&"bot"!=f&&e.queue("clear"),c.find('[data-id="sending"]').remove(),e.headerAgent(),e.dashboard||i||(e.scrollBottom(),setTimeout((function(){e.scrollBottom()}),300)),e.typing(-1,"stop"),!e.audio||1==a&&M.null(o[0].message)&&M.null(o[0].attachments)||!(!b&&e.chat_open&&(m||"bot"==f)&&["aa","ia"].includes(C["chat-sound"])||b&&!M.isAgent(f)&&["a","i","ic"].includes(SB_ADMIN_SETTINGS.sounds))||e.audio.play(),M.event("SBNewMessagesReceived",o),_&&SBTickets.onNewMessageReceived(o[0])}})),this.is_busy_update=!0}},updateConversations:function(){var e=this;0!=O()&&M.ajax({function:"get-new-user-conversations",datetime:this.datetime_last_message},(function(i){if(i.length){var n=i.length;e.datetime_last_message=i[0].creation_time;for(var a=0;a<n;a++){var s=i[a].conversation_id,o=new q(i[a]),r=i[a].conversation_status_code,c=new F([o],{id:s,conversation_status_code:r,department:i[a].department,title:i[a].title}),l=O().addConversation(c);i[a].user_id==O().id||e.conversation.id==s&&e.chat_open||(e.updateNotifications("add",s),C["auto-open"]&&e.start());var d=o.payload();if("boolean"!=typeof d&&"event"in d)if("open-chat"==d.event&&((e.conversation.id!=s||e.dashboard)&&e.openConversation(s),setTimeout((function(){e.open()}),500)),""==o.message&&!o.attachments.length)continue;e.tab_active||(e.desktop_notifications&&G.desktopNotification(o.get("full_name"),o.message,o.get("profile_image")),e.flash_notifications&&(clearInterval(w),w=setInterval((function(){document.title=document.title==S?U("New message..."):S}),2e3)),!e.audio||!["a","aa","i"].includes(C["chat-sound"])||e.chat_open&&e.tab_active&&!e.dashboard||M.null(o.message)&&M.null(o.attachments)||e.audio.play()),l&&(M.event("SBNewConversationReceived",c),_&&SBTickets.onNewConversationReceived(c))}t.find(".sb-user-conversations").html(O().getConversationsCode())}}))},populate:function(){if(this.conversation){for(var e="",t=c.find(" > .sb-notify-message"),i=0;i<this.conversation.messages.length;i++)e+=this.conversation.messages[i].getCode();c.html((t.length?t[0].outerHTML:"")+e),this.dashboard||this.scrollBottom()}else O()&&!O().isConversationsEmpty()&&this.showDashboard()},populateConversations:function(){var e=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];O()&&O().getConversations((function(n){var a=n.length;if(a){var s=Date.now();e.datetime_last_message=n[0].messages[0].get("creation_time");for(var o=0;o<a;o++)1!=n[o].get("conversation_status_code")||e.conversation&&e.conversation.id==n[o].id||e.updateNotifications("add",n[o].id),s-M.UTC(n[o].messages[0].get("creation_time"))<6e3&&e.open();t.removeClass("sb-no-conversations"),t.find(".sb-user-conversations").html(O().getConversationsCode())}e.initialized&&"open-conversation"!=x||1!=a||e.isInitDashboard()||L("open-conversation")||(e.openConversation(O().conversations[0].id),"open-conversation"==x&&(x="")),!1!==i&&i(n),e.finalizeInit()}))},newConversation:function(e){var i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];0!=O()?M.ajax({function:"new-conversation",status_code:e,title:_?t.find(".sb-ticket-title input").val():null,department:M.null(o)?this.default_department:o,agent_id:M.null(r)?this.default_agent:r,routing:C.routing},(function(t){if(M.errorValidation(t,"user-not-found"))i.addUserAndLogin((function(){i.newConversation(e,n,a,s,o,r,c)}));else{var l=new F([],t.details);i.setConversation(l),(""!=a||s.length>0)&&i.sendMessage(n,a,s,!1,!!_&&{"skip-dialogflow":!0}),n!=f&&i.queue(l.id),!1!==c&&c(l),M.event("SBNewConversationCreated",l)}})):M.error("activeUser() not setted","SBChat.newConversation")},setConversation:function(e){e instanceof F?(this.conversation=e,this.datetime_last_message_conversation=0==this.conversation.getLastMessage()?"2000-01-01 00:00:00":this.conversation.getLastMessage().get("creation_time"),e.id!=this.conversation.id&&this.queue(e.id),L("open-conversation",e.id),M.event("SBActiveConversationChanged",e)):M.error("Value not of type SBConversation","SBChat.setConversation")},queue:function(e){var i=this;if("clear"==e)return t.removeClass("sb-notify-active sb-queue-active"),c.find(" > .sb-notify-message").remove(),clearInterval(this.queue_interval),this.queue_interval=!1,void L("queue","");!b&&C.queue&&M.ajax({function:"queue",conversation_id:e,department:this.conversation.get("department")},(function(n){if(c.find(" > .sb-notify-message").remove(),0==n)C["push-notifications"]&&N.pushNotification(i.conversation.getLastUserMessage().message),i.sendMessage(f,U(""==C["queue-message-success"]?"It's your turn! An agent will reply to you shortly.":C["queue-message-success"])),i.queue("clear");else{var a=(""==C["queue-response-time"]?5:parseInt(C["queue-response-time"]))*n,s=U(""==C["queue-message"]?"Please wait for an agent. You are number {position} in the queue. Your waiting time is approximately {minutes} minutes.":C["queue-message"]).replace("{position}","<b>"+n+"</b>").replace("{minutes}","<b>"+a+"</b>");c.prepend('<div class="sb-notify-message sb-rich-cnt"><div class="sb-cnt"><div class="sb-message">'.concat(s,"</div></div></div>")),!1===i.queue_interval&&(i.queue_interval=setInterval((function(){i.queue(e)}),10100),t.addClass("sb-notify-active sb-queue-active"),L("queue",e))}M.event("SBQueueUpdate",n)}))},getDepartmentCode:function(e,t){var i=this;if(0!=this.departments)if("all"==e){var n="";for(var a in this.departments)this.getDepartmentCode(this.departments[a].id,(function(e){n+=e}));t(n)}else t('<div data-color="'.concat(this.departments[e].color,'">').concat(""==this.departments[e].image?"<span></span>":'<img src="'.concat(this.departments[e].image,'" />'),"<div>").concat(this.departments[e].name,"<div></div>"));else M.ajax({function:"get-departments"},(function(n){0!=n&&(i.departments=n,i.getDepartmentCode(e,t))}))},startRealTime:function(){var e=this;N.active||(this.stopRealTime(),this.real_time=setInterval((function(){e.update(),e.typing(b?O()?O().id:-1:e.agent_id,"check")}),1e3))},stopRealTime:function(){clearInterval(this.real_time)},updateUsersActivity:function(){var t=this;0!=O()&&M.updateUsersActivity(O().id,this.agent_id,(function(i){t.typing_settings.typing||("online"==i||t.agent_id==f?(e(p).addClass("sb-status-online").html(U("Online")),t.agent_online=t.agent_id!=f):(e(p).removeClass("sb-status-online").html(U("Away")),t.agent_online=!1))}))},busy:function(e){l.find(".sb-loader").sbActivate(e),this.is_busy=e,M.event("SBBusy",e)},headerAgent:function(){if(!b&&!_&&!this.dashboard&&0!=this.conversation&&(-1==this.agent_id||0!=this.conversation.getLastMessage()&&M.isAgent(this.conversation.getLastMessage().get("user_type"))&&this.conversation.getLastMessage().get("user_id")!=this.agent_id)){var e=this.lastAgent();0!=e&&(this.agent_id=e.user_id,this.headerReset(),u.addClass("sb-header-agent").attr("data-agent-id",this.agent_id).html('<div class="sb-dashboard-btn sb-icon-arrow-left"></div><div class="sb-profile"><img src="'.concat(e.profile_image,'" /><div><span class="sb-name">').concat(e.full_name,'</span><span class="sb-status">').concat(U("Away"),'</span></div><i class="sb-icon sb-icon-close sb-responsive-close-btn"></i></div>')),p=u.find(".sb-status"),this.updateUsersActivity(),M.storageTime("header-animation",1)&&(u.addClass("sb-header-animation"),setTimeout((function(){u.removeClass("sb-header-animation")}),8e3),M.storageTime("header-animation")))}},headerReset:function(){0==this.start_header&&(this.start_header=[u.html(),u.attr("class")]),u.removeClass("sb-header-main sb-header-brand sb-header-agent sb-header-minimal"),this.main_header=!1},lastAgent:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!1;if(0!=this.conversation)for(var i=this.conversation.messages.length-1;i>-1;i--){var n=this.conversation.messages[i].get("user_type");if(M.isAgent(n)&&(e||!e&&"bot"!=n)){t={user_id:this.conversation.messages[i].get("user_id"),full_name:this.conversation.messages[i].get("full_name"),profile_image:this.conversation.messages[i].get("profile_image")};break}}return t},scrollBottom:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];setTimeout((function(){h.scrollTop(t?0:h[0].scrollHeight),e.scrollHeader()}),20)},scrollHeader:function(){if(this.main_header&&this.dashboard){var e=h.scrollTop();e>-1&&e<1e3&&u.find(".sb-content").css({opacity:1-e/500,top:e/10*-1+"px"})}},showDashboard:function(){b||_||(t.addClass("sb-dashboard-active"),u.removeClass("sb-header-agent"),this.hidePanel(),0!=this.start_header&&u.html(this.start_header[0]).addClass(this.start_header[1]),h.find(" > div").sbActivate(!1),t.find(".sb-dashboard").sbActivate(),this.populateConversations(),this.conversation=!1,this.agent_id=-1,this.stopRealTime(),this.dashboard=!0,this.main_header=!0,this.scrollBottom(!0),M.event("SBDashboard"))},hideDashboard:function(){b||_||(c.sbActivate(),t.removeClass("sb-dashboard-active").find(".sb-dashboard").sbActivate(!1),this.dashboard=!1,this.headerAgent(),this.scrollHeader(0),this.chat_open&&this.startRealTime(),M.event("SBDashboardClosed"))},showPanel:function(e,i){if(_)return SBTickets.showPanel(e,i);var n=h.find(" > .sb-panel-"+e);n.length&&(h.find(" > div").sbActivate(!1),n.sbActivate(),0==this.start_header&&(this.start_header=[u.html(),u.attr("class")]),u.attr("class","sb-header sb-header-panel").html("".concat(U(i),'<div class="sb-dashboard-btn sb-icon-close"></div>')),t.addClass("sb-panel-active"),this.dashboard=!0),M.event("SBPanelActive",e)},hidePanel:function(){t.removeClass("sb-panel-active"),u.removeClass("sb-header-panel")},clear:function(){this.conversation=!1,c.html("")},updateNotifications:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",i=arguments.length>1?arguments[1]:void 0;if("add"!=e||this.notifications.includes(i)||this.notifications.push(i),"remove"==e)for(var n=0;n<this.notifications.length;n++)if(this.notifications[n]==i){this.notifications.splice(n,1),0!=this.conversation.get("conversation_status_code")&&["1","2",1,2].includes(this.conversation.get("conversation_status_code"))&&this.setConversationStatus(0);break}var a=this.notifications.length;t.find(".sb-chat-btn span").attr("data-count",a).html(a>-1?a:0),M.event("SBNotificationsUpdate",{action:e,conversation_id:i})},setConversationStatus:function(e){var t=this;return!!this.conversation&&(M.ajax({function:"update-conversation-status",conversation_id:this.conversation.id,status_code:e},(function(){t.conversation.set("conversation_status_code",e),M.event("SBActiveConversationStatusUpdated",{conversation_id:t.conversation.id,status_code:e})})),!0)},typing:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"check";if(this.conversation){var a=this.agent_online||b&&this.user_online;if("check"==n&&!N.active&&-1!=i&&i!=f&&a)M.ajax({function:"is-typing",user_id:i,conversation_id:this.conversation.id},(function(e){e&&!t.typing_settings.typing?t.typing(-1,"start"):!e&&t.typing_settings.typing&&t.typing(-1,"stop")}));else if("set"==n&&a)N.active?M.debounce((function(){N.trigger("client-typing",{user_id:b?SB_ACTIVE_AGENT.id:O().id,conversation_id:t.conversation.id})}),"#2"):this.typing_settings.sent?(clearTimeout(this.typing_settings.timeout),this.typing_settings.timeout=setTimeout((function(){M.ajax({function:"set-typing",user_id:i,conversation_id:-1},(function(){t.typing_settings.sent=!1}))}),2e3)):(this.typing_settings.sent=!0,M.ajax({function:"set-typing",user_id:i,conversation_id:this.conversation.id}),this.typing(i,"set"));else if("start"==n||"stop"==n){var s="start"==n;if(!b&&p)if(s)e(p).addClass("sb-status-typing").html(U("Typing"));else{var o=this.agent_online||this.agent_id==f;e(p).removeClass("sb-status-typing").html(U(o?"Online":"Away")),o&&e(p).addClass("sb-status-online")}this.typing_settings.typing=s,M.event("SBTyping",s)}}},showArticles:function(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=_?t.find(".sb-panel-main .sb-panel"):h.find(" > .sb-panel-articles"),a="";n.html("").sbLoading(!0),this.showPanel("articles",""==C["articles-title"]?"Help Center":C["articles-title"]),this.getArticles(i,(function(t){if(-1==i){for(var s=[],o=0;o<e.articles_categories.length;o++){var r=e.articles_categories[o];""!=r&&(a+='<div data-id="'.concat(r.id,'" class="sb-title">').concat(U(r.title),"</div>"));for(var c=0;c<t.length;c++)s.includes(t[c].id)||""!=r&&!M.null(t[c].categories)&&!t[c].categories.includes(r.id)||(a+='<div data-id="'.concat(t[c].id,'"><div>').concat(t[c].title,"</div><span>").concat(t[c].content,"</span></div>"),s.push(t[c].id),s.push(t[c].id))}n.html('<div class="sb-articles">'.concat(a,"</div>"))}else if(t){var l=M.storage("article-rating-"+t.id);n.html('<div data-id="'.concat(t.id,'"').concat(l?' data-user-rating="'.concat(l,'"'):"",' class="sb-article"><div class="sb-title">').concat(t.title,'</div><div class="sb-content">').concat(t.content.replace(/(?:\r\n|\r|\n)/g,"<br>"),"</div>").concat(M.null(t.link)?"":'<a href="'.concat(t.link,'" target="_blank" class="sb-btn-text"><i class="sb-icon-plane"></i>').concat(U("Read more"),"</a>"),'<div class="sb-rating"><span>').concat(U("Rate and review"),'</span><div><i data-rating="positive" class="sb-submit sb-icon-like"><span>').concat(U("Helpful"),'</span></i><i data-rating="negative" class="sb-submit sb-icon-dislike"><span>').concat(U("Not helpful"),"</span></i></div></div></div>"))}n.sbLoading(!1),M.event("SBArticles",{id:i,articles:t})}))},getArticles:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!1===this.articles||-1!=t)M.ajax({function:"get-articles",categories:!0,articles_language:("undefined"==typeof SB_LANG?"undefined":o(SB_LANG))!=B&&SB_LANG[0],id:t},(function(n){-1==t&&(e.articles=n[0],e.articles_categories=n[1].length?n[1]:[""]),i(-1==t?n[0]:n)}));else{if(!i)return this.articles;i(this.articles)}},searchArticles:function(i,n){""!=i&&(e(n).sbLoading(!0),M.ajax({function:"search-articles",articles_language:("undefined"==typeof SB_LANG?"undefined":o(SB_LANG))!=B&&SB_LANG[0],search:i},(function(i){var a="";if(0==i.length)a+='<p class="sb-no-results">'.concat(U("No articles found."),"</p>");else for(var s=0;s<i.length;s++)a+='<div data-id="'.concat(i[s].id,'"><div>').concat(i[s].title,"</div><span>").concat(i[s].content,"</span></div>");t.find(".sb-dashboard-articles .sb-articles").html(a),e(n).sbLoading(!1)})))},setArticleRating:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];M.ajax({function:"article-ratings",article_id:e,rating:t},(function(e){i&&i(e)}))},categoryEmoji:function(e){var t=this.emoji_options.list;if("all"==e)this.emoji_options.list_now=t;else{this.emoji_options.list_now=[];for(var i=0;i<t.length;i++)t[i].category.startsWith(e)&&this.emoji_options.list_now.push(t[i])}this.emoji_options.range=0,this.populateEmoji(0),this.populateEmojiBar()},mouseWheelEmoji:function(e){var t=this.emoji_options.range;(function(e){var t=e.originalEvent.wheelDelta;return o(t)==B&&(t=e.originalEvent.deltaY),o(t)==B&&(t=-1*e.originalEvent.detail),t})(e)>0||T&&o(e.originalEvent.changedTouches)!==B&&this.emoji_options.touch<e.originalEvent.changedTouches[0].clientY?t-=t<1?0:1:t+=t>this.emoji_options.range_limit?0:1,g.find(".sb-emoji-bar > div").sbActivate(!1).eq(t).sbActivate(),this.emoji_options.range=t,this.populateEmoji(t),e.preventDefault()},insertEmoji:function(t){t.indexOf(".svg")>0&&(t=e.parseHTML(t)[0].alt),this.insertText(t),g.sbTogglePopup()},showEmoji:function(e){var t=this;g.sbTogglePopup(e)&&(b||g.css({left:l.offset().left+(_?68:20),top:l.offset().top-window.scrollY-(_?l.height()-330:304)}),""==g.find(".sb-emoji-list > ul").html()&&jQuery.ajax({method:"POST",url:SB_AJAX_URL,data:{function:"emoji"}}).done((function(e){t.emoji_options.list=JSON.parse(e),t.emoji_options.list_now=t.emoji_options.list,t.populateEmoji(0),t.populateEmojiBar()})),M.deselectAll())},populateEmoji:function(e){var t="",i=T?42:48,n=e*i+i,a=this.emoji_options.list_now;n>a.length&&(n=a.length),this.emoji_options.range_limit=a.length/i-1,this.emoji_options.range=e;for(var s=e*i;s<n;s++)t+="<li>".concat(a[s].char,"</li>");g.find(".sb-emoji-list").html("<ul>".concat(t,"</ul>"))},populateEmojiBar:function(){for(var e='<div class="sb-active"></div>',t=T?42:49,i=0;i<this.emoji_options.list_now.length/t-1;i++)e+="<div></div>";this.emoji_options.range=0,g.find(".sb-emoji-bar").html(e)},clickEmojiBar:function(t){var i=e(t).index();this.populateEmoji(i),this.emoji_options.range=i,g.find(".sb-emoji-bar > div").sbActivate(!1).eq(i).sbActivate()},searchEmoji:function(e){var t=this;M.search(e,(function(){if(e.length>1){for(var i=t.emoji_options.list,n=[],a=0;a<i.length;a++)(i[a].category.toLowerCase().includes(e)||i[a].name.toLowerCase().includes(e))&&n.push(i[a]);t.emoji_options.list_now=n}else t.emoji_options.list_now=t.emoji_options.list;t.emoji_options.range=0,t.populateEmoji(0),t.populateEmojiBar()}))},textareaChange:function(t){var i=e(t).val();b&&SBAdmin.conversations.savedReplies(t,i),""!=i?(this.typing(b&&!N.active?SB_ACTIVE_AGENT.id:O().id,"set"),this.activateBar()):this.activateBar(!1)},insertText:function(t){var i=e(d.get(0)),n=0;if(this.dashboard)return!1;if("selectionStart"in i.get(0))n=i.get(0).selectionStart;else if("selection"in document){i.focus();var a=document.selection.createRange(),s=document.selection.createRange().text.length;a.moveStart("character",-i.value.length),n=a.text.length-s}i.val(i.val().substr(0,n)+t+i.val().substr(n)),i.focus(),i.manualExpandTextarea(),this.activateBar()},enabledAutoExpand:function(){d.length&&d.autoExpandTextarea()},privacy:function(){var e=this;M.ajax({function:"get-block-setting",value:"privacy"},(function(t){h.append('<div class="sb-privacy sb-init-form" data-decline="'.concat(t.decline,'"><div class="sb-title">').concat(t.title,'</div><div class="sb-text">').concat(t.message,"</div>")+(""!=t.link?'<a target="_blank" href="'.concat(t.link,'">').concat(t["link-name"],"</a>"):"")+'<div class="sb-buttons"><a class="sb-btn sb-approve">'.concat(t["btn-approve"],'</a><a class="sb-btn sb-decline">').concat(t["btn-decline"],"</a></div></div>")),e.finalizeInit(),M.event("SBPrivacy")})),this.dashboard||this.showDashboard(),this.dashboard=!0,t.addClass("sb-init-form-active")},popup:function(){var e=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(i){var a=t.find(".sb-popup-message"),s=a.attr("data-id");return L("popup"+(M.null(s)?"":s),!0),void a.remove()}setTimeout((function(){e.chat_open||(0==n&&(n=C.popup),t.find(".sb-popup-message").remove(),t.append('<div data-id="'.concat("id"in n?n.id:"",'" class="sb-popup-message">')+("image"in n&&""!=n.image?'<img src="'.concat(n.image,'" />'):"")+("title"in n&&""!=n.title?'<div class="sb-top">'.concat(n.title,"</div>"):"")+'<div class="sb-text">'.concat(n.message,'</div><div class="sb-icon-close"></div></div>')),M.event("SBPopup",n))}),1e3)},followUp:function(){var e=this;this.followUpCheck()&&(0!=y&&clearTimeout(y),y=setTimeout((function(){if(e.followUpCheck()){var t=C.follow;e.sendMessage(f,'[email id="sb-follow-up-form" title="'.concat(t.title,'" message="').concat(t.message,'" placeholder="').concat(t.placeholder,'" name="').concat(t.name,'" last-name="').concat(t["last-name"],'" phone="').concat(t.phone,'" phone-required="').concat(t["phone-required"],'" success="').concat(t.success,'"]')),e.scrollBottom(),M.storageTime("email"),M.event("SBFollowUp")}}),M.null(C.follow.delay)?C["office-hours"]||$?15e3:z.dialogflow.active()?8e3:5e3:parseInt(C.follow.delay)))},followUpCheck:function(){return!b&&0!=this.conversation&&0!=O()&&""==O().get("email")&&M.storageTime("email",24)&&(C["office-hours"]||!C.follow["disable-office-hours"])},welcome:function(){var e=this;"open"==C["welcome-trigger"]&&!this.chat_open||!C["office-hours"]&&C["welcome-disable-office-hours"]||!C.welcome||L("welcome")||!O()||M.ajax({function:"get-block-setting",value:"welcome"},(function(t){setTimeout((function(){C["dialogflow-welcome"]?!1===e.conversation?e.newConversation(3,-1,"",[],null,null,(function(){z.dialogflow.welcome()})):z.dialogflow.welcome():e.sendMessage(f,t.message,[],!1,!1,3),t.open&&e.start(),t.sound&&e.audio.play(),e.skip=!0,M.event("SBWelcomeMessage")}),parseInt(_?0:C["welcome-delay"])),L("welcome",!0)}))},subscribe:function(){var e=this;C.subscribe&&!L("subscribe")&&0!=O()&&M.null(O().get("email"))&&O()&&setTimeout((function(){M.ajax({function:"get-block-setting",value:"subscribe"},(function(t){e.sendMessage(f,t.message,[],!1,{event:"open-chat"},3),t.sound&&e.audio&&e.audio.play(),e.skip=!0,L("subscribe",!0)}))}),parseInt(C["subscribe-delay"]))},offlineMessage:function(){var e=this;if(!b&&!this.offline_message_set&&C.timetable&&(!C["office-hours"]||!$&&!C["timetable-disable-agents"])&&M.storageTime("timetable",1)){var i=C["timetable-message"];switch(C["timetable-type"]){case"header":u.find(".sb-title").html(i[0]),u.find(".sb-text").html(i[1]),this.offline_message_set=!0;break;case"info":c.prepend('<div class="sb-notify-message sb-rich-cnt"><div class="sb-cnt"><div class="sb-message"><b>'.concat(i[0],"</b> ").concat(i[1],"</div></div></div>")),t.addClass("sb-notify-active"),this.offline_message_set=!0;break;default:setTimeout((function(){e.conversation&&(e.sendMessage(f,C["timetable-hide"]?"*".concat(i[0],"*\n").concat(i[1]):"[timetable]"),e.scrollBottom(),e.offline_message_set=!0,M.storageTime("timetable"))}),5e3)}}},slackMessage:function(e,t,i,n){var a=this,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(0==this.conversation)return!1;var o=this.conversation.id;M.ajax({function:"send-slack-message",user_id:e,full_name:t,profile_image:i,conversation_id:o,message:n,attachments:s,channel:this.slack_channel[0]==O().id?this.slack_channel[1]:-1},(function(e){a.slack_channel=[O().id,e[1]],M.event("SBSlackMessageSent",{message:n,conversation_id:o,slack_channel:e[1]})}))},deleteMessage:function(e){var t=this;M.ajax({function:"delete-message",message_id:e},(function(){t.conversation.deleteMessage(e),c.find('[data-id="'.concat(e,'"]')).remove(),M.event("SBMessageDeleted",e)}))},registration:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C["registration-required"];if(e)return""!=C["registration-required"]&&(!C["registration-offline"]||!$)&&(!C["registration-timetable"]||!C["office-hours"])&&(!1===O()||["visitor","lead"].includes(O().type));h.append(W.generate({},""!=C["registration-link"]?"login":i,"sb-init-form")),this.dashboard||this.showDashboard(),this.dashboard=!0,this.finalizeInit(),t.addClass("sb-init-form-active")},activateBar:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];l.find(".sb-bar").sbActivate(e)},addUserAndLogin:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];M.ajax({function:"add-user-and-login",login_app:z.login()},(function(t){M.loginCookie(t[1]),O(new P(t[0])),N.start(),N.active||G.automations.run_all(),!1!==e&&e(t)}))},isInitDashboard:function(){return C["init-dashboard"]||0!=O()&&O().conversations.length>1},uploadResponse:function(t){if("success"==(t=JSON.parse(t))[0])if("extension_error"==t[1]){var i="The file you are trying to upload has an extension that is not allowed.";b?SBAdmin.dialog(i,"info"):alert(i)}else if(e(a).hasClass("sb-input-image"))e(a).find(".image").attr("data-value","").css("background-image",""),setTimeout((function(){e(a).find(".image").attr("data-value",t[1]).css("background-image",'url("'.concat(t[1],"?v=").concat(M.random(),'")')).append('<i class="sb-icon-close"></i>'),a=!1}),500);else{var n=t[1].substr(t[1].lastIndexOf("/")+1);l.find(".sb-attachments").append('<div data-name="'.concat(n,'" data-value="').concat(t[1],'">').concat(n,'<i class="sb-icon-close"></i></div>')),G.activateBar()}else M.error(t[1],"sb-upload-files.change");this.busy(!1)},automations:{history:[],busy:[],scroll_position_intervals:{},run_all:function(){for(var t=this,i=C.automations,n=function(){var n=i[a],r=n.conditions,c=0==r.length,l=!1,d=!1,u=!1;for(s=0;s<r.length;s++){var p=r[s][1];switch(c=!1,r[s][0]){case"browsing_time":c=!0,l=p;break;case"scroll_position":c=!0,d=p;break;case"include_urls":case"exclude_urls":case"referring":var g="referring"==r[s][0]?document.referrer:window.location.href,h=r[s][2].split(","),f="exclude_urls"!=r[s][0];for(f||(c=!0),g=g.replace("https://","").replace("http://","").replace("www.",""),o=0;o<h.length;o++)if(h[o]=e.trim(h[o].replace("https://","").replace("http://","").replace("www.","")),"contains"==p&&-1!=g.indexOf(h[o])||"does-not-contain"==p&&-1==g.indexOf(h[o])||"is-exactly"==p&&h[o]==g||"is-not"==p&&h[o]!=g){c=f;break}break;case"custom_variable":var m=p.split("=");m[0]in window&&window[m[0]]==m[1]&&(c=!0);break;case"returning_visitor":case"user_type":case"cities":case"languages":case"countries":c=0!=O(),u=!0;break;case"user_phone":c=O()&&!M.null(O().getExtra("phone"));break;case"user_email":c=O()&&!M.null(O().get("email"));break;default:c=!0}if(!c)break}["messages","emails","sms"].includes(n.type)&&!O()&&(c=!1),c&&(u?n.id in t.busy||(M.ajax({function:"automations-validate",automation:n},(function(e){!1!==e&&t.run_all_final(n,d,l),delete t.busy[n.id]})),t.busy[n.id]=!0):t.run_all_final(n,d,l))},a=0;a<i.length;a++){var s,o;n()}},run_all_final:function(t,i,n){var a=this;i?this.scroll_position_intervals[t.id]=setInterval((function(){e(window).scrollTop()>parseInt(i)&&(n?setTimeout((function(){a.run(t)}),1e3*parseInt(n)):a.run(t),clearInterval(a.scroll_position_intervals[t.id]))}),1e3):n?setTimeout((function(){a.run(t)}),1e3*parseInt(n)):this.run(t)},run:function(i){var n=this;if(!this.history.includes(i.id))switch(i.type){case"messages":case"emails":case"sms":if(!(i.id in this.busy)){if("messages"==i.type&&G.chat_open){var a=!!G.conversation&&G.conversation.getLastUserMessage(!1,"no-bot");if(a&&Date.now()-6e5<M.unix(a.get("creation_time")))return}M.ajax({function:"automations-run",automation:i},(function(e){!1!==e&&(n.history.push(i.id),"messages"!=i.type||N.active||G.updateConversations()),delete n.busy[i.id]})),this.busy[i.id]=!0}break;case"popups":L("popup"+i.id)||setTimeout((function(){if(G.chat_open){if(i.fallback){var e=!!G.conversation&&G.conversation.getLastUserMessage(!1,"no-bot");(!e||Date.now()-6e5>M.unix(e.get("creation_time")))&&(G.sendMessage(f,(M.null(i.title)?"":"*".concat(i.title,"*\n"))+i.message,[],!1,!1,0),L("popup"+i.id,!0),n.history.push(i.id))}}else G.popup(!1,{id:i.id,image:i.profile_image,title:i.title,message:i.message}),n.history.push(i.id)}),1e3);break;case"design":i.background&&u.css("background-image",'url("'.concat(i.background,'")')),i.brand&&u.find(".sb-brand img").attr("src",i.brand),i.title&&u.find(".sb-title").html(i.title),i.message&&u.find(".sb-text").html(i.message),i.icon&&t.find(".sb-chat-btn .sb-icon").attr("src",i.icon),(i.color_1||i.color_2||i.color_3)&&M.ajax({function:"chat-css",color_1:i.color_1,color_2:i.color_2,color_3:i.color_3},(function(t){e("head").append("<style>".concat(t,"</style>"))})),this.history.push(i.id)}}}};window.SBChat=G;var W={rich_messsages:{email:"",button:"",video:"",image:"","woocommerce-button":"",chips:'<div class="sb-buttons">[options]</div>',buttons:'<div class="sb-buttons">[options]</div>',select:'<div class="sb-select"><p></p><ul>[options]</ul></div>',list:'<div class="sb-text-list">[values]</div>',"list-image":'<div class="sb-image-list">[values]</div>',table:"<table><tbody>[header][values]</tbody></table>",inputs:'<div class="sb-form">[values]</div>',rating:'<div class="sb-rating"><span>[label]</span><div><i data-rating="positive" class="sb-submit sb-icon-like"><span>[positive]</span></i><i data-rating="negative" class="sb-submit sb-icon-dislike"><span>[negative]</span></i></div></div>',card:'<div class="sb-card">[settings]</div>',share:'<div class="sb-social-buttons">[settings]</div>',slider:'<div class="sb-slider"><div>[items]</div></div><div class="sb-slider-arrow sb-icon-arrow-left[class]"></div><div class="sb-slider-arrow sb-icon-arrow-right sb-active[class]"></div>',"slider-images":'<div class="sb-slider sb-slider-images"><div>[items]</div></div><div class="sb-slider-arrow sb-icon-arrow-left[class]"></div><div class="sb-slider-arrow sb-icon-arrow-right sb-active[class]"></div>'},cache:{},generate:function(i,n){var a,s=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=!0,c="id"in i?i.id:M.random();if(n in this.rich_messsages)a=this.rich_messsages[n];else if(n in this.cache)a=this.cache[n];else{if(!(b||!M.null(C)&&"rich-messages"in C&&C["rich-messages"].includes(n)))return!1;"id"in i||(c=n),a='<div class="sb-rich-loading sb-loading"></div>',M.ajax({function:"get-rich-message",name:n},(function(e){e=s.initInputs(e),e=new q({}).render(e),"timetable"==n&&(e=s.timetable(e)),t.find('.sb-rich-message[id="'.concat(c,'"]')).html('<div class="sb-content">'.concat(e,"</div>")),s.cache[n]=e,G.scrollBottom(G.dashboard)})),r=!1}var l="disabled"in i;if(r){var d,u="";switch(n){case"rating":a=a.replace("[label]",U(M.null(i.label)?"Rate and review":i.label)).replace("[positive]",U(M.null(i["label-positive"])?"Helpful":i["label-positive"])).replace("[negative]",U(M.null(i["label-negative"])?"Not helpful":i["label-negative"]));break;case"email":var p=[],g=O().get("email"),h="#"==O().get("last_name").charAt(0);"true"==i.name&&p.push(["first_name","true"==i["last-name"]?"First name":"Name",h?"":"true"==i["last-name"]?O().get("first_name"):O().name,"text",!0]),"true"==i["last-name"]&&p.push(["last_name","Last name",h?"":O().get("last_name"),"text",!0]);for(var f=0;f<p.length;f++)a+='<div id="'.concat(p[f][0],'" data-type="text" class="sb-input sb-input-text"><span class="').concat(""==p[f][2]?"":"sb-active sb-filled",'">').concat(U(p[f][1]),'</span><input value="').concat(p[f][2],'" autocomplete="false" type="').concat(p[f][3],'" ').concat(p[f][4]?"required":"","></div>");if("true"==i.phone){var m=O().getExtra("phone"),v=b?[]:C.follow["phone-codes"],_="";for(f=0;f<v.length;f++)_+='<option value="+'.concat(v[f],'">+').concat(v[f],"</option>");a+='<div id="phone" data-type="select-input" class="sb-input sb-input-select-input"><span class="'.concat(""==m?"":"sb-active sb-filled",'">').concat(U("Phone"),'</span><div><select><option value=""></option>').concat(_,'</select></div><input value="').concat(b?"":m,'" pattern="[0-9]+" autocomplete="false" type="tel" ').concat("false"!=i["phone-required"]?"required":"","></div>")}a+='<div id="email" data-type="email" class="sb-input sb-input-btn"><span class="'.concat(""==g?"":"sb-active sb-filled",'">').concat(U(M.null(i.placeholder)?"Email":i.placeholder),'</span><input value="').concat(g,'" autocomplete="off" type="email" required><div class="sb-submit sb-icon-arrow-right"></div></div>');break;case"image":a='<div class="sb-image"><img src="'.concat(i.url,'"></div>');break;case"video":a="<iframe".concat("height"in i?' height="'.concat(i.height,'"'):"",' src="').concat("youtube"==i.type?"//www.youtube.com/embed/":"//player.vimeo.com/video/").concat(i.id,'" allowfullscreen></iframe>');break;case"select":d=i.options.split(",");for(f=0;f<d.length;f++)u+='<li data-value="'.concat(M.stringToSlug(d[f]),'">').concat(U(d[f]),"</li>");a=a.replace("[options]",u);break;case"chips":case"buttons":d=i.options.split(",");for(f=0;f<d.length;f++)u+='<div class="sb-btn sb-submit">'.concat(U(d[f]),"</div>");a=a.replace("[options]",u);break;case"button":a='<a href="'.concat(i.link.replace(/<i>/g,"_").replace(/<\/i>/g,"_"),'"').concat("target"in i?' target="_blank"':"",' class="sb-rich-btn sb-btn').concat("link"==i.style?"-text":"",'">').concat(U(i.name),"</a>");break;case"list":d=i.values.split(",");var y="list"==n,w=y&&d.length&&d[0].indexOf(":")>0;y&&!w&&(a=a.replace("sb-text-list","sb-text-list sb-text-list-single"));for(f=0;f<d.length;f++)u+=w?"<div><div>".concat(U(d[f].split(":")[0]),"</div><div>").concat(U(d[f].split(":")[1]),"</div></div>"):"<div>".concat(e.trim(U(d[f])),"</div>");a=a.replace("[values]",u);break;case"list-image":d=i.values.split(",");for(f=0;f<d.length;f++){var k=d[f].replace("://","///").split(":");u+='<div><div class="sb-thumb" style="background-image:url(\''.concat(k[0].replace("///","://"),'\')"></div><div class="sb-list-title">').concat(k[1],"</div><div>").concat(k[2],"</div></div>")}a=a.replace("[values]",u);break;case"table":d=i.header.split(","),u+="<tr>";for(f=0;f<d.length;f++)u+="<th>".concat(d[f],"</th>");u+="</tr>",a=a.replace("[header]",u),u="",d=i.values.split(",");for(f=0;f<d.length;f++){var S=d[f].split(":");u+="<tr>";for(f=0;f<S.length;f++)u+="<td>".concat(S[f],"</td>");u+="</tr>"}a=a.replace("[values]",u);break;case"inputs":d=i.values.split(",");for(f=0;f<d.length;f++)l&&""==d[f]||(u+='<div id="'.concat(M.stringToSlug(d[f]),'" data-type="text" class="sb-input sb-input-text"><span>').concat(U(d[f]),'</span><input autocomplete="false" type="text" required></div>'));u+='<div class="sb-btn sb-submit">'+U("button"in i?i.button:"Send now")+"</div>",a=a.replace("[values]",u);break;case"card":u="".concat("image"in i?'<div class="sb-card-img" style="background-image:url(\''.concat(i.image,"')\"></div>"):"",'<div class="sb-card-header">').concat(i.header,"</div>").concat("extra"in i?'<div class="sb-card-extra">'.concat(i.extra,"</div>"):"").concat("description"in i?'<div class="sb-card-description">'.concat(i.description,"</div>"):"").concat("link"in i?'<a class="sb-card-btn" href="'.concat(i.link,'">').concat(U(i["link-text"]),"</a>"):""),a=a.replace("[settings]",u);break;case"share":var T="channels"in i?i.channels.replace(/ /g,"").split(","):["fb","tw","li","wa","pi"],A="";for(f=0;f<T.length;f++){switch(T[f]){case"fb":A="www.facebook.com/sharer.php?u=";break;case"tw":A="twitter.com/intent/tweet?url=";break;case"li":A="www.linkedin.com/sharing/share-offsite/?url=";break;case"wa":A="web.whatsapp.com/send?text=";break;case"pi":A="www.pinterest.com/pin/create/button/?url="}u+='<div class="sb-'.concat(T[f]," sb-icon-social-").concat(T[f],'" data-link="https://').concat(A).concat(i.link,'"></div>')}a=a.replace("[settings]",u);break;case"slider":var x=0;for(f=1;f<16&&"header-"+f in i;f++)u+="<div>".concat("image-"+f in i?'<div class="sb-card-img" style="background-image:url(\''.concat(i["image-"+f],"')\"></div>"):"",'<div class="sb-card-header">').concat(i["header-"+f],"</div>").concat("extra-"+f in i?'<div class="sb-card-extra">'.concat(i["extra-"+f],"</div>"):"").concat("description-"+f in i?'<div class="sb-card-description">'.concat(i["description-"+f],"</div>"):"").concat("link-"+f in i?'<a class="sb-card-btn" href="'.concat(i["link-"+f],'">').concat(U(i["link-text-"+f]),"</a>"):"","</div>"),x++;a=a.replace("[items]",u).replace(/\[class\]/g,1==x?" sb-hide":"");break;case"slider-images":if("images"in i){var $=i.images.split(",");for(f=0;f<$.length;f++)u+='<div class="sb-card-img" data-value="'.concat($[f],'" style="background-image:url(\'').concat($[f],"')\"></div>");a=a.replace(/\[class\]/g,1==$.length?" sb-hide":"")}a=a.replace("[items]",u);break;case"woocommerce-button":i.settings="checkout:".concat(i.checkout,",coupon:").concat(i.coupon),a='<a href="#" data-ids="'.concat(i.ids,'" class="sb-rich-btn sb-btn">').concat(i.name,"</a>")}}return'<div id="'.concat(c,'" data-type="').concat(n,'"').concat(l?'disabled="true"':"").concat("settings"in i?' data-settings="'.concat(i.settings,'"'):"",'class="sb-rich-message sb-rich-').concat(n," ").concat(o,'">')+("title"in i?'<div class="sb-top">'.concat(U(i.title),"</div>"):"")+("message"in i?'<div class="sb-text">'.concat(U(i.message),"</div>"):"")+'<div class="sb-content">'.concat(a,'</div><div data-success="').concat("success"in i?i.success.replace(/"/g,""):"",'" class="sb-info"></div></div>')},submit:function(i,n,a){var s=this;if(!b&&!D(a)&&!this.is_busy){var o="",r="",c={},l=e(i).find("[data-success]").length?e(i).find("[data-success]").attr("data-success"):"",d=e(i).closest(".sb-rich-message").attr("id"),u=e(i).closest("[data-id]").attr("data-id"),p="",g={"rich-messages":{}},h=0==O()?{profile_image:["",""],first_name:["",""],last_name:["",""],email:["",""],password:["",""],user_type:["",""]}:{profile_image:[O().image,""],first_name:[O().get("first_name"),""],last_name:[O().get("last_name"),""],email:[O().get("email"),""],password:["",""],user_type:["",""]},_={},y=e(a),w="",k=!1!==G.conversation,S={},T={};if(M.null(u))u=-1;else{var A=G.conversation.getMessage(u);p=A.message,"rich-messages"in(g=A.payload())||(g["rich-messages"]={})}switch(e(a).hasClass("sb-btn")||e(a).hasClass("sb-select")||e(a).hasClass("sb-submit")||(y=e(a).closest(".sb-btn,.sb-select")),e(i).find(".sb-info").html("").sbActivate(!1),n){case"email":"first_name"in(_=V.getAll(i))&&(h.user_type=["user",""],"last_name"in _||(h.last_name=["",""])),"phone"in _&&(S={phone:[_.phone[0],"Phone"]}),e.extend(h,_),o="Please fill in all required fields and make sure the email is valid.",l=""==l?l:U(l)+" *".concat(h.email[0],"*"),g["rich-messages"][d]={type:n,result:_},g.event="update-user",c={function:"update-user-and-message",settings:h,settings_extra:S,payload:g},w="email-complete";break;case"registration":if(S=V.getAll(i.find(".sb-form-extra")),e.extend(h,V.getAll(i.find(".sb-form-main"))),T=e.extend({},h),""!=l&&(l=U(l)),C["registration-details"]){for(var x in l+='[list values="',h){var $=h[x][0].replace(/:|,/g,"");""!=$&&("profile_image"==x&&($=$.substr($.lastIndexOf("/")+1)),"password"!=x&&"password-check"!=x||($="********",T[x]="********"),l+=""==h[x][1]?"":"".concat(U(h[x][1].replace(/:|,/g,"")),":").concat($,","))}for(var x in S)""!=S[x][0]&&(l+="".concat(U(S[x][1].replace(/:|,/g,"")),":").concat(S[x][0].replace(/:|,/g,""),","));l=l.slice(0,-1)+'"]'}h.user_type=["user",""],g["rich-messages"][d]={type:n,result:{user:T,extra:S}},g.event="update-user",c={function:0!=O()?"update-user-and-message":"add-user-and-login",settings:h,settings_extra:S,payload:g},o=V.getRegistrationErrorMessage(i),w=JSON.stringify(h);break;case"rating":var B=e(a).attr("data-rating");l="".concat(U("Your rating is")," *").concat(U(B),"*. ").concat(U(""==l?"Thank you for your feedback!":l)),_={conversation_id:G.conversation.id,agent_id:G.agent_id,user_id:O().id,message:i.find("textarea").val(),rating:"positive"==B?1:-1},g["rich-messages"][d]={type:n,result:_},c={function:"set-rating",payload:g,settings:_},w=B;break;case"chips":case"select":case"buttons":_=M.escape(e(a).html()),l=""==l?l:U(l)+" *".concat(_,"*"),g["rich-messages"][d]={type:n,result:_},c={function:"update-message",payload:g},w=_,"chips"==n&&(G.sendMessage(O().id,_,[],!1,{id:d,event:"chips-click",result:_},"sb-human-takeover"==d&&0==y.index()&&2),e(a).closest(".sb-content").remove(),"sb-human-takeover"==d&&m.confirm==g["rich-messages"][d].result&&z.dialogflow.humanTakeoverConfirmed());break;case"inputs":if(_=V.getAll(i),o="All fields are required.",""!=l){for(var x in l=U(l)+' [list values="',_)l+="".concat(U(_[x][1].replace(/:|,/g,"")),":").concat(_[x][0].replace(/:|,/g,""),",");l=l.slice(0,-1)+'"]'}g["rich-messages"][d]={type:n,result:_},c={function:"update-message",payload:g},w=JSON.stringify(_)}if(r=(r=p.substr(p.indexOf("["+n))).substr(0,r.indexOf("]")+1),""!=o&&V.errors(i))return V.showErrorMessage(i,o),y.sbLoading(!1),(G.dashboard||k&&G.conversation.getLastMessage().id==u)&&G.scrollBottom(),!1;if(""==l&&"registration"!=n){var E=this.shortcode(r),I="title"in E[1]?'title="'.concat(E[1].title,'"'):"",j="message"in E[1]?'message="'.concat(E[1].message,'"'):"",R="";if(["inputs","email"].includes(n)){for(var x in _)R+=_[x][0]+",";R='values="'.concat(R.slice(0,-1),'"')}else R='options="'.concat(_,'"');l="[".concat("email"==n?"inputs":n," ").concat(I," ").concat(j," ").concat(R,' disabled="true"]')}-1!=u&&e.extend(c,{message_id:u,message:""!=p?p.replace(r,l):l,payload:g}),M.ajax(c,(function(o){if(0==o||M.errorValidation(o))V.showErrorMessage(i,V.getRegistrationErrorMessage(o,"response")),G.dashboard&&G.scrollBottom(),y.sbLoading(!1);else{switch(n){case"email":var r=G.conversation.getLastUserMessage();for(var c in h)O().set(c,h[c][0]);for(var c in S)O().setExtra(c,S[c][0]);k&&r&&C["notify-agent-email"]&&"sb-human-takeover-email"!=d&&G.sendEmail(r.message),M.loginCookie(o[1]),"sb-subscribe-form"==d&&M.ajax({function:"subscribe-email",email:O().get("email")}),G.automations.run_all(),M.event("SBNewEmailAddress",{id:d,name:O().name,email:O().get("email")});break;case"registration":if(M.loginCookie(o[1]),0==O()){for(var c in O(new P(o[0])),S)O().setExtra(c,S[c][0]);N.start(),G.initChat(),C["init-dashboard"]&&t.find(".sb-departments-list").length||!l||G.sendMessage(f,l,[],!1,!1,3)}else{for(var c in h)O().set(c,h[c][0]);for(var c in S)O().setExtra(c,S[c][0]);G.automations.run_all()}G.dashboard&&(t.removeClass("sb-init-form-active"),e(i).remove(),G.isInitDashboard()||G.hideDashboard()),delete s.cache.registration,M.event("SBRegistrationForm",{id:d,user:h,extra:g["rich-messages"][d].result.extra}),M.event("SBNewEmailAddress",{id:d,name:O().name,email:O().get("email")})}-1==u?e(a).closest(".sb-rich-message").html(l):"type"in g&&"close-message"==g.type||v||0!=m||G.setConversationStatus(2),["email","registration","login","chips"].includes(n)||z.dialogflow.message("".concat(d,"|").concat(n,"|").concat(w)),C["slack-active"]&&G.slackMessage(O().id,O().name,O().image,l),N.active&&G.update(),M.event("SBRichMessageSubmit",{result:o,data:g["rich-messages"][d],id:d})}}))}},shortcode:function(t){if(t.indexOf(" ")<0)return[t.slice(1,-1),{}];for(var i={},n=t.substr(1,t.indexOf(" ")-1),a=(t=t.slice(1,-1).substr(n.length+1)).split('" '),s=0;s<a.length;s++)if(a[s].includes("=")){var o=[a[s].substr(0,a[s].indexOf("=")),a[s].substr(a[s].indexOf("=")+2)];i[e.trim(o[0])]=o[1].replace(/"/g,"")}return[n,i]},initInputs:function(t){return(t=e(e.parseHTML("<div>"+t+"</div>"))).find(".sb-input input").each((function(){""!=e(this).val()&&e(this).siblings().addClass("sb-active sb-filled")})),t.html()},timetable:function(t){var i=e(e.parseHTML("<div>".concat(t,"</div>"))),n=i.find("[data-offset]").attr("data-offset");return n=M.null(n)?0:parseInt(n),i.find("[data-time]").each((function(){var a=e(this).attr("data-time").split("|");t="";for(var s=0;s<a.length;s++){if("closed"==a[s]){t+=U("Closed");break}if(""!=a[s]){var o=a[s].split(":"),r=M.convertUTCDateToLocalDate("01/01/2000 ".concat(o[0],":").concat(o[1]),n);t+=r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})+(0==s||2==s?"<span>".concat(U("to"),"</span>"):1==s&&""!=a[s+1]?"<br />":"")}}i.find(" > div > span").html('<i class="sb-icon-clock"></i> '.concat(U("Time zone")," ").concat(Intl.DateTimeFormat().resolvedOptions().timeZone)),e(this).html(t)})),i.html()},sliderChange:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",i=c.find("#".concat(e));if(i.length&&!i.hasClass("sb-moving")){var n=i.find(".sb-slider > div > div"),a=n.eq(0),s=Math.ceil(a.closest(".sb-slider").width()),o="right"==t?-1:1,r=parseFloat(parseFloat(parseFloat(a.css("margin-left"))+s*o).toFixed(2))+-.5*o,l=s*(n.length-1)*-1;r<1&&r>=l&&(a.css("margin-left",r+"px"),i.addClass("sb-moving"),setTimeout((function(){i.removeClass("sb-moving")}),1200)),i.find(".sb-icon-arrow-right").sbActivate(!(l>r-15&&l<r+15)),i.find(".sb-icon-arrow-left").sbActivate(r<-10)}}},V={getAll:function(t){var i=this,n={};return e(t).find(".sb-input[id]").each((function(t,a){n[e(a).attr("id")]=i.get(a)})),n},get:function(t){var i=(t=e(t)).data("type"),n=U(M.escape(t.find(" > span").html()));switch(i){case"image":var a=t.find(".image").attr("data-value");return[M.null(a)?"":a,n];case"select":return[M.escape(t.find("select").val()),n];case"select-input":return[M.escape(t.find("select").val()+t.find("input").val()),n];default:var s=t.find("input");return[M.escape(s.length?s.val():t.find("[data-value]").attr("data-value")),n]}},set:function(t,i){if((t=e(t)).length){switch(t.data("type")){case"image":""==i?t.find(".image").removeAttr("data-value").removeAttr("style"):t.find(".image").attr("data-value",i).css("background-image",'url("'.concat(i,'")'));break;case"select":t.find("select").val(i);break;default:t.find("input,textarea").val(i)}return!0}return!1},clear:function(t){var i=this;e(t).find(".sb-input,.sb-input-setting").each((function(t,n){i.set(n,""),e(n).find("input, select, textarea").removeClass("sb-error")})),this.set(e(t).find("#user_type"),"user")},errors:function(t){var i=!1,n=e(t).find("input, select, textarea").removeClass("sb-error");return n.each((function(t){var a=e(this).val(),s=e(this).attr("type"),o=e(this).prop("required");(o&&""==a||(o||""!=a)&&("password"==s&&(a.length<8||n.length>t+1&&"password"==n.eq(t+1).attr("type")&&n.eq(t+1).val()!=a)||"email"==s&&(a.indexOf("@")<0||a.indexOf(".")<0||/;|:|\/|\\|,|#|"|!|=|\+|\*|{|}|[|]|£|\$|€|~|'|>|<|\^|&/.test(a))||"tel"==s&&""!=a&&(""==e(this).parent().find("select").val()||isNaN(a)||a.includes("+")||a.length<5)))&&(i=!0,e(this).addClass("sb-error"))})),(n=e(t).find("[data-required]").removeClass("sb-error")).each((function(){M.null(e(this).attr("data-value"))&&(e(this).addClass("sb-error"),i=!0)})),i},showErrorMessage:function(t,i){e(t).find(".sb-info").html(U(i)).sbActivate(),clearTimeout(y),y=setTimeout((function(){e(t).find(".sb-info").sbActivate(!1)}),7e3)},showSuccessMessage:function(t,i){e(t).find(".sb-info").remove(),e(t).addClass("sb-success").find(".sb-content").html('<div class="sb-text">'.concat(i,"</div>"))},getRegistrationErrorMessage:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"validation";if("response"==i)return M.errorValidation(t,"duplicate-email")?"This email is already in use. Please use another email.":M.errorValidation(t,"duplicate-phone")?"This phone number is already in use. Please use another number.":"Error. Please check your information and try again.";var n=e(t).find("#last_name").length?"first name, last name":"name",a=e(t).find("#phone").length?" and phone number":"";return e(t).find("#password").length?"Please insert your ".concat(n,", a valid email").concat(a,", and a password (8 character minimum)."):"Please insert your ".concat(n,", and a valid email").concat(a,".")}};window.SBForm=V;var z={login:function(){return this.is("wp")&&("undefined"==typeof SB_WP_ACTIVE_USER?"undefined":o(SB_WP_ACTIVE_USER))!=B&&"wp"==C["wp-users-system"]?[[SB_WP_ACTIVE_USER,("undefined"==typeof SB_WP_AVATAR?"undefined":o(SB_WP_AVATAR))!=B?SB_WP_AVATAR:""],"wp"]:("undefined"==typeof SB_PERFEX_ACTIVE_USER?"undefined":o(SB_PERFEX_ACTIVE_USER))!=B?[[SB_PERFEX_ACTIVE_USER,SB_PERFEX_CONTACT_ID],"perfex"]:("undefined"==typeof SB_WHMCS_ACTIVE_USER?"undefined":o(SB_WHMCS_ACTIVE_USER))!=B?[SB_WHMCS_ACTIVE_USER,"whmcs"]:("undefined"==typeof SB_AECOMMERCE_ACTIVE_USER?"undefined":o(SB_AECOMMERCE_ACTIVE_USER))!=B&&[SB_AECOMMERCE_ACTIVE_USER,"aecommerce"]},is:function(e){return b?SBAdmin.apps.is(e):"wordpress"==e||"wp"==e?C.wp:e in C&&C[e]},wordpress:{ajax:function(t,i,n){e.ajax({method:"POST",url:SB_WP_AJAX_URL,data:e.extend({action:"sb_wp_ajax",type:t},i)}).done((function(e){!1!==n&&n(e)}))}},woocommerce:{updateCart:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];z.wordpress.ajax(e,{product_id:t},i)},waitingList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"request",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];("undefined"==typeof SB_WP_WAITING_LIST?"undefined":o(SB_WP_WAITING_LIST))!==B&&("request"!=e||SB_WP_WAITING_LIST&&M.storageTime("waiting-list-"+SB_WP_PAGE_ID,24))&&O()&&M.ajax({function:"woocommerce-waiting-list",product_id:!1===t?SB_WP_PAGE_ID:t,conversation_id:G.conversation.id,action:e,token:this.token},(function(t){t&&(M.storageTime("waiting-list-"+SB_WP_PAGE_ID),"request"!=e||G.chat_open&&!G.dashboard||G.updateConversations())}))}},dialogflow:{token:L("dialogflow-token"),message:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.active()&&(y=setTimeout((function(){G.typing(-1,"start"),setTimeout((function(){G.typing(-1,"stop")}),1e4)}),1e3),setTimeout((function(){G.conversation&&M.ajax({function:"dialogflow-message",conversation_id:G.conversation.id,message:t,attachments:i,token:e.token,dialogflow_language:L("dialogflow-language")},(function(n){if(!1!==n){if("language_detection"in n&&!L("dialogflow-language"))return L("dialogflow-language",[n.language_detection]),e.message(t,i,0);if(!M.errorValidation(n)){var a="queryResult"in n.response&&n.response.queryResult,s=a&&("input.unknown"==a.action||"match"in a&&"NO_MATCH"==a.match.matchType),o=!1,r="messages"in n&&Array.isArray(n.messages)?n.messages:[];if(G.typing(-1,"stop"),clearTimeout(y),e.token!=n.token&&(e.token=n.token,L("dialogflow-token",n.token)),s&&(C["dialogflow-disable"]&&e.active(!1),v&&e.unknowCookie(),m&&M.storageTime("human-takeover",1)&&t.length>3&&t.includes(" ")&&setTimeout((function(){G.sendMessage(f,'[chips id="sb-human-takeover" options="'.concat(m.confirm,",").concat(m.cancel,'" message="').concat(m.message.replace(/"/g,""),'"]'))}),1100),C["dialogflow-offline-message"]&&G.offlineMessage()),a){if("action"in a){var c=a.action;"end"==c&&e.active(!1),M.event("SBBotAction",c)}for(var l=0;l<r.length;l++)"payload"in r[l]&&function(){var t=["human-takeover","redirect","woocommerce-update-cart","woocommerce-checkout","open-article","transcript","department","agent","send-email","disable-bot"],i=r[l].payload;if(M.null(i)&&(i=[]),t[0]in i&&!0===i[t[0]]&&(o=!0,C["dialogflow-disable"]&&e.active(!1)),t[1]in i&&setTimeout((function(){"new-window"in i&&i["new-window"]?window.open(i[t[1]]):document.location=i[t[1]]}),500),t[2]in i){var n=i[t[2]];z.woocommerce.updateCart(n[0],n[1],(function(e){e&&M.event("SBWoocommerceCartUpdated",{action:n[0],product:n[1]})}))}if(t[3]in i&&!0===i[t[3]]&&z.wordpress.ajax("url",{url_name:"checkout"},(function(e){setTimeout((function(){document.location=e}),500)})),t[4]in i&&G.showArticles(i[t[4]]),t[5]in i&&!0===i[t[5]]&&M.ajax({function:"transcript",conversation_id:G.conversation.id,type:"txt"},(function(e){window.open(e)})),t[6]in i&&M.ajax({function:"update-conversation-department",conversation_id:G.conversation.id,department:i[t[6]],message:G.conversation.getLastUserMessage().message}),t[7]in i&&M.ajax({function:"update-conversation-agent",conversation_id:G.conversation.id,agent_id:i[t[7]],message:G.conversation.getLastUserMessage().message}),t[8]in i){var a=i[t[8]];G.sendEmail(a.message,a.attachments,"active_user"==a.recipient)}t[9]in i&&e.active(!1),M.event("SBBotPayload",i)}();if("diagnosticInfo"in a){var d=a.diagnosticInfo;"end_conversation"in d&&d.end_conversation&&e.active(!1)}}if(C["slack-active"]&&r&&(!v||s||o)){if(s||o){var u=G.conversation.getLastUserMessage();G.slackMessage(O().id,O().name,O().image,u.message)}for(l=0;l<r.length;l++)G.slackMessage(O().id,C["bot-name"],C["bot-image"],r[l].message,r[l].attachments)}(o||!b&&v&&s)&&((o||C["notify-agent-email"])&&e.unknowEmail(),(o||C["push-notifications"])&&N.pushNotification(t),(o||C["sms-active-agents"])&&G.sendSMS(t)),M.event("SBBotMessage",{response:n,message:t})}}}))}),!1!==n?n:0==C["bot-delay"]?2e3:parseInt(C["bot-delay"])))},active:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return!1===e?(C["dialogflow-active"]=!1,M.storageTime("dialogflow"),M.cookie("sb-dialogflow-disabled",!0,3600,"set",!0),!1):("activate"==e&&(C["dialogflow-active"]=!0,L("dialogflow",""),M.cookie("sb-dialogflow-disabled",0,0,"delete")),C["dialogflow-active"]&&!b&&M.storageTime("dialogflow",1)&&(!C["bot-office-hours"]||!C["office-hours"]))},unknowEmail:function(){M.ajax({function:"dialogflow-unknow-email",conversation_id:G.conversation.id,department:G.conversation.get("department"),token:this.token})},unknowCookie:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];M.cookie("sb-dialogflow-unknow-notify",!0,30,e?"delete":"set")},welcome:function(){C["dialogflow-welcome"]&&M.ajax({function:"dialogflow-message",message:"",conversation_id:G.conversation.id,token:this.token,event:"Welcome"})},humanTakeoverConfirmed:function(){var e=G.conversation.getLastUserMessage().message;M.storageTime("human-takeover"),this.unknowCookie(),this.unknowEmail(),C["push-notifications"]&&N.pushNotification(e),C["sms-active-agents"]&&G.sendSMS(e),(m["disable-bot"]||C["dialogflow-disable"])&&this.active(!1),setTimeout((function(){m.email&&M.null(O().get("email"))&&!e.includes("sb-human-takeover-email")?G.sendMessage(f,'[email id="sb-human-takeover-email" message="'.concat(m["email-message"],'" placeholder="').concat(C.follow.placeholder,'" name="').concat(C.follow.name,'" last-name="').concat(C.follow["last-name"],'" success="').concat(m.success,'"]'),[],!1,{"bot-unknow-notify":!0}):""!=m["message-confirmation"]&&G.sendMessage(f,m.success,[],!1,{"bot-unknow-notify":!0})}),1100)},translate:function(e,t,i){var n=this;M.ajax({function:"google-translate",strings:e,language_code:t,token:this.token},(function(e){n.token=e[1],i("data"in e[0]&&"translations"in e[0].data&&e[0].data.translations)}))}},aecommerce:{cart:function(){z.is("aecommerce")&&("undefined"==typeof SB_AECOMMERCE_CART?"undefined":o(SB_AECOMMERCE_CART))!=B&&("undefined"==typeof SB_AECOMMERCE_ACTIVE_USER?"undefined":o(SB_AECOMMERCE_ACTIVE_USER))!=B&&L("aecommerce")!=JSON.stringify(SB_AECOMMERCE_CART)&&M.ajax({function:"aecommerce-cart",cart:SB_AECOMMERCE_CART},(function(){L("aecommerce",JSON.stringify(SB_AECOMMERCE_CART))}))}}};function H(){(t=e(".sb-admin, .sb-chat, .sb-tickets")).length&&("undefined"==typeof SB_AJAX_URL?"undefined":o(SB_AJAX_URL))!=B?(c=t.find(".sb-list"),l=t.find(".sb-editor"),d=l.find("textarea"),h=t.find(b||_?".sb-list":"> div > .sb-scroll-area"),u=h.find(".sb-header"),g=l.find(".sb-emoji"),p=_?t.find(".sb-profile-agent .sb-status"):null,G.enabledAutoExpand(),G.audio=t.find("#sb-audio").get(0),G.audio_out=t.find("#sb-audio-out").get(0),M.cookie("sb-check","ok",1,"set"),"ok"!=M.cookie("sb-check")?(E=!1,console.warn("Support Board: cookies not available.")):M.cookie("sb-check",!1,!1,!1),0!=L("login")&&(M.loginCookie(L("login")),localStorage.removeItem("login")),b?M.event("SBReady"):(M.ajax({function:"get-front-settings",current_url:window.location.href},(function(e){f=(C=e)["bot-id"],m=C["dialogflow-human-takeover"],v=C["bot-unknow-notify"],$=C["agents-online"],N.active=C.pusher,"undefined"!=typeof SB_REGISTRATION_REQUIRED&&(C["registration-required"]=SB_REGISTRATION_REQUIRED,C["tickets-registration-required"]=SB_REGISTRATION_REQUIRED),_&&C["tickets-manual-init"]||(!_||C["tickets-manual-init"])&&(C["chat-manual-init"]||C["disable-offline"]&&!$||C["disable-office-hours"]&&!C["office-hours"]||C["chat-login-init"]&&!z.login())||G.initChat(),C.cron&&setTimeout((function(){M.ajax({function:"cron-jobs"})}),1e4),C["cron-email-piping"]&&setTimeout((function(){M.ajax({function:"email-piping"})}),8e3),C["push-notifications-users"]&&N.initServiceWorker(),_&&C["tickets-default-department"]&&(G.default_department=C["tickets-default-department"]),z.aecommerce.cart(),M.event("SBReady")})),G.audio_out&&(G.audio_out.volume=.4)),e(l).on("keydown","textarea",(function(e){if(13==e.which&&(!_||C["tickets-enter-button"])&&(!b||!e.ctrlKey))return G.submit(),e.preventDefault,!1;b&&13==e.which&&e.ctrlKey&&G.insertText("\n")})),("undefined"==typeof SB_DEFAULT_DEPARTMENT?"undefined":o(SB_DEFAULT_DEPARTMENT))!==B&&(G.default_department=SB_DEFAULT_DEPARTMENT),("undefined"==typeof SB_DEFAULT_AGENT?"undefined":o(SB_DEFAULT_AGENT))!==B&&(G.default_agent=SB_DEFAULT_AGENT)):M.event("SBReady"),document.addEventListener("visibilitychange",(function(){M.visibilityChange(document.visibilityState)}),!1),e(t).on("click",(function(){G.tab_active||M.visibilityChange()})),b?(i=t,t=t.find(".sb-conversation")):i=t,e(h).on("scroll",(function(e){G.scrollHeader()})),e(c).on("click",".sb-menu-btn",(function(){var t=e(this).parent().find(".sb-menu"),i=e(t).sbActive();M.deactivateAll(),i||(e(t).sbActivate(),M.deselectAll(),b&&(SBAdmin.open_popup=t))})),T&&(e(l).on("click",".sb-textarea",(function(){t.addClass("sb-header-hidden"),e(this).find("textarea").focus(),h[0].scrollTop===h[0].scrollHeight-h[0].offsetHeight&&(G.scrollBottom(),setTimeout((function(){G.scrollBottom()}),200))})),e(l).on("focusout",".sb-textarea",(function(){setTimeout((function(){t.removeClass("sb-header-hidden")}),300)})),e(l).on("click",".sb-submit",(function(){d.blur()}))),e(c).on("click",".sb-menu li",(function(){e(this).parent().sbActivate(!1)})),e(l).on("click",".sb-submit",(function(){G.submit()})),e("body").on("click",".sb-chat-btn,.sb-responsive-close-btn,#sb-open-chat,.sb-open-chat",(function(){G.open(!G.chat_open)})),e(t).on("click",".sb-dashboard-btn",(function(){G.showDashboard(),L("open-conversation",0),x=!1})),e(t).on("click",".sb-user-conversations li",(function(){G.openConversation(e(this).attr("data-conversation-id"))})),e(t).on("click",".sb-btn-new-conversation,.sb-departments-list > div",(function(){M.null(e(this).data("id"))||(G.default_department=parseInt(e(this).data("id"))),x="new-conversation",G.clear(),G.hideDashboard()})),e(l).on("click",".sb-btn-attachment",(function(){G.is_busy||l.find(".sb-upload-files").val("").click()})),e(l).on("click",".sb-attachments > div > i",(function(t){return e(this).parent().remove(),""==d.val()&&0==l.find(".sb-attachments > div").length&&G.activateBar(!1),t.preventDefault(),!1})),e(l).on("change",".sb-upload-files",(function(t){G.busy(!0),e(this).sbUploadFiles((function(e){G.uploadResponse(e)})),M.event("SBAttachments")})),e(l).on("dragover",(function(t){e(this).addClass("sb-drag"),clearTimeout(y),t.preventDefault(),t.stopPropagation()})),e(l).on("dragleave",(function(t){var i=this;y=setTimeout((function(){e(i).removeClass("sb-drag")}),200),t.preventDefault(),t.stopPropagation()})),e(l).on("drop",(function(t){var i=t.originalEvent.dataTransfer.files;if(t.preventDefault(),t.stopPropagation(),i.length>0)for(var n=0;n<i.length;++n){var a=new FormData;a.append("file",i[n]),M.upload(a,(function(e){G.uploadResponse(e)}))}return e(this).removeClass("sb-drag"),!1})),e(t).on("click",".sb-btn-all-articles",(function(){G.showArticles()})),e(t).on("click",".sb-articles > div:not(.sb-title)",(function(){G.showArticles(e(this).attr("data-id"))})),e(t).on("click",".sb-dashboard-articles .sb-input-btn .sb-submit-articles",(function(){G.searchArticles(e(this).parent().find("input").val(),this)})),e(t).on("click",".sb-article [data-rating]",(function(){var t=this,i=e(this).closest(".sb-article");if(!i[0].hasAttribute("data-user-rating")){e(this).parent().sbLoading();var n="positive"==e(this).attr("data-rating")?1:-1,a=e(this).closest(".sb-article").attr("data-id");G.setArticleRating(a,n,(function(){M.storage("article-rating-"+a,n),i.attr("data-user-rating",n),e(t).parent().sbLoading(!1)}))}})),e(c).on("click",".sb-rich-button a",(function(t){var i=e(this).attr("href");if(0===i.indexOf("#")&&0===i.indexOf("#article-"))return G.showArticles(i.replace("#article-","")),t.preventDefault(),!1})),e(i).on("click",".sb-lightbox-media > i",(function(){return i.find(".sb-lightbox-media").sbActivate(!1),b&&(SBAdmin.open_popup=!1),!1})),e(t).on("click",".sb-image",(function(){M.lightbox(e(this).html())})),e(t).on("click",".sb-slider-images .sb-card-img",(function(){M.lightbox('<img src="'.concat(e(this).attr("data-value"),'" />'))})),e(document).on("SBConversationLoaded",(function(){L("queue")&&G.queue(L("queue"))})),e(l).on("click",".sb-btn-emoji",(function(){G.showEmoji(this)})),e(g).on("click",".sb-emoji-list li",(function(t){G.insertEmoji(e(this).html()),T&&clearTimeout(y)})),e(g).find(".sb-emoji-list").on("touchend",(function(e){y=setTimeout((function(){G.mouseWheelEmoji(e)}),50)})),e(g).find(".sb-emoji-list").on("mousewheel DOMMouseScroll",(function(e){G.mouseWheelEmoji(e)})),e(g).find(".sb-emoji-list").on("touchstart",(function(e){G.emoji_options.touch=e.originalEvent.touches[0].clientY})),e(g).on("click",".sb-emoji-bar > div",(function(){G.clickEmojiBar(this)})),e(g).on("click",".sb-select li",(function(){G.categoryEmoji(e(this).data("value"))})),e(g).find(".sb-search-btn input").on("change keyup paste",(function(){G.searchEmoji(e(this).val())})),e(d).on("keyup",(function(){G.textareaChange(this)})),e(t).on("click",".sb-privacy .sb-approve",(function(){L("privacy-approved",!0),e(this).closest(".sb-privacy").remove(),t.removeClass("sb-init-form-active"),u.find(" > div").css({opacity:1,top:0}),G.initChat(),_?SBTickets.showPanel("new-ticket"):G.isInitDashboard()||G.hideDashboard()})),e(t).on("click",".sb-privacy .sb-decline",(function(){var t=e(this).closest(".sb-privacy");e(t).find(".sb-text").html(e(t).attr("data-decline")),e(t).find(".sb-decline").remove(),G.scrollBottom(!0)})),e(t).on("click",".sb-popup-message .sb-icon-close",(function(){G.popup(!0)})),e(t).on("click",".sb-rich-message .sb-submit,.sb-rich-message .sb-select ul li",(function(){var t=e(this).closest(".sb-rich-message");t[0].hasAttribute("disabled")||W.submit(t,t.attr("data-type"),this)})),e(t).on("click",".sb-rich-message .sb-input > span",(function(){e(this).sbActivate(),e(this).siblings().focus()})),e(t).on("focus focusout click",".sb-rich-message .sb-input input,.sb-rich-message .sb-input select",(function(t){switch(t.type){case"focusin":case"focus":e(this).siblings().sbActivate();break;case"focusout":""==e(this).val()?e(this).siblings().sbActivate(!1):e(this).siblings().addClass("sb-filled sb-active");break;case"click":e(this).siblings().removeClass("sb-filled")}})),e(t).on("click",".sb-slider-arrow",(function(){W.sliderChange(e(this).closest("[id]").attr("id"),e(this).hasClass("sb-icon-arrow-right")?"right":"left")})),e(t).on("change",'.sb-rich-message [data-type="select"] select',(function(){e(this).siblings().sbActivate()})),e(t).on("click",'[data-type="select-input"] > div',(function(){e(this).prev().sbActivate(),e(this).next().addClass("sb-focus")})),e(t).on("focusout",'[data-type="select-input"] input,[data-type="select-input"] select',(function(){var t=e(this).closest(".sb-input");t.find("input").val()+t.find("select").val()==""&&t.find("span").sbActivate(!1),t.find(".sb-focus").removeClass("sb-focus")})),e(t).on("click",".sb-rich-registration .sb-login-area",(function(){e(this).closest(".sb-rich-registration").replaceWith(W.generate({},"login","sb-init-form")),G.scrollBottom(!0)})),e(t).on("click",".sb-rich-login .sb-registration-area",(function(){""!=C["registration-link"]?document.location=C["registration-link"]:(e(this).closest(".sb-rich-login").replaceWith(W.generate({},"registration","sb-init-form")),G.scrollBottom(!0))})),e(t).on("click",".sb-rich-login .sb-submit-login",(function(){var i=this;M.loginForm(this,!1,(function(n){O(new P(n[0])),t.removeClass("sb-init-form-active"),e(i).closest(".sb-rich-login").remove(),x="open-conversation",G.initChat(),N.start(),G.isInitDashboard()||G.hideDashboard()}))})),e(c).on("click",".sb-social-buttons div",(function(){M.openWindow(e(this).attr("data-link"))})),e(c).on("click",'.sb-rich-woocommerce-button a, [href="#"].sb-card-btn',(function(t){var i=this,n=M.settingsStringToArray(e(this).closest(".sb-rich-message").attr("data-settings")),a="checkout"==n["link-type"]||n.checkout,s=e(this)[0].hasAttribute("data-ids")?e(this).attr("data-ids").split(","):[n.id.split("|")[e(this).parent().index()]];if(s.length){if(D(this))return;z.wordpress.ajax("button-purchase",{product_ids:s,checkout:a,coupon:n.coupon},(function(t){a?document.location=t:e(i).addClass("sb-icon-check").sbLoading(!1)}))}return t.preventDefault(),!1})),e(c).on("click","#sb-waiting-list .sb-submit",(function(){0==e(this).index()&&setTimeout((function(){z.woocommerce.waitingList("submit")}),1e3)})),e(document).on("SBNewEmailAddress",(function(e,t){"sb-waiting-list-email"==t.id&&z.woocommerce.waitingList("submit")})),e(i).on("click",".sb-search-btn > i",(function(){var t=e(this).parent(),n=e(t).sbActive();n&&(e(t).find("input").val(""),setTimeout((function(){e(t).find("input").trigger("change")}),550)),e(t).sbActivate(!n),e(t).find("input").focus(),i.find(".sb-select ul").sbActivate(!1)})),e(i).on("click",".sb-select",(function(){var t=e(this).find("ul");t.toggleClass("sb-active"),b&&(SBAdmin.open_popup=!!t.hasClass("sb-active")&&this)})),e(i).on("click",".sb-select li",(function(){var t=e(this).closest(".sb-select"),i=e(this).data("value"),n=e(t).find('[data-value="'.concat(i,'"]'));e(t).find("li").sbActivate(!1),e(t).find("p").attr("data-value",i).html(e(n).html()),e(n).sbActivate()})),e(i).on("click",".sb-input-image .image",(function(){a=e(this).parent(),l.find(".sb-upload-files").click()})),e(i).on("click",".sb-input-image .image > .sb-icon-close",(function(t){return e(this).parent().removeAttr("data-value").css("background-image",""),t.preventDefault(),!1}))}window.SBApps=z,e(document).ready((function(){if((t=e(".sb-admin, .sb-admin-start")).length)return b=!0,void H();var i,n,a=!1;if(("undefined"==typeof SB_INIT_URL?"undefined":o(SB_INIT_URL))!=B)SB_INIT_URL.indexOf(".js")<0&&(SB_INIT_URL+="/js/main.js?v=3.3.2"),i=SB_INIT_URL;else for(var s=document.getElementsByTagName("script"),r=["init.js","main.js","min/init.min.js","min/main.min.js"],c=0;c<s.length;c++){var l=s[c].src;if("sbinit"==s[c].id){i=l,a=a||i.includes("init.");break}for(var d=0;d<r.length;d++)if(l.includes("/supportboard/js/"+r[d])){i=l,a=a||i.includes("init.");break}}var u=M.getURL(!1,i);"url"in u&&(i=u.url),(("undefined"==typeof SB_TICKETS?"undefined":o(SB_TICKETS))!=B||"mode"in u&&"tickets"==u.mode)&&(_=!0,u.mode="tickets"),"undefined"!=typeof SB_DISABLED&&SB_DISABLED||(a?H():(n=i.substr(0,i.lastIndexOf("main.js")>0?i.lastIndexOf("main.js")-4:i.lastIndexOf("main.min.js")-8),M.cors("GET",n+"/include/init.php"+("lang"in u?"?lang="+u.lang:"")+("mode"in u?("lang"in u?"&":"?")+"mode="+u.mode:""),(function(t){var i="body";_&&e("#sb-tickets").length&&(i="#sb-tickets"),e(i).append(t),M.loadResource(n+"/css/min/"+(_?"tickets":"main")+".min.css"),_&&M.loadResource(n+"/apps/tickets/tickets.js",!0),H()}))))}))}(jQuery)},function(e,t){},,,,,function(e,t){}]);